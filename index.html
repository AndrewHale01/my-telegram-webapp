<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Telegram WebApp</title>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-TZN665FNYF"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-TZN665FNYF');
  </script>
  <style>
    body {
      margin: 0;
      background: #222;
      color: #fff;
      font-family: Arial, sans-serif;
      padding-bottom: 60px;
    }
    .topbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px;
      position: relative;
    }
    .lang-btn {
      font-size: 1.5rem;
      cursor: pointer;
      margin-right: 0px;
    }
    .avatar-small {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      border: 2px solid #00bfae;
      cursor: pointer;
      object-fit: cover;
      background: #111;
      transition: box-shadow 0.2s;
    }
    .avatar-small:hover {
      box-shadow: 0 0 0 4px #00bfae55;
    }
    .popup {
      display: none;
      position: absolute;
      top: 60px;
      right: 0;
      background: #333;
      padding: 24px 20px 20px 20px;
      border-radius: 16px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.5);
      z-index: 10;
      flex-direction: column;
      min-width: 260px;
      align-items: center;
      animation: fadeIn 0.2s;
    }
    .popup.active {
      display: flex;
    }
    .register-btn, .done-btn, .create-team-btn {
      background: #2196f3;
      color: #fff;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: bold;
      cursor: pointer;
      margin: 8px 0;
      transition: background 0.2s;
      width: 100%;
      max-width: 220px;
    }
    .register-btn:hover, .done-btn:hover, .create-team-btn:hover {
      background: #1976d2;
    }
    .profile-form {
      display: flex;
      flex-direction: column;
      gap: 12px;
      width: 100%;
      max-width: 220px;
      margin-top: 8px;
    }
    .profile-form label {
      font-size: 0.95rem;
      color: #bbb;
      margin-bottom: 2px;
    }
    .profile-form input {
      padding: 8px;
      border-radius: 6px;
      border: 1px solid #555;
      background: #222;
      color: #fff;
      font-size: 1rem;
      outline: none;
      width: 100%;
    }
    .profile-form input[readonly] {
      background: #222;
      color: #aaa;
      border: 1px solid #444;
    }
    .success-message {
      color: #00bfae;
      font-size: 1rem;
      margin: 10px 0 0 0;
      text-align: center;
    }
    .player-profile {
      width: 100%;
      max-width: 220px;
      margin-top: 8px;
      margin-bottom: 8px;
      background: #222;
      border-radius: 10px;
      padding: 12px 14px;
      color: #fff;
      font-size: 1rem;
      box-sizing: border-box;
      display: none;
    }
    .player-profile-title {
      margin-bottom: 8px;
      color: #00bfae;
      font-weight: bold;
      font-size: 1.05rem;
    }
    .player-profile-row {
      margin-bottom: 4px;
      word-break: break-word;
    }
    .lang-option {
      background: #444;
      color: #fff;
      border: none;
      padding: 6px 12px;
      border-radius: 6px;
      cursor: pointer;
      margin-top: 5px;
    }
    .lang-option:hover {
      background: #555;
    }
    #langPopup {
      left: 0;
      right: auto;
    }
    .main-section, .rules-section, .awards-section, .support-section {
      display: none;
      padding: 0 16px;
    }
    .main-section.active, .rules-section.active, .awards-section.active, .support-section.active {
      display: block;
    }
    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background: #111;
      display: flex;
      justify-content: space-around;
      border-top: 1px solid #333;
      padding: 8px 0;
      z-index: 100;
    }
    .nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      color: #ccc;
      font-size: 0.85rem;
      cursor: pointer;
    }
    .nav-item span {
      font-size: 1.2rem;
      margin-bottom: 2px;
    }
    .nav-item.active, .nav-item:hover {
      color: #00bfae;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: scale(0.95);}
      to { opacity: 1; transform: scale(1);}
    }
    .news-section {
      margin: 0 0 24px 0;
      padding: 0 16px;
    }
    .news-title {
      font-size: 1.1rem;
      font-weight: bold;
      margin-bottom: 8px;
      color: #00bfae;
      letter-spacing: 0.5px;
    }
    .news-list {
      display: flex;
      overflow-x: auto;
      gap: 12px;
      padding-bottom: 8px;
      scrollbar-width: thin;
    }
    .news-card {
      min-width: 220px;
      background: #333;
      border-radius: 12px;
      padding: 14px 16px;
      box-shadow: 0 2px 8px #0005;
      flex-shrink: 0;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }
    .news-card p {
      margin: 0;
      font-size: 0.95rem;
      color: #fff;
      word-break: break-word;
      white-space: normal;
      overflow-wrap: break-word;
      max-width: 100%;
    }
    .news-card h4 {
      margin: 0 0 8px 0;
      font-size: 1rem;
      color: #00bfae;
    }
    .disciplines-section {
      margin: 0 0 24px 0;
      padding: 0 16px;
    }
    .disciplines-title {
      font-size: 1.1rem;
      font-weight: bold;
      margin-bottom: 8px;
      color: #00bfae;
      letter-spacing: 0.5px;
    }
    .disciplines-list {
      display: flex;
      gap: 16px;
      align-items: center;
    }
    .discipline-card {
      background: #333;
      border-radius: 12px;
      padding: 10px 14px;
      box-shadow: 0 2px 8px #0005;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-width: 320px;
      max-width: 320px;
      border: 4px solid #00bfae;
    }
    .discipline-img {
      width: 320px;
      height: 320px;
      object-fit: cover;
      border-radius: 12px;
      margin-bottom: 8px;
      background: #222;
      border: none;
      display: block;
    }
    .discipline-name {
      color: #fff;
      font-size: 1.1rem;
      text-align: center;
    }
    .tournaments-section {
      margin: 0 0 24px 0;
      padding: 0 16px;
    }
    .tournaments-title {
      font-size: 1.1rem;
      font-weight: bold;
      margin-bottom: 8px;
      color: #00bfae;
      letter-spacing: 0.5px;
    }
    .tournament-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    .tournament-card {
      background: #333;
      border-radius: 12px;
      padding: 14px 16px;
      box-shadow: 0 2px 8px #0005;
      display: flex;
      flex-direction: column;
    }
    .tournament-card h4 {
      margin: 0 0 6px 0;
      font-size: 1rem;
      color: #00bfae;
    }
    .tournament-card p {
      margin: 0;
      font-size: 0.95rem;
      color: #fff;
    }
    .dropdown {
      margin: 18px 0;
      width: 100%;
      max-width: 600px;
    }
    .dropdown summary {
      background: #222;
      color: #00bfae;
      font-weight: bold;
      font-size: 1.1rem;
      padding: 12px 18px;
      border-radius: 8px;
      cursor: pointer;
      outline: none;
      border: 2px solid #00bfae;
      margin-bottom: 6px;
      user-select: none;
    }
    .dropdown[open] summary {
      background: #00bfae;
      color: #222;
    }
    .dropdown-content {
      background: #333;
      color: #fff;
      padding: 14px 18px;
      border-radius: 0 0 8px 8px;
      font-size: 1rem;
      border-top: 1px solid #00bfae;
    }
    #adminMenuBtn { background: none; border: none; font-size: 2rem; cursor: pointer; margin-left: 12px; display: none; }
    #adminModal { display: none; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: #000a; z-index: 9999; align-items: center; justify-content: center; }
    #adminModal.active { display: flex; }
    #adminModalContent { background: #222; color: #fff; border-radius: 16px; padding: 32px 24px; min-width: 320px; max-width: 90vw; box-shadow: 0 8px 32px #000b; position: relative; }
    #closeAdminModal { position: absolute; top: 12px; right: 16px; background: none; border: none; color: #fff; font-size: 1.5rem; cursor: pointer; }
    #adminModalContent button { padding: 10px; border-radius: 8px; border: none; font-size: 1rem; cursor: pointer; margin-bottom: 8px; width: 100%; max-width: 320px; }
    #banUserBtn { background: #c62828; color: #fff; }
    #unbanUserBtn { background: #388e3c; color: #fff; }
    #givePrizeBtn { background: #1976d2; color: #fff; }
    #disqualifyTeamBtn { background: #fbc02d; color: #222; }
    #editBracketBtn { background: #7b1fa2; color: #fff; }
    #adminResult { margin-top: 18px; color: #0f0; min-height: 24px; }
    .notification-btn {
      background: none;
      border: none;
      font-size: 2rem;
      cursor: pointer;
      position: relative;
      margin-left: 8px;
      color: #fff;
    }
    .notification-badge {
      position: absolute;
      top: 2px;
      right: 2px;
      background: #e53935;
      color: #fff;
      border-radius: 50%;
      font-size: 0.85rem;
      min-width: 20px;
      min-height: 20px;
      padding: 0 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      border: 2px solid #222;
      box-sizing: border-box;
      z-index: 2;
    }
    #notificationPopup {
      right: 60px;
      left: auto;
      min-width: 280px;
      max-width: 340px;
      max-height: 400px;
      overflow-y: auto;
    }
    #notificationList {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .notification-item {
      background: #292929;
      border-radius: 8px;
      padding: 10px 12px;
      color: #fff;
      font-size: 0.98rem;
      box-shadow: 0 1px 4px #0004;
      word-break: break-word;
    }
    /* Додаємо стилі для форми команди */
    .team-form { display: flex; flex-direction: column; gap: 12px; width: 100%; max-width: 340px; margin-top: 8px; align-items: center; }
    .team-form label { font-size: 0.95rem; color: #bbb; margin-bottom: 2px; align-self: flex-start; }
    .team-form input[type="text"] { padding: 8px; border-radius: 6px; border: 1px solid #555; background: #222; color: #fff; font-size: 1rem; outline: none; width: 100%; }
    .team-form input[type="file"] { color: #fff; margin-bottom: 8px; align-self: flex-start; }
    .team-avatar-preview { width: 80px; height: 80px; border-radius: 50%; object-fit: cover; border: 2px solid #00bfae; margin-bottom: 8px; background: #111; display: none; }
    .team-player-block { background: #292929; border-radius: 8px; padding: 10px 12px; margin-bottom: 8px; width: 100%; box-sizing: border-box; }
    .team-player-title { color: #00bfae; font-weight: bold; margin-bottom: 4px; font-size: 1rem; }
    .team-success-message { color: #00bfae; font-size: 1rem; margin: 10px 0 0 0; text-align: center; }
  </style>
</head>
<body>
  <div class="topbar">
    <div class="lang-btn" id="langBtn">🌐</div>
    <img id="avatar" class="avatar-small" src="avatar.jpg" alt="Avatar">
    <button id="notificationBtn" class="notification-btn" title="Сповіщення">
      🔔
      <span id="notificationBadge" class="notification-badge" style="display:none;">0</span>
    </button>
    <button id="adminMenuBtn" title="Адмін-меню">🛡️</button>
    <div id="profilePopup" class="popup">
      <button class="register-btn" id="registerBtn" data-i18n="register">Зареєструватись</button>
      <form class="profile-form" id="profileForm" style="display:none;">
        <label for="standoffNick" data-i18n="standoff_nick">Нік в Standoff</label>
        <input type="text" id="standoffNick" name="standoffNick" required maxlength="32" autocomplete="off">
        <label for="standoffId" data-i18n="standoff_id">ID в Standoff</label>
        <input type="text" id="standoffId" name="standoffId" required maxlength="32" autocomplete="off">
        <label for="tgUser" data-i18n="tg_user">Telegram</label>
        <input type="text" id="tgUser" name="tgUser" readonly>
        <button type="submit" class="done-btn" id="doneBtn" data-i18n="done">Готово</button>
      </form>
      <div class="player-profile" id="playerProfile">
        <div class="player-profile-title" data-i18n="profile">Профіль гравця</div>
        <div class="player-profile-row"><span data-i18n="standoff_nick">Нік в Standoff</span>: <span id="profileNick"></span></div>
        <div class="player-profile-row"><span data-i18n="standoff_id">ID в Standoff</span>: <span id="profileId"></span></div>
        <div class="player-profile-row"><span data-i18n="tg_user">Telegram</span>: <span id="profileTg"></span></div>
      </div>
      <button class="create-team-btn" id="createTeamBtn" style="display:none;" data-i18n="create_team">Створити команду</button>
      <div class="success-message" id="successMsg" style="display:none;" data-i18n="profile_saved">Профіль збережено!</div>
      <form class="team-form" id="teamForm" style="display:none;">
        <label for="teamAvatar" data-i18n="team_avatar">Аватарка команди</label>
        <input type="file" id="teamAvatar" accept="image/*">
        <img id="teamAvatarPreview" class="team-avatar-preview" src="#" alt="Team Avatar">
        <label for="teamTag" data-i18n="team_tag">Тег команди</label>
        <input type="text" id="teamTag" maxlength="12" required data-i18n-placeholder="team_tag_ph">
        <label for="teamName" data-i18n="team_name">Назва команди</label>
        <input type="text" id="teamName" maxlength="32" required data-i18n-placeholder="team_name_ph">
        <div class="team-player-block">
          <div class="team-player-title" data-i18n="main_player1">Гравець 1 (основний)</div>
          <input type="text" placeholder="ID в Standoff 2" id="main1Id" required data-i18n-placeholder="player_id_ph">
          <input type="text" placeholder="Нікнейм" id="main1Nick" required data-i18n-placeholder="player_nick_ph">
          <input type="text" placeholder="Telegram" id="main1Tg" required data-i18n-placeholder="player_tg_ph">
        </div>
        <div class="team-player-block">
          <div class="team-player-title" data-i18n="main_player2">Гравець 2 (основний)</div>
          <input type="text" placeholder="ID в Standoff 2" id="main2Id" required data-i18n-placeholder="player_id_ph">
          <input type="text" placeholder="Нікнейм" id="main2Nick" required data-i18n-placeholder="player_nick_ph">
          <input type="text" placeholder="Telegram" id="main2Tg" required data-i18n-placeholder="player_tg_ph">
        </div>
        <div class="team-player-block">
          <div class="team-player-title" data-i18n="main_player3">Гравець 3 (основний)</div>
          <input type="text" placeholder="ID в Standoff 2" id="main3Id" required data-i18n-placeholder="player_id_ph">
          <input type="text" placeholder="Нікнейм" id="main3Nick" required data-i18n-placeholder="player_nick_ph">
          <input type="text" placeholder="Telegram" id="main3Tg" required data-i18n-placeholder="player_tg_ph">
        </div>
        <div class="team-player-block">
          <div class="team-player-title" data-i18n="main_player4">Гравець 4 (основний)</div>
          <input type="text" placeholder="ID в Standoff 2" id="main4Id" required data-i18n-placeholder="player_id_ph">
          <input type="text" placeholder="Нікнейм" id="main4Nick" required data-i18n-placeholder="player_nick_ph">
          <input type="text" placeholder="Telegram" id="main4Tg" required data-i18n-placeholder="player_tg_ph">
        </div>
        <div class="team-player-block">
          <div class="team-player-title" data-i18n="main_player5">Гравець 5 (основний)</div>
          <input type="text" placeholder="ID в Standoff 2" id="main5Id" required data-i18n-placeholder="player_id_ph">
          <input type="text" placeholder="Нікнейм" id="main5Nick" required data-i18n-placeholder="player_nick_ph">
          <input type="text" placeholder="Telegram" id="main5Tg" required data-i18n-placeholder="player_tg_ph">
        </div>
        <div class="team-player-block">
          <div class="team-player-title" data-i18n="sub_player1">Гравець 6 (запасний)</div>
          <input type="text" placeholder="ID в Standoff 2" id="sub1Id" data-i18n-placeholder="player_id_ph">
          <input type="text" placeholder="Нікнейм" id="sub1Nick" data-i18n-placeholder="player_nick_ph">
          <input type="text" placeholder="Telegram" id="sub1Tg" data-i18n-placeholder="player_tg_ph">
        </div>
        <div class="team-player-block">
          <div class="team-player-title" data-i18n="sub_player2">Гравець 7 (запасний)</div>
          <input type="text" placeholder="ID в Standoff 2" id="sub2Id" data-i18n-placeholder="player_id_ph">
          <input type="text" placeholder="Нікнейм" id="sub2Nick" data-i18n-placeholder="player_nick_ph">
          <input type="text" placeholder="Telegram" id="sub2Tg" data-i18n-placeholder="player_tg_ph">
        </div>
        <button type="submit" class="done-btn" id="teamDoneBtn" data-i18n="team_done">Готово</button>
      </form>
      <div class="team-success-message" id="teamSuccessMsg" style="display:none;" data-i18n="team_created">Команду створено!</div>
    </div>
    <div id="langPopup" class="popup">
      <button class="lang-option" data-lang="uk">Українська</button>
      <button class="lang-option" data-lang="en">English</button>
      <button class="lang-option" data-lang="ru">Русский</button>
      <button class="lang-option" data-lang="pl">Polski</button>
    </div>
    <div id="notificationPopup" class="popup" style="right:60px; min-width:280px;">
      <div style="font-weight:bold; color:#00bfae; margin-bottom:8px;" id="notificationTitle">Сповіщення</div>
      <div id="notificationList" style="width:100%;"></div>
      <button id="clearNotificationsBtn" class="done-btn" style="margin-top:10px;">Очистити</button>
    </div>
  </div>
  <div id="adminModal">
    <div id="adminModalContent">
      <button id="closeAdminModal">✖️</button>
      <h2 id="adminMenuTitle" style="color:#00bfae; margin-top:0;">Адмін-меню</h2>
      <div style="display:flex; flex-direction:column; gap:12px;">
        <button id="banUserBtn" data-i18n="ban_user">🚫 Заблокувати користувача</button>
        <button id="unbanUserBtn" data-i18n="unban_user">✅ Розблокувати користувача</button>
        <button id="givePrizeBtn" data-i18n="give_prize">🏆 Видати приз</button>
        <button id="disqualifyTeamBtn" data-i18n="disqualify_team">❌ Дискваліфікувати команду</button>
        <button id="editBracketBtn" data-i18n="edit_bracket">🗂️ Модерувати сітку</button>
      </div>
      <div id="adminResult"></div>
    </div>
  </div>
  <div class="main-section active" id="mainSection">
    <div class="news-section">
      <div class="news-title" data-i18n="news">Новини</div>
      <div class="news-list" id="newsList">
        <div class="news-card">
          <h4 data-i18n="news4title">Підтримка польської!</h4>
          <p data-i18n="news4desc">Тепер в нашому додатку з'явилася підтримка польської мови.</p>
        </div>
        <div class="news-card">
          <h4 data-i18n="news5title">Оновлення турнірів!</h4>
          <p data-i18n="news5desc">Розділ "Турніри" оновлено!</p>
        </div>
      </div>
    </div>
    <div class="disciplines-section">
      <div class="disciplines-title" data-i18n="disciplines">Дисципліни</div>
      <div class="disciplines-list">
        <div class="discipline-card">
          <img src="Standoff2.jpg" alt="Standoff 2" class="discipline-img">
          <div class="discipline-name">Standoff 2</div>
        </div>
      </div>
    </div>
    <div class="tournaments-section">
      <div class="tournaments-title" data-i18n="tournaments">Турніри</div>
      <div class="tournament-list" id="tournamentList">
        <div class="tournament-card">
          <h4 data-i18n="tournament1title">Турнір для новачків</h4>
          <p data-i18n="tournament1desc">Реєстрація відкрита до 2025-07-15. Призовий фонд: 1000 грн.</p>
        </div>
        <div class="tournament-card">
          <h4 data-i18n="tournament2title">Літній кубок</h4>
          <p data-i18n="tournament2desc">Реєстрація відкрита до 2025-08-01. Призовий фонд: 5000 грн.</p>
        </div>
      </div>
    </div>
  </div>

  <div class="rules-section" id="rulesSection">
    <div class="disciplines-title" style="margin-bottom: 0px;" data-i18n="rules_title">Правила</div>
    <div class="dropdown">
      <details>
        <summary data-i18n="general_rules_summary">Загальні правила</summary>
        <div class="dropdown-content">
          <p data-i18n="general_rules_content">
            1. Повага до всіх учасників.<br>
            2. Заборонено використання читерського програмного забезпечення.<br>
            3. Дотримання розкладу матчів.
          </p>
        </div>
      </details>
    </div>
    <div class="dropdown">
      <details>
        <summary data-i18n="team_rules_summary">Правила для команд</summary>
        <div class="dropdown-content">
          <p data-i18n="team_rules_content">
            1. Команда повинна складатися з 5 основних гравців та 2 запасних.<br>
            2. Дозволено лише одну заміну під час матчу.
          </p>
        </div>
      </details>
    </div>
    <div class="dropdown">
      <details>
        <summary data-i18n="conduct_rules_summary">Правила поведінки</summary>
        <div class="dropdown-content">
          <p data-i18n="conduct_rules_content">
            1. Заборонені образи та нецензурна лексика.<br>
            2. Спортивна поведінка на всіх етапах турніру.
          </p>
        </div>
      </details>
    </div>
    <div class="dropdown">
      <details>
        <summary data-i18n="tournament_rules_5v5_summary">Правила Турнира по Standoff 2 (5 на 5)</summary>
        <div class="dropdown-content">
          <p>
            <strong data-i18n="general_provisions_title">1. Общие положения:</strong><br>
            <span data-i18n="general_provisions_content_1">Турнир проводится по дисциплине Standoff 2.</span><br>
            <span data-i18n="general_provisions_content_2">Формат матчей: 5 на 5.</span><br>
            <span data-i18n="general_provisions_content_3">Все участники обязаны соблюдать правила честной игры и проявлять уважение к другим игрокам и судьям турнира.</span>
          </p>
          <p>
            <strong data-i18n="participation_registration_title">2. Участие и регистрация:</strong><br>
            <span data-i18n="participation_registration_content_1">Команда состоит из 5 основных игроков и до 2 запасных.</span><br>
            <span data-i18n="participation_registration_content_2">Рагионы: Польша, Нидерланды, Франция.</span><br>
            <span data-i18n="participation_registration_content_3">Максимально допустимый пинг — 100 мс. Игроки с превышением этого значения могут быть отстранены от участия.</span><br>
            <span data-i18n="participation_registration_content_4">Регистрация проходит через указанную организаторами платформу или форму.</span>
          </p>
          <p>
            <strong data-i18n="technical_requirements_title">3. Технические требования:</strong><br>
            <span data-i18n="technical_requirements_content_1">Игра проводится только на мобильных устройствах. Использование эмуляторов запрещено.</span><br>
            <span data-i18n="technical_requirements_content_2">Проверка пинга производится перед каждым матчем.</span><br>
            <span data-i18n="technical_requirements_content_3">Использование VPN, прокси и любых средств для изменения региона/пинга строго запрещено.</span>
          </p>
          <p>
            <strong data-i18n="tournament_format_title">4. Формат турнира:</strong><br>
            <span data-i18n="tournament_format_content_1">Матчи группового этапа проходят в формате Best of 2 (BO2). Полуфинал — Best of 3 (BO3).</span><br>
            <span data-i18n="tournament_format_content_2">Финал – Best of 5 (BO5).</span><br>
            <span data-i18n="tournament_format_content_3">Победа присуждается команде, первой выигравшей 13 раундов.</span><br>
            <span data-i18n="tournament_format_content_4">Карты выбираются методом “ban/pick” (отказ/выбор).</span><br>
            <span data-i18n="tournament_format_content_5">Перерывы между половинами — 1 минута. Переключение сторон происходит после 12 раундов.</span>
          </p>
          <p>
            <strong data-i18n="player_conduct_title">5. Поведение игроков:</strong><br>
            <span data-i18n="player_conduct_content_1">Запрещено использование стороннего ПО, читов и багов.</span><br>
            <span data-i18n="player_conduct_content_2">Оскорбления, токсичное поведение и провокации запрещены.</span><br>
            <span data-i18n="player_conduct_content_3">Все спорные ситуации решаются судьёй матча. Решения администрации окончательны.</span>
          </p>
          <p>
            <strong data-i18n="match_interruption_title">6. Прерывание матча:</strong><br>
            <span data-i18n="match_interruption_content_1">При вылете игрока матч продолжается, если ситуация не критична.</span><br>
            <span data-i18n="match_interruption_content_2">В случае технических проблем команда обязана уведомить администратора в течение 2 минут.</span><br>
            <span data-i18n="match_interruption_content_3">Допускается 1 техническая пауза на матч продолжительностью до 5 минут (по согласованию с судьёй).</span>
          </p>
          <p>
            <strong data-i18n="sanctions_title">7. Санкции:</strong><br>
            <span data-i18n="sanctions_content_1">1-е нарушение правил — предупреждение.</span><br>
            <span data-i18n="sanctions_content_2">2-е — дисквалификация игрока или всей команды в зависимости от тяжести нарушения.</span><br>
            <span data-i18n="sanctions_content_3">Повторяющиеся нарушения — немедленное снятие с турнира.</span>
          </p>
          <p>
            <strong data-i18n="prizes_awards_title">8. Призы и награды:</strong><br>
            <span data-i18n="prizes_awards_content_1">Призовой фонд и распределение мест объявляются перед началом турнира.</span><br>
            <span data-i18n="prizes_awards_content_2">Призы распределяются внутри команды самостоятельно или поровну (по умолчанию).</span>
          </p>
        </div>
      </details>
    </div>
  </div>

  <div class="awards-section" id="awardsSection">
    <div class="disciplines-title" style="margin-bottom: 0px;" data-i18n="awards_title">Нагороди</div>
    <div class="dropdown">
      <details>
        <summary data-i18n="awards_info_summary">Інформація про нагороди</summary>
        <div class="dropdown-content">
          <p data-i18n="awards_info_content">
            Нагороди можуть включати грошові призи, внутрішньоігрові предмети,
            унікальні скіни та інші бонуси.
          </p>
        </div>
      </details>
    </div>
    <div class="dropdown">
      <details>
        <summary data-i18n="prize_distribution_summary">Розподіл призів</summary>
        <div class="dropdown-content">
          <p data-i18n="prize_distribution_content">
            1 місце: 50% від призового фонду.<br>
            2 місце: 30% від призового фонду.<br>
            3 місце: 20% від призового фонду.
          </p>
        </div>
      </details>
    </div>
  </div>

  <div class="support-section" id="supportSection">
    <div class="disciplines-title" style="margin-bottom: 0px;" data-i18n="support_title">Підтримка</div>
    <div class="dropdown">
      <details>
        <summary data-i18n="contact_summary">Зв'язатися з нами</summary>
        <div class="dropdown-content">
          <p data-i18n="contact_content">
            Якщо у вас виникли питання, будь ласка, зверніться до нашої
            служби підтримки через Telegram: @ваш_саппорт_телеграм.
          </p>
        </div>
      </details>
    </div>
    <div class="dropdown">
      <details>
        <summary data-i18n="faq_summary">Часті питання</summary>
        <div class="dropdown-content">
          <p data-i18n="faq_content">
            Ми постійно оновлюємо розділ FAQ на нашому сайті. Будь ласка,
            відвідайте його для отримання додаткової інформації.
          </p>
        </div>
      </details>
    </div>
  </div>

  <div class="bottom-nav">
    <div class="nav-item active" id="navMain" data-section="mainSection">
      <span>🏠</span>
      <span data-i18n="main">Головна</span>
    </div>
    <div class="nav-item" id="navRules" data-section="rulesSection">
      <span>📜</span>
      <span data-i18n="rules">Правила</span>
    </div>
    <div class="nav-item" id="navAwards" data-section="awardsSection">
      <span>🏆</span>
      <span data-i18n="awards">Нагороди</span>
    </div>
    <div class="nav-item" id="navSupport" data-section="supportSection">
      <span>🛠️</span>
      <span data-i18n="support">Підтримка</span>
    </div>
  </div>

  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script>
    const tg = window.Telegram.WebApp;
    tg.ready();
    tg.expand();

    const avatarBtn = document.getElementById('avatar');
    const profilePopup = document.getElementById('profilePopup');
    const registerBtn = document.getElementById('registerBtn');
    const profileForm = document.getElementById('profileForm');
    const doneBtn = document.getElementById('doneBtn');
    const standoffNickInput = document.getElementById('standoffNick');
    const standoffIdInput = document.getElementById('standoffId');
    const tgUserInput = document.getElementById('tgUser');
    const playerProfileDiv = document.getElementById('playerProfile');
    const profileNickSpan = document.getElementById('profileNick');
    const profileIdSpan = document.getElementById('profileId');
    const profileTgSpan = document.getElementById('profileTg');
    const successMsg = document.getElementById('successMsg');
    const createTeamBtn = document.getElementById('createTeamBtn');
    const teamForm = document.getElementById('teamForm');
    const teamDoneBtn = document.getElementById('teamDoneBtn');
    const teamSuccessMsg = document.getElementById('teamSuccessMsg');
    const teamAvatarInput = document.getElementById('teamAvatar');
    const teamAvatarPreview = document.getElementById('teamAvatarPreview');
    const teamTagInput = document.getElementById('teamTag');
    const teamNameInput = document.getElementById('teamName');
    const langBtn = document.getElementById('langBtn');
    const langPopup = document.getElementById('langPopup');
    const notificationBtn = document.getElementById('notificationBtn');
    const notificationPopup = document.getElementById('notificationPopup');
    const notificationBadge = document.getElementById('notificationBadge');
    const notificationList = document.getElementById('notificationList');
    const clearNotificationsBtn = document.getElementById('clearNotificationsBtn');
    const adminMenuBtn = document.getElementById('adminMenuBtn');
    const adminModal = document.getElementById('adminModal');
    const closeAdminModalBtn = document.getElementById('closeAdminModal');
    const adminResultDiv = document.getElementById('adminResult');

    // Навігація
    const navItems = document.querySelectorAll('.nav-item');
    const sections = document.querySelectorAll('.main-section, .rules-section, .awards-section, .support-section');

    const i18n = {
      uk: {
        register: 'Зареєструватись',
        standoff_nick: 'Нік в Standoff',
        standoff_id: 'ID в Standoff',
        tg_user: 'Telegram',
        done: 'Готово',
        profile_saved: 'Профіль збережено!',
        profile: 'Профіль гравця',
        create_team: 'Створити команду',
        team_avatar: 'Аватарка команди',
        team_tag: 'Тег команди',
        team_tag_ph: 'Наприклад, [PRO]',
        team_name: 'Назва команди',
        team_name_ph: 'Наприклад, Team Victory',
        player_id_ph: 'ID в Standoff 2',
        player_nick_ph: 'Нікнейм',
        player_tg_ph: 'Telegram',
        main_player1: 'Гравець 1 (основний)',
        main_player2: 'Гравець 2 (основний)',
        main_player3: 'Гравець 3 (основний)',
        main_player4: 'Гравець 4 (основний)',
        main_player5: 'Гравець 5 (основний)',
        sub_player1: 'Гравець 6 (запасний)',
        sub_player2: 'Гравець 7 (запасний)',
        team_done: 'Готово',
        team_created: 'Команду створено!',
        news: 'Новини',
        news4title: 'Підтримка польської!',
        news4desc: 'Тепер в нашому додатку з\'явилася підтримка польської мови.',
        news5title: 'Оновлення турнірів!',
        news5desc: 'Розділ "Турніри" оновлено!',
        disciplines: 'Дисципліни',
        tournaments: 'Турніри',
        tournament1title: 'Турнір для новачків',
        tournament1desc: 'Реєстрація відкрита до 2025-07-15. Призовий фонд: 1000 грн.',
        tournament2title: 'Літній кубок',
        tournament2desc: 'Реєстрація відкрита до 2025-08-01. Призовий фонд: 5000 грн.',
        main: 'Головна',
        rules: 'Правила',
        awards: 'Нагороди',
        support: 'Підтримка',
        rules_title: 'Правила',
        general_rules_summary: 'Загальні правила',
        general_rules_content: '1. Повага до всіх учасників.<br>2. Заборонено використання читерського програмного забезпечення.<br>3. Дотримання розкладу матчів.',
        team_rules_summary: 'Правила для команд',
        team_rules_content: '1. Команда повинна складатися з 5 основних гравців та 2 запасних.<br>2. Дозволено лише одну заміну під час матчу.',
        conduct_rules_summary: 'Правила поведінки',
        conduct_rules_content: '1. Заборонені образи та нецензурна лексика.<br>2. Спортивна поведінка на всіх етапах турніру.',
        tournament_rules_5v5_summary: 'Правила Турніру по Standoff 2 (5 на 5)',
        general_provisions_title: '1. Загальні положення:',
        general_provisions_content_1: 'Турнір проводиться по дисципліні Standoff 2.',
        general_provisions_content_2: 'Формат матчів: 5 на 5.',
        general_provisions_content_3: 'Всі учасники зобов\'язані дотримуватися правил чесної гри та виявляти повагу до інших гравців та суддів турніру.',
        participation_registration_title: '2. Участь та реєстрація:',
        participation_registration_content_1: 'Команда складається з 5 основних гравців та до 2 запасних.',
        participation_registration_content_2: 'Регіони: Польща, Нідерланди, Франція.',
        participation_registration_content_3: 'Максимально допустимий пінг — 100 мс. Гравці з перевищенням цього значення можуть бути відсторонені від участі.',
        participation_registration_content_4: 'Реєстрація проходить через вказану організаторами платформу або форму.',
        technical_requirements_title: '3. Технічні вимоги:',
        technical_requirements_content_1: 'Гра проводиться тільки на мобільних пристроях. Використання емуляторів заборонено.',
        technical_requirements_content_2: 'Перевірка пінгу проводиться перед кожним матчем.',
        technical_requirements_content_3: 'Використання VPN, проксі та будь-яких засобів для зміни регіону/пінгу суворо заборонено.',
        tournament_format_title: '4. Формат турніру:',
        tournament_format_content_1: 'Матчі групового етапу проходять у форматі Best of 2 (BO2). Півфінал — Best of 3 (BO3).',
        tournament_format_content_2: 'Фінал – Best of 5 (BO5).',
        tournament_format_content_3: 'Перемога присуджується команді, яка першою виграла 13 раундів.',
        tournament_format_content_4: 'Карти вибираються методом “ban/pick” (відмова/вибір).',
        tournament_format_content_5: 'Перерви між половинами — 1 хвилина. Перемикання сторін відбувається після 12 раундів.',
        player_conduct_title: '5. Поведінка гравців:',
        player_conduct_content_1: 'Заборонено використання стороннього ПЗ, читів та багів.',
        player_conduct_content_2: 'Образи, токсична поведінка та провокації заборонені.',
        player_conduct_content_3: 'Всі спірні ситуації вирішуються суддею матчу. Рішення адміністрації остаточні.',
        match_interruption_title: '6. Переривання матчу:',
        match_interruption_content_1: 'При вильоті гравця матч продовжується, якщо ситуація не критична.',
        match_interruption_content_2: 'У разі технічних проблем команда зобов\'язана повідомити адміністратора протягом 2 хвилин.',
        match_interruption_content_3: 'Допускається 1 технічна пауза на матч тривалістю до 5 хвилин (за погодженням із суддею).',
        sanctions_title: '7. Санкції:',
        sanctions_content_1: '1-е порушення правил — попередження.',
        sanctions_content_2: '2-е — дискваліфікація гравця або всієї команди в залежності від тяжкості порушення.',
        sanctions_content_3: 'Повторювані порушення — негайне зняття з турніру.',
        prizes_awards_title: '8. Призи та нагороди:',
        prizes_awards_content_1: 'Призовий фонд та розподіл місць оголошуються перед початком турніру.',
        prizes_awards_content_2: 'Призи розподіляються всередині команди самостійно або порівну (за замовчуванням).',
        notification_team_created_captain: 'Команду "{teamName}" створено! Запрошення надіслано гравцям: {invitedUsers}.',
        admin_panel: 'Адмін-панель',
        ban_user: '🚫 Заблокувати користувача',
        unban_user: '✅ Розблокувати користувача',
        give_prize: '🏆 Видати приз',
        disqualify_team: '❌ Дискваліфікувати команду',
        edit_bracket: '🗂️ Модерувати сітку',
        notification_new_invite: 'Ви отримали запрошення приєднатися до команди "{teamName}" від @{captainUsername}!',
        notification_invite_accepted_captain: '@{playerUsername} прийняв ваше запрошення до команди "{teamName}".',
        notification_invite_declined_captain: '@{playerUsername} відхилив ваше запрошення до команди "{teamName}".',
        notification_invite_accepted_player: 'Ви успішно приєдналися до команди "{teamName}"!',
        notification_invite_declined_player: 'Ви відхилили запрошення до команди "{teamName}".',
        error: 'Помилка',
        error_api: 'Помилка API',
        no_notifications: 'Немає сповіщень.'
      },
      en: {
        register: 'Register',
        standoff_nick: 'Standoff Nick',
        standoff_id: 'Standoff ID',
        tg_user: 'Telegram',
        done: 'Done',
        profile_saved: 'Profile saved!',
        profile: 'Player Profile',
        create_team: 'Create Team',
        team_avatar: 'Team Avatar',
        team_tag: 'Team Tag',
        team_tag_ph: 'e.g., [PRO]',
        team_name: 'Team Name',
        team_name_ph: 'e.g., Team Victory',
        player_id_ph: 'Standoff 2 ID',
        player_nick_ph: 'Nickname',
        player_tg_ph: 'Telegram',
        main_player1: 'Player 1 (Main)',
        main_player2: 'Player 2 (Main)',
        main_player3: 'Player 3 (Main)',
        main_player4: 'Player 4 (Main)',
        main_player5: 'Player 5 (Main)',
        sub_player1: 'Player 6 (Sub)',
        sub_player2: 'Player 7 (Sub)',
        team_done: 'Done',
        team_created: 'Team created!',
        news: 'News',
        news4title: 'Polish language support!',
        news4desc: 'Our app now supports Polish.',
        news5title: 'Tournaments Update!',
        news5desc: 'The "Tournaments" section has been updated!',
        disciplines: 'Disciplines',
        tournaments: 'Tournaments',
        tournament1title: 'Beginner Tournament',
        tournament1desc: 'Registration open until 2025-07-15. Prize pool: 1000 UAH.',
        tournament2title: 'Summer Cup',
        tournament2desc: 'Registration open until 2025-08-01. Prize pool: 5000 UAH.',
        main: 'Home',
        rules: 'Rules',
        awards: 'Awards',
        support: 'Support',
        rules_title: 'Rules',
        general_rules_summary: 'General Rules',
        general_rules_content: '1. Respect all participants.<br>2. Cheating software is prohibited.<br>3. Adhere to match schedules.',
        team_rules_summary: 'Team Rules',
        team_rules_content: '1. A team must consist of 5 main players and 2 substitutes.<br>2. Only one substitution is allowed during a match.',
        conduct_rules_summary: 'Conduct Rules',
        conduct_rules_content: '1. Insults and profanity are prohibited.<br>2. Sportsmanlike conduct throughout the tournament.',
        tournament_rules_5v5_summary: 'Standoff 2 Tournament Rules (5 vs 5)',
        general_provisions_title: '1. General Provisions:',
        general_provisions_content_1: 'The tournament is held in the discipline of Standoff 2.',
        general_provisions_content_2: 'Match format: 5 vs 5.',
        general_provisions_content_3: 'All participants are required to observe fair play rules and show respect to other players and tournament judges.',
        participation_registration_title: '2. Participation and registration:',
        participation_registration_content_1: 'A team consists of 5 main players and up to 2 substitutes.',
        participation_registration_content_2: 'Regions: Poland, Netherlands, France.',
        participation_registration_content_3: 'Maximum allowed ping is 100 ms. Players exceeding this value may be suspended from participation.',
        participation_registration_content_4: 'Registration takes place through the platform or form specified by the organizers.',
        technical_requirements_title: '3. Technical Requirements:',
        technical_requirements_content_1: 'The game is played only on mobile devices. Use of emulators is prohibited.',
        technical_requirements_content_2: 'Ping check is performed before each match.',
        technical_requirements_content_3: 'Use of VPN, proxies, and any means to change region/ping is strictly prohibited.',
        tournament_format_title: '4. Tournament Format:',
        tournament_format_content_1: 'Group stage matches are played in Best of 2 (BO2) format. Semifinals — Best of 3 (BO3).',
        tournament_format_content_2: 'Final – Best of 5 (BO5).',
        tournament_format_content_3: 'Victory is awarded to the team that first wins 13 rounds.',
        tournament_format_content_4: 'Maps are selected using the “ban/pick” method.',
        tournament_format_content_5: 'Breaks between halves — 1 minute. Sides switch after 12 rounds.',
        player_conduct_title: '5. Player Conduct:',
        player_conduct_content_1: 'Use of third-party software, cheats, and bugs is prohibited.',
        player_conduct_content_2: 'Insults, toxic behavior, and provocations are prohibited.',
        player_conduct_content_3: 'All disputes are resolved by the match judge. Administration decisions are final.',
        match_interruption_title: '6. Match Interruption:',
        match_interruption_content_1: 'If a player disconnects, the match continues if the situation is not critical.',
        match_interruption_content_2: 'In case of technical problems, the team must notify the administrator within 2 minutes.',
        match_interruption_content_3: '1 technical pause per match is allowed, up to 5 minutes (by agreement with the judge).',
        sanctions_title: '7. Sanctions:',
        sanctions_content_1: '1st violation of rules — warning.',
        sanctions_content_2: '2nd — disqualification of the player or the entire team depending on the severity of the violation.',
        sanctions_content_3: 'Repeated violations — immediate removal from the tournament.',
        prizes_awards_title: '8. Prizes and Awards:',
        prizes_awards_content_1: 'Prize fund and placement distribution are announced before the start of the tournament.',
        prizes_awards_content_2: 'Prizes are distributed within the team independently or equally (by default).',
        notification_team_created_captain: 'Team "{teamName}" created! Invitations sent to players: {invitedUsers}.',
        admin_panel: 'Admin Panel',
        ban_user: '🚫 Ban User',
        unban_user: '✅ Unban User',
        give_prize: '🏆 Give Prize',
        disqualify_team: '❌ Disqualify Team',
        edit_bracket: '🗂️ Moderate Bracket',
        notification_new_invite: 'You received an invitation to join team "{teamName}" from @{captainUsername}!',
        notification_invite_accepted_captain: '@{playerUsername} accepted your invitation to team "{teamName}".',
        notification_invite_declined_captain: '@{playerUsername} declined your invitation to team "{teamName}".',
        notification_invite_accepted_player: 'You successfully joined team "{teamName}"!',
        notification_invite_declined_player: 'You declined the invitation to team "{teamName}".',
        error: 'Error',
        error_api: 'API Error',
        no_notifications: 'No notifications.'
      },
      ru: {
        register: 'Зарегистрироваться',
        standoff_nick: 'Ник в Standoff',
        standoff_id: 'ID в Standoff',
        tg_user: 'Telegram',
        done: 'Готово',
        profile_saved: 'Профиль сохранен!',
        profile: 'Профиль игрока',
        create_team: 'Создать команду',
        team_avatar: 'Аватарка команды',
        team_tag: 'Тег команды',
        team_tag_ph: 'Например, [PRO]',
        team_name: 'Название команды',
        team_name_ph: 'Например, Team Victory',
        player_id_ph: 'ID в Standoff 2',
        player_nick_ph: 'Никнейм',
        player_tg_ph: 'Telegram',
        main_player1: 'Игрок 1 (основной)',
        main_player2: 'Игрок 2 (основной)',
        main_player3: 'Игрок 3 (основной)',
        main_player4: 'Игрок 4 (основной)',
        main_player5: 'Игрок 5 (основной)',
        sub_player1: 'Игрок 6 (запасной)',
        sub_player2: 'Игрок 7 (запасной)',
        team_done: 'Готово',
        team_created: 'Команда создана!',
        news: 'Новости',
        news4title: 'Поддержка польского языка!',
        news4desc: 'Теперь в нашем приложении появилась поддержка польского языка.',
        news5title: 'Обновление турниров!',
        news5desc: 'Раздел "Турниры" обновлен!',
        disciplines: 'Дисциплины',
        tournaments: 'Турниры',
        tournament1title: 'Турнир для новичков',
        tournament1desc: 'Регистрация открыта до 2025-07-15. Призовой фонд: 1000 грн.',
        tournament2title: 'Летний кубок',
        tournament2desc: 'Регистрация открыта до 2025-08-01. Призовой фонд: 5000 грн.',
        main: 'Главная',
        rules: 'Правила',
        awards: 'Награды',
        support: 'Поддержка',
        rules_title: 'Правила',
        general_rules_summary: 'Общие правила',
        general_rules_content: '1. Уважение ко всем участникам.<br>2. Запрещено использование читерского программного обеспечения.<br>3. Соблюдение расписания матчей.',
        team_rules_summary: 'Правила для команд',
        team_rules_content: '1. Команда должна состоять из 5 основных игроков и 2 запасных.<br>2. Разрешена только одна замена во время матча.',
        conduct_rules_summary: 'Правила поведения',
        conduct_rules_content: '1. Запрещены оскорбления и нецензурная лексика.<br>2. Спортивное поведение на всех этапах турнира.',
        tournament_rules_5v5_summary: 'Правила Турнира по Standoff 2 (5 на 5)',
        general_provisions_title: '1. Общие положения:',
        general_provisions_content_1: 'Турнир проводится по дисциплине Standoff 2.',
        general_provisions_content_2: 'Формат матчей: 5 на 5.',
        general_provisions_content_3: 'Все участники обязаны соблюдать правила честной игры и проявлять уважение к другим игрокам и судьям турнира.',
        participation_registration_title: '2. Участие и регистрация:',
        participation_registration_content_1: 'Команда состоит из 5 основных игроков и до 2 запасных.',
        participation_registration_content_2: 'Регионы: Польша, Нидерланды, Франция.',
        participation_registration_content_3: 'Максимально допустимый пинг — 100 мс. Игроки с превышением этого значения могут быть отстранены от участия.',
        participation_registration_content_4: 'Регистрация проходит через указанную организаторами платформу или форму.',
        technical_requirements_title: '3. Технические требования:',
        technical_requirements_content_1: 'Игра проводится только на мобильных устройствах. Использование эмуляторов запрещено.',
        technical_requirements_content_2: 'Проверка пинга производится перед каждым матчем.',
        technical_requirements_content_3: 'Использование VPN, прокси и любых средств для изменения региона/пинга строго запрещено.',
        tournament_format_title: '4. Формат турнира:',
        tournament_format_content_1: 'Матчи группового этапа проходят в формате Best of 2 (BO2). Полуфинал — Best of 3 (BO3).',
        tournament_format_content_2: 'Финал – Best of 5 (BO5).',
        tournament_format_content_3: 'Победа присуждается команде, первой выигравшей 13 раундов.',
        tournament_format_content_4: 'Карты выбираются методом “ban/pick” (отказ/выбор).',
        tournament_format_content_5: 'Перерывы между половинами — 1 минута. Переключение сторон происходит после 12 раундов.',
        player_conduct_title: '5. Поведение игроков:',
        player_conduct_content_1: 'Запрещено использование стороннего ПО, читов и багов.',
        player_conduct_content_2: 'Оскорбления, токсичное поведение и провокации запрещены.',
        player_conduct_content_3: 'Все спорные ситуации решаются судьёй матча. Решения администрации окончательны.',
        match_interruption_title: '6. Прерывание матча:',
        match_interruption_content_1: 'При вылете игрока матч продолжается, если ситуация не критична.',
        match_interruption_content_2: 'В случае технических проблем команда обязана уведомить администратора в течение 2 минут.',
        match_interruption_content_3: 'Допускается 1 техническая пауза на матч продолжительностью до 5 минут (по согласованию с судьёй).',
        sanctions_title: '7. Санкции:',
        sanctions_content_1: '1-е нарушение правил — предупреждение.',
        sanctions_content_2: '2-е — дисквалификация игрока или всей команды в зависимости от тяжести нарушения.',
        sanctions_content_3: 'Повторяющиеся нарушения — немедленное снятие с турнира.',
        prizes_awards_title: '8. Призы и награды:',
        prizes_awards_content_1: 'Призовой фонд и распределение мест объявляются перед началом турнира.',
        prizes_awards_content_2: 'Призы распределяются внутри команды самостоятельно или поровну (по умолчанию).',
        notification_team_created_captain: 'Команда "{teamName}" создана! Приглашения отправлены игрокам: {invitedUsers}.',
        admin_panel: 'Админ-панель',
        ban_user: '🚫 Заблокировать пользователя',
        unban_user: '✅ Разблокировать пользователя',
        give_prize: '🏆 Выдать приз',
        disqualify_team: '❌ Дисквалифицировать команду',
        edit_bracket: '🗂️ Модерировать сетку',
        notification_new_invite: 'Вы получили приглашение присоединиться к команде "{teamName}" от @{captainUsername}!',
        notification_invite_accepted_captain: '@{playerUsername} принял ваше приглашение в команду "{teamName}".',
        notification_invite_declined_captain: '@{playerUsername} отклонил ваше приглашение в команду "{teamName}".',
        notification_invite_accepted_player: 'Вы успешно присоединились к команде "{teamName}"!',
        notification_invite_declined_player: 'Вы отклонили приглашение в команду "{teamName}".',
        error: 'Ошибка',
        error_api: 'Ошибка API',
        no_notifications: 'Нет уведомлений.'
      },
      pl: {
        register: 'Zarejestruj się',
        standoff_nick: 'Nick w Standoff',
        standoff_id: 'ID w Standoff',
        tg_user: 'Telegram',
        done: 'Gotowe',
        profile_saved: 'Profil zapisany!',
        profile: 'Profil gracza',
        create_team: 'Stwórz drużynę',
        team_avatar: 'Awatar drużyny',
        team_tag: 'Tag drużyny',
        team_tag_ph: 'Np. [PRO]',
        team_name: 'Nazwa drużyny',
        team_name_ph: 'Np. Team Victory',
        player_id_ph: 'ID w Standoff 2',
        player_nick_ph: 'Pseudonim',
        player_tg_ph: 'Telegram',
        main_player1: 'Gracz 1 (główny)',
        main_player2: 'Gracz 2 (główny)',
        main_player3: 'Gracz 3 (główny)',
        main_player4: 'Gracz 4 (główny)',
        main_player5: 'Gracz 5 (główny)',
        sub_player1: 'Gracz 6 (rezerwowy)',
        sub_player2: 'Gracz 7 (rezerwowy)',
        team_done: 'Gotowe',
        team_created: 'Drużyna stworzona!',
        news: 'Aktualności',
        news4title: 'Wsparcie języka polskiego!',
        news4desc: 'Nasza aplikacja obsługuje teraz język polski.',
        news5title: 'Aktualizacja turniejów!',
        news5desc: 'Sekcja "Turnieje" została zaktualizowana!',
        disciplines: 'Dyscypliny',
        tournaments: 'Turnieje',
        tournament1title: 'Turniej dla początkujących',
        tournament1desc: 'Rejestracja otwarta do 2025-07-15. Pula nagród: 1000 UAH.',
        tournament2title: 'Puchar Letni',
        tournament2desc: 'Rejestracja otwarta do 2025-08-01. Pula nagród: 5000 UAH.',
        main: 'Główna',
        rules: 'Zasady',
        awards: 'Nagrody',
        support: 'Wsparcie',
        rules_title: 'Zasady',
        general_rules_summary: 'Ogólne zasady',
        general_rules_content: '1. Szacunek dla wszystkich uczestników.<br>2. Zabronione jest używanie oprogramowania oszukującego.<br>3. Przestrzeganie harmonogramu meczów.',
        team_rules_summary: 'Zasady dla drużyn',
        team_rules_content: '1. Drużyna musi składać się z 5 głównych graczy i 2 rezerwowych.<br>2. Dozwolona jest tylko jedna zmiana podczas meczu.',
        conduct_rules_summary: 'Zasady zachowania',
        conduct_rules_content: '1. Zabronione są obrazy i wulgaryzmy.<br>2. Sportowe zachowanie na wszystkich etapach turnieju.',
        tournament_rules_5v5_summary: 'Zasady turnieju Standoff 2 (5 na 5)',
        general_provisions_title: '1. Postanowienia ogólne:',
        general_provisions_content_1: 'Turniej odbywa się w dyscyplinie Standoff 2.',
        general_provisions_content_2: 'Format meczów: 5 na 5.',
        general_provisions_content_3: 'Wszyscy uczestnicy zobowiązani są do przestrzegania zasad uczciwej gry oraz okazywania szacunku innym graczom i sędziom turnieju.',
        participation_registration_title: '2. Uczestnictwo i rejestracja:',
        participation_registration_content_1: 'Drużyna składa się z 5 graczy podstawowych i do 2 rezerwowych.',
        participation_registration_content_2: 'Regiony: Polska, Holandia, Francja.',
        participation_registration_content_3: 'Maksymalny dopuszczalny ping to 100 ms. Gracze przekraczający tę wartość mogą zostać wykluczeni z udziału.',
        participation_registration_content_4: 'Rejestracja odbywa się za pośrednictwem platformy lub formularza wskazanego przez organizatorów.',
        technical_requirements_title: '3. Wymagania techniczne:',
        technical_requirements_content_1: 'Gra odbywa się wyłącznie na urządzeniach mobilnych. Korzystanie z emulatorów jest zabronione.',
        technical_requirements_content_2: 'Sprawdzenie pingu odbywa się przed każdym meczem.',
        technical_requirements_content_3: 'Używanie VPN, serwerów proxy i wszelkich środków do zmiany regionu/pingu jest surowo zabronione.',
        tournament_format_title: '4. Format turnieju:',
        tournament_format_content_1: 'Mecze fazy grupowej rozgrywane są w formacie Best of 2 (BO2). Półfinały — Best of 3 (BO3).',
        tournament_format_content_2: 'Finał – Best of 5 (BO5).',
        tournament_format_content_3: 'Zwycięstwo przyznawane jest drużynie, która jako pierwsza wygra 13 rund.',
        tournament_format_content_4: 'Mapy wybierane są metodą „ban/pick” (odrzucenie/wybór).',
        tournament_format_content_5: 'Przerwy między połowami — 1 minuta. Zmiana stron następuje po 12 rundach.',
        player_conduct_title: '5. Zachowanie graczy:',
        player_conduct_content_1: 'Zabronione jest używanie zewnętrznego oprogramowania, cheatów i błędów.',
        player_conduct_content_2: 'Obrażanie, toksyczne zachowanie i prowokacje są zabronione.',
        player_conduct_content_3: 'Wszystkie sporne sytuacje rozstrzyga sędzia meczu. Decyzje administracji są ostateczne.',
        match_interruption_title: '6. Przerwanie meczu:',
        match_interruption_content_1: 'W przypadku wylotu gracza mecz jest kontynuowany, jeśli sytuacja nie jest krytyczna.',
        match_interruption_content_2: 'W przypadku problemów technicznych drużyna zobowiązana jest powiadomić administratora w ciągu 2 minut.',
        match_interruption_content_3: 'Dozwolona jest 1 pauza techniczna na mecz trwająca do 5 minut (w porozumieniu z sędzią).',
        sanctions_title: '7. Sankcje:',
        sanctions_content_1: '1. naruszenie zasad — ostrzeżenie.',
        sanctions_content_2: '2. — dyskwalifikacja gracza lub całej drużyny w zależności od wagi naruszenia.',
        sanctions_content_3: 'Powtarzające się naruszenia — natychmiastowe usunięcie z turnieju.',
        prizes_awards_title: '8. Nagrody:',
        prizes_awards_content_1: 'Pula nagród i podział miejsc są ogłaszane przed rozpoczęciem turnieju.',
        prizes_awards_content_2: 'Nagrody są rozdzielane wewnątrz drużyny samodzielnie lub równo (domyślnie).',
        notification_team_created_captain: 'Drużyna "{teamName}" stworzona! Zaproszenia wysłane do graczy: {invitedUsers}.',
        admin_panel: 'Panel administratora',
        ban_user: '🚫 Zbanuj użytkownika',
        unban_user: '✅ Odbanuj użytkownika',
        give_prize: '🏆 Przyznaj nagrodę',
        disqualify_team: '❌ Zdyskwalifikuj drużynę',
        edit_bracket: '🗂️ Moderuj drabinkę',
        notification_new_invite: 'Otrzymałeś zaproszenie do drużyny "{teamName}" od @{captainUsername}!',
        notification_invite_accepted_captain: '@{playerUsername} zaakceptował Twoje zaproszenie do drużyny "{teamName}".',
        notification_invite_declined_captain: '@{playerUsername} odrzucił Twoje zaproszenie do drużyny "{teamName}".',
        notification_invite_accepted_player: 'Pomyślnie dołączyłeś do drużyny "{teamName}"!',
        notification_invite_declined_player: 'Odrzuciłeś zaproszenie do drużyny "{teamName}".',
        error: 'Błąd',
        error_api: 'Błąd API',
        no_notifications: 'Brak powiadomień.'
      }
    };

    let currentLang = localStorage.getItem('lang') || 'uk';

    function applyTranslations() {
      document.querySelectorAll('[data-i18n]').forEach(element => {
        const key = element.getAttribute('data-i18n');
        if (i18n[currentLang] && i18n[currentLang][key]) {
          element.textContent = i18n[currentLang][key];
        }
      });
      document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
        const key = element.getAttribute('data-i18n-placeholder');
        if (i18n[currentLang] && i18n[currentLang][key]) {
          element.placeholder = i18n[currentLang][key];
        }
      });
      // Оновити заголовки dropdown, якщо вони містять data-i18n
      document.querySelectorAll('details summary[data-i18n]').forEach(element => {
          const key = element.getAttribute('data-i18n');
          if (i18n[currentLang] && i18n[currentLang][key]) {
              element.textContent = i18n[currentLang][key];
          }
      });
      // Оновити вміст dropdown, якщо вони містять data-i18n
      document.querySelectorAll('div.dropdown-content p strong[data-i18n], div.dropdown-content p span[data-i18n]').forEach(element => {
          const key = element.getAttribute('data-i18n');
          if (i18n[currentLang] && i18n[currentLang][key]) {
              element.innerHTML = i18n[currentLang][key]; // Використовуємо innerHTML для <br>
          }
      });
    }

    applyTranslations();

    document.querySelectorAll('.lang-option').forEach(button => {
      button.addEventListener('click', () => {
        currentLang = button.dataset.lang;
        localStorage.setItem('lang', currentLang);
        applyTranslations();
        langPopup.classList.remove('active');
      });
    });

    langBtn.addEventListener('click', () => {
      langPopup.classList.toggle('active');
      profilePopup.classList.remove('active');
      notificationPopup.classList.remove('active');
    });

    avatarBtn.addEventListener('click', () => {
      profilePopup.classList.toggle('active');
      langPopup.classList.remove('active');
      notificationPopup.classList.remove('active');
      displayProfile();
    });

    notificationBtn.addEventListener('click', () => {
      notificationPopup.classList.toggle('active');
      profilePopup.classList.remove('active');
      langPopup.classList.remove('active');
      updateNotificationBadge();
      displayNotifications();
    });

    clearNotificationsBtn.addEventListener('click', () => {
      clearNotifications();
      updateNotificationBadge();
      displayNotifications();
    });

    // Оновлення полів профілю з Telegram WebApp
    if (tg.initDataUnsafe && tg.initDataUnsafe.user) {
      tgUserInput.value = `@${tg.initDataUnsafe.user.username}`;
    }

    // Зберігання та завантаження профілю
    function saveProfile() {
      const profileData = {
        standoffNick: standoffNickInput.value,
        standoffId: standoffIdInput.value,
        tgUser: tgUserInput.value,
      };
      localStorage.setItem('userProfile', JSON.stringify(profileData));
      displayProfile();
      successMsg.style.display = 'block';
      setTimeout(() => successMsg.style.display = 'none', 3000);
    }

    function loadProfile() {
      const profileData = JSON.parse(localStorage.getItem('userProfile'));
      if (profileData) {
        standoffNickInput.value = profileData.standoffNick;
        standoffIdInput.value = profileData.standoffId;
        tgUserInput.value = profileData.tgUser;
        registerBtn.style.display = 'none';
        profileForm.style.display = 'none';
        playerProfileDiv.style.display = 'block';
        createTeamBtn.style.display = 'block';
        displayProfile();
      } else {
        registerBtn.style.display = 'block';
        profileForm.style.display = 'none';
        playerProfileDiv.style.display = 'none';
        createTeamBtn.style.display = 'none';
      }
    }

    function displayProfile() {
      const profileData = JSON.parse(localStorage.getItem('userProfile'));
      if (profileData) {
        profileNickSpan.textContent = profileData.standoffNick;
        profileIdSpan.textContent = profileData.standoffId;
        profileTgSpan.textContent = profileData.tgUser;
        playerProfileDiv.style.display = 'block';
        registerBtn.style.display = 'none';
        profileForm.style.display = 'none';
        createTeamBtn.style.display = 'block';
      } else {
        playerProfileDiv.style.display = 'none';
        registerBtn.style.display = 'block';
        createTeamBtn.style.display = 'none';
      }
    }

    registerBtn.addEventListener('click', () => {
      registerBtn.style.display = 'none';
      profileForm.style.display = 'flex';
      playerProfileDiv.style.display = 'none';
      createTeamBtn.style.display = 'none';
      // Перезаповнити tgUser, якщо WebApp дані доступні
      if (tg.initDataUnsafe && tg.initDataUnsafe.user) {
        tgUserInput.value = `@${tg.initDataUnsafe.user.username}`;
      }
    });

    profileForm.addEventListener('submit', (e) => {
      e.preventDefault();
      saveProfile();
    });

    // Функціонал створення команди
    createTeamBtn.addEventListener('click', () => {
      profilePopup.classList.remove('active');
      teamForm.style.display = 'flex';
      createTeamBtn.style.display = 'none';
      // Можемо приховати інші елементи профілю, якщо потрібно
      playerProfileDiv.style.display = 'none';
      successMsg.style.display = 'none';
      registerBtn.style.display = 'none';
      profileForm.style.display = 'none';
    });

    teamAvatarInput.addEventListener('change', (event) => {
      const file = event.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = (e) => {
          teamAvatarPreview.src = e.target.result;
          teamAvatarPreview.style.display = 'block';
        };
        reader.readAsDataURL(file);
      } else {
        teamAvatarPreview.style.display = 'none';
        teamAvatarPreview.src = '#';
      }
    });

    teamForm.addEventListener('submit', async (e) => {
      e.preventDefault();

      const teamName = teamNameInput.value;
      const teamTag = teamTagInput.value;
      const captainUsername = tgUserInput.value.replace('@', ''); // Отримуємо Telegram юзернейм капітана

      const players = [];
      for (let i = 1; i <= 5; i++) {
        const id = document.getElementById(`main${i}Id`).value;
        const nick = document.getElementById(`main${i}Nick`).value;
        const tg = document.getElementById(`main${i}Tg`).value;
        if (id && nick) { // Telegram username is not strictly required for main players, but desired for invites
          players.push({ id, nick, tg });
        }
      }
      for (let i = 1; i <= 2; i++) {
        const id = document.getElementById(`sub${i}Id`).value;
        const nick = document.getElementById(`sub${i}Nick`).value;
        const tg = document.getElementById(`sub${i}Tg`).value;
        if (id && nick) { // Telegram username is not strictly required for substitutes, but desired for invites
          players.push({ id, nick, tg });
        }
      }

      const teamData = {
        team_name: teamName,
        team_tag: teamTag,
        captain_username: captainUsername,
        // Відправляємо тільки Telegram юзернейми запрошених гравців на бекенд
        players: players.filter(p => p.tg && p.tg.trim() !== '').map(p => p.tg.replace('@', ''))
      };

      try {
        const response = await fetch('/api/create_team', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(teamData),
        });

        const result = await response.json();

        if (result.success) {
          const invitedPlayers = teamData.players.length > 0
            ? teamData.players.map(username => `@${username}`).join(', ')
            : i18n[currentLang]['немає']; // Використовуємо переклад для "немає"

          addNotification('team_created_captain', {
            teamName: teamName,
            invitedUsers: invitedPlayers
          });

          teamForm.style.display = "none";
          teamSuccessMsg.style.display = "block";
          createTeamBtn.style.display = "block"; // Показуємо кнопку "Створити команду" знову
          loadProfile(); // Оновлюємо відображення профілю
        } else {
          alert(`${i18n[currentLang]['error'] || 'Помилка'}: ${result.message}`);
        }
      } catch (error) {
        console.error('Error creating team:', error);
        alert(`${i18n[currentLang]['error_api'] || 'Помилка API'}: ${error.message}`);
      }
    });

    // Функціонал сповіщень
    function getNotifications() {
      return JSON.parse(localStorage.getItem('notifications')) || [];
    }

    function saveNotifications(notifications) {
      localStorage.setItem('notifications', JSON.stringify(notifications));
    }

    function addNotification(type, data) {
      const notifications = getNotifications();
      let message = i18n[currentLang][`notification_${type}`] || `Unknown notification type: ${type}`;
      for (const key in data) {
        message = message.replace(`{${key}}`, data[key]);
      }
      notifications.unshift({ id: Date.now(), message: message, read: false }); // Додати нове сповіщення на початок
      saveNotifications(notifications);
      updateNotificationBadge();
      displayNotifications();
    }

    function updateNotificationBadge() {
      const notifications = getNotifications();
      const unreadCount = notifications.filter(n => !n.read).length;
      if (unreadCount > 0) {
        notificationBadge.textContent = unreadCount;
        notificationBadge.style.display = 'flex';
      } else {
        notificationBadge.style.display = 'none';
      }
    }

    function displayNotifications() {
      const notifications = getNotifications();
      notificationList.innerHTML = '';
      if (notifications.length === 0) {
        notificationList.innerHTML = `<div class="notification-item" style="text-align:center; color:#aaa;" data-i18n="no_notifications">Немає сповіщень.</div>`;
        return;
      }
      notifications.forEach(n => {
        const item = document.createElement('div');
        item.classList.add('notification-item');
        if (!n.read) {
          item.style.fontWeight = 'bold'; // Виділити непрочитані
        }
        item.textContent = n.message;
        item.addEventListener('click', () => {
          n.read = true;
          saveNotifications(notifications);
          updateNotificationBadge();
          displayNotifications(); // Оновити відображення, щоб прибрати жирний шрифт
        });
        notificationList.appendChild(item);
      });
    }

    function clearNotifications() {
      localStorage.removeItem('notifications');
      updateNotificationBadge();
      displayNotifications();
    }

    // Адмін-меню
    adminMenuBtn.addEventListener('click', () => {
      adminModal.classList.add('active');
    });

    closeAdminModalBtn.addEventListener('click', () => {
      adminModal.classList.remove('active');
      adminResultDiv.textContent = ''; // Очистити результат при закритті
    });

    // Закриття модального вікна при кліку поза ним
    adminModal.addEventListener('click', (e) => {
      if (e.target === adminModal) {
        adminModal.classList.remove('active');
        adminResultDiv.textContent = '';
      }
    });

    document.getElementById('banUserBtn').addEventListener('click', () => {
        adminResultDiv.textContent = 'Функціонал блокування користувача в розробці.';
    });
    document.getElementById('unbanUserBtn').addEventListener('click', () => {
        adminResultDiv.textContent = 'Функціонал розблокування користувача в розробці.';
    });
    document.getElementById('givePrizeBtn').addEventListener('click', () => {
        adminResultDiv.textContent = 'Функціонал видачі призів в розробці.';
    });
    document.getElementById('disqualifyTeamBtn').addEventListener('click', () => {
        adminResultDiv.textContent = 'Функціонал дискваліфікації команди в розробці.';
    });
    document.getElementById('editBracketBtn').addEventListener('click', () => {
        adminResultDiv.textContent = 'Функціонал модерування сітки в розробці.';
    });


    // Ініціалізація
    loadProfile();
    updateNotificationBadge();
    displayNotifications(); // Показати сповіщення при завантаженні

    // Нижня навігація
    navItems.forEach(item => {
      item.addEventListener('click', () => {
        const targetSectionId = item.dataset.section;

        // Зняти active з усіх елементів навігації
        navItems.forEach(nav => nav.classList.remove('active'));
        // Додати active до натиснутого елемента
        item.classList.add('active');

        // Приховати всі секції
        sections.forEach(section => section.classList.remove('active'));
        // Показати цільову секцію
        document.getElementById(targetSectionId).classList.add('active');
      });
    });

    // Перевірка Telegram WebApp для відображення Admin Menu
    if (tg.initDataUnsafe && tg.initDataUnsafe.user && tg.initDataUnsafe.user.is_admin) {
      adminMenuBtn.style.display = 'block';
    } else {
      adminMenuBtn.style.display = 'none';
    }

  </script>
</body>
</html>
