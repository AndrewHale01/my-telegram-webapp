<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Telegram WebApp</title>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-TZN665FNYF"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-TZN665FNYF');
  </script>
  <style>
    body {
      margin: 0;
      background: #222;
      color: #fff;
      font-family: 'Segoe UI', Arial, sans-serif; /* Nicer font */
      padding-bottom: 60px;
    }
    .topbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px;
      position: relative;
    }
    .lang-btn {
      font-size: 1.5rem;
      cursor: pointer;
    }
    .lang-popup {
      display: none;
      position: absolute;
      top: 60px;
      left: 16px;
      background: #333;
      padding: 10px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.4);
      flex-direction: column;
      z-index: 10;
      width: 200px;
    }
    .lang-popup.active {
      display: flex;
    }
    .lang-option {
      background: none;
      color: #fff;
      border: none;
      padding: 8px 12px;
      text-align: left;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .lang-option:hover {
      background: #444;
    }
    .avatar-small {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      border: 2px solid #00bfae;
      cursor: pointer;
      object-fit: cover;
      background: #111;
      transition: box-shadow 0.2s;
    }
    .avatar-small:hover {
      box-shadow: 0 0 0 4px #00bfae55;
    }
    /* Updated Profile Popup positioning */
    #profilePopup {
      top: 60px;
      right: 16px; /* Moved to right */
      left: auto; /* Reset left */
      max-width: 360px;
    }
    .popup {
      display: none;
      position: absolute;
      top: 60px;
      right: 0;
      background: #333;
      padding: 24px 20px 20px 20px;
      border-radius: 16px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.5);
      z-index: 10;
      flex-direction: column;
      min-width: 0px;
      align-items: center;
      animation: fadeIn 0.2s;
    }
    .popup.active {
      display: flex;
    }

    .register-btn, .done-btn, .create-team-btn {
      background: #2196f3;
      color: #fff;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: bold;
      cursor: pointer;
      margin: 8px 0;
      transition: background 0.2s;
      width: 100%;
      max-width: 220px;
    }
    .register-btn:hover, .done-btn:hover, .create-team-btn:hover {
      background: #1976d2;
    }

    .profile-form,
    .team-form {
      display: flex;
      flex-direction: column;
      gap: 12px;
      width: 100%;
      max-width: 340px;
      margin-top: 8px;
      align-items: center;
    }
    .profile-form label,
    .team-form label {
      font-size: 0.95rem;
      color: #bbb;
      margin-bottom: 2px;
      align-self: flex-start;
    }
    .profile-form input,
    .team-form input[type="text"],
    .team-form input[type="file"] {
      padding: 8px;
      border-radius: 6px;
      border: 1px solid #555;
      background: #222;
      color: #fff;
      font-size: 1rem;
      outline: none;
      width: 100%;
    }
    .profile-form input[readonly] {
      background: #222;
      color: #aaa;
      border: 1px solid #444;
    }

    .player-profile {
      width: 100%;
      max-width: 220px;
      background: #222;
      border-radius: 10px;
      padding: 12px 14px;
      font-size: 1rem;
      display: none;
      color: #fff;
    }
    .player-profile-title {
      margin-bottom: 8px;
      color: #00bfae;
      font-weight: bold;
      font-size: 1.05rem;
    }
    .player-profile-row {
      margin-bottom: 4px;
      word-break: break-word;
    }

    .success-message, .team-success-message {
      color: #00bfae;
      font-size: 1rem;
      margin: 10px 0 0 0;
      text-align: center;
    }

    .team-avatar-preview {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid #00bfae;
      margin-bottom: 8px;
      background: #111;
      display: none;
    }

    .team-player-block {
      background: #292929;
      border-radius: 8px;
      padding: 10px 12px;
      margin-bottom: 8px;
      width: 100%;
      box-sizing: border-box;
    }
    .team-player-title {
      color: #00bfae;
      font-weight: bold;
      margin-bottom: 4px;
      font-size: 1rem;
    }

    .notification-btn {
      background: none;
      border: none;
      font-size: 2rem;
      cursor: pointer;
      position: relative;
      margin-left: 8px;
      color: #fff;
    }
    .notification-badge {
      position: absolute;
      top: 2px;
      right: 10px;
      background: #e53935;
      color: #fff;
      border-radius: 50%;
      font-size: 0.85rem;
      min-width: 20px;
      min-height: 20px;
      padding: 0 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      border: 2px solid #222;
      box-sizing: border-box;
      z-index: 2;
    }

    #adminPopup {
      display: none;
      position: fixed;
      top: 90px;
      right: 20px;
      background: #1e1e1e;
      border: 2px solid #00bfae;
      border-radius: 16px;
      padding: 20px 24px;
      z-index: 999;
      width: 320px;
      box-shadow: 0 0 20px rgba(0, 191, 174, 0.3);
      font-family: 'Segoe UI', sans-serif;
      animation: fadeIn 0.2s ease-in-out;
    }

    #adminPopup.active {
      display: block;
    }

    #adminPopup h2 {
      color: #00bfae;
      margin-top: 0;
      margin-bottom: 16px;
      font-size: 20px;
      text-align: center;
    }

    #adminPopup button {
      padding: 10px 16px;
      font-size: 15px;
      background-color: #2b2b2b;
      color: #eee;
      border: 1px solid #00bfae;
      border-radius: 10px;
      margin-bottom: 10px;
      width: 100%;
      transition: background 0.2s;
    }

    #adminPopup button:hover {
      background-color: #00bfae;
      color: #111;
    }

    #closeAdminModal {
      position: absolute;
      top: 10px;
      right: 10px;
      background: transparent;
      color: #aaa;
      border: none;
      font-size: 18px;
      cursor: pointer;
    }

    #adminMenuBtn {
      font-size: 28px;
      padding: 12px 16px;
      cursor: pointer;
      transition: all 0.2s ease-in-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: scale(0.95);}
      to { opacity: 1; transform: scale(1);}
    }

    .nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      color: #ccc;
      font-size: 0.85rem;
      cursor: pointer;
    }
    .nav-item span {
      font-size: 1.2rem;
      margin-bottom: 2px;
    }
    .nav-item.active, .nav-item:hover {
      color: #00bfae;
    }

    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background: #111;
      display: flex;
      justify-content: space-around;
      border-top: 1px solid #333;
      padding: 8px 0;
      z-index: 100;
    }
    .news-section,
    .disciplines-section,
    .tournaments-section {
      margin-top: 24px;
      padding: 0 16px;
    }

    .news-title,
    .disciplines-title,
    .tournaments-title {
      margin-left: 4px;
      margin-bottom: 8px;
      font-size: 1.2rem;
      font-weight: bold;
      color: #00bfae;
    }
    .news-list,
    .disciplines-list,
    .tournament-list {
      display: flex;
      overflow-x: auto;
      gap: 16px;
      padding: 12px 4px;
      scroll-snap-type: x mandatory;
    }

    .news-card,
    .tournament-card,
    .discipline-card {
      flex: 0 0 auto;
      width: 280px;
      background: #292929;
      border: 2px solid #00bfae88;
      border-radius: 12px;
      padding: 16px;
      scroll-snap-align: start;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .news-card:hover,
    .tournament-card:hover,
    .discipline-card:hover {
      transform: scale(1.02);
      box-shadow: 0 4px 10px rgba(0, 191, 174, 0.25);
    }

    .news-card h4,
    .tournament-card h4 {
      margin-top: 0;
      color: #00bfae;
      font-size: 1.1rem;
    }

    .news-card p,
    .tournament-card p {
      font-size: 0.95rem;
      color: #ddd;
    }

    .discipline-img {
      width: 100%;
      border-radius: 8px;
      margin-bottom: 8px;
    }

    .discipline-name {
      font-weight: bold;
      text-align: center;
      font-size: 1rem;
      color: #fff;
    }
    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background: #111;
      display: flex;
      justify-content: space-around;
      border-top: 1px solid #333;
      padding: 8px 0;
      z-index: 100;
    }
    .nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      color: #ccc;
      font-size: 0.85rem;
      cursor: pointer;
    }
    .nav-item span {
      font-size: 1.2rem;
      margin-bottom: 2px;
    }
    .nav-item:hover {
      color: #00bfae;
    }
    .section {
      padding: 24px 16px;
      display: none;
    }
    .section.active {
      display: block;
    }
    /* Updated Notification Popup positioning */
    #notificationPopup {
      right: 16px; /* Adjusted to align with other right-aligned elements */
      min-width: 280px;
    }

    /* New styles for consistent pages */
    .section h2 {
      margin-top: 0;
      margin-bottom: 16px;
      font-size: 1.5rem; /* Larger heading */
      font-weight: bold;
      color: #00bfae; /* Consistent highlight color */
      text-align: center;
    }
    .section p {
      font-size: 1rem;
      color: #ddd;
      line-height: 1.5;
      margin-bottom: 16px;
    }
    .section details {
      background: #292929;
      border: 2px solid #00bfae88;
      border-radius: 12px;
      padding: 12px 16px;
      margin-bottom: 12px;
      color: #fff;
      font-size: 1rem;
    }
    .section summary {
      font-weight: bold;
      color: #00bfae;
      cursor: pointer;
      padding: 4px 0;
    }
    .section details p {
      padding-top: 10px;
      margin-bottom: 0;
      color: #ccc;
      font-size: 1rem; /* Bigger font for rules */
      font-family: 'Segoe UI', Arial, sans-serif; /* Nicer font for rules */
    }

    /* Styles for Awards and Tournament Details */
    .award-card {
        background: #292929;
        border: 2px solid #00bfae88;
        border-radius: 12px;
        padding: 12px; /* Smaller padding for a more compact card */
        margin-bottom: 12px;
        display: flex; /* Make it horizontal */
        align-items: center; /* Vertically align items */
        gap: 12px; /* Space between icon and text */
        cursor: pointer; /* Indicate it's clickable */
        transition: transform 0.2s, box-shadow 0.2s;
    }
    .award-card:hover {
        transform: scale(1.02);
        box-shadow: 0 4px 10px rgba(0, 191, 174, 0.25);
    }

    .award-content-wrapper {
        display: flex;
        align-items: center;
        gap: 12px;
        width: 100%; /* Take full width of card */
    }

    .award-card-icon {
        font-size: 2.2rem; /* Size for emoji icon */
        line-height: 1;
        flex-shrink: 0; /* Prevent icon from shrinking */
    }

    .award-card-img {
        width: 48px; /* Size for image icon */
        height: 48px;
        object-fit: cover;
        border-radius: 8px; /* Slightly rounded corners for images */
        flex-shrink: 0;
    }

    .award-text-content {
        flex-grow: 1; /* Allow text content to take available space */
    }

    .award-text-content h4 {
        margin: 0;
        color: #00bfae;
        font-size: 1.1rem;
        white-space: nowrap; /* Prevent title from wrapping */
        overflow: hidden; /* Hide overflow */
        text-overflow: ellipsis; /* Add ellipsis if too long */
    }

    .tournament-name-on-card {
        margin: 4px 0 0;
        font-size: 0.9rem;
        color: #ddd;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .btn-primary {
        background: #00bfae;
        color: #fff;
        border: none;
        padding: 12px 24px;
        border-radius: 8px;
        font-size: 1rem;
        font-weight: bold;
        cursor: pointer;
        margin-top: 20px;
        transition: background 0.2s ease-in-out;
        width: 100%;
        max-width: 300px;
        display: block; /* Make it a block element to center with margin auto */
        margin-left: auto;
        margin-right: auto;
        text-align: center;
    }

    .btn-primary:hover {
        background: #008f82;
    }

    .back-btn {
        background: #333;
        color: #eee;
        border: 1px solid #555;
        padding: 10px 20px;
        border-radius: 8px;
        font-size: 0.9rem;
        cursor: pointer;
        margin-top: 20px;
        margin-bottom: 10px;
        transition: background 0.2s ease-in-out;
    }

    .back-btn:hover {
        background: #444;
    }

    .ranking-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
        color: #fff;
    }

    .ranking-table th,
    .ranking-table td {
        padding: 10px;
        border: 1px solid #333;
        text-align: left;
    }

    .ranking-table th {
        background-color: #00bfae;
        color: #111;
        font-weight: bold;
    }

    .ranking-table tbody tr:nth-child(even) {
        background-color: #292929;
    }

    .ranking-table tbody tr:nth-child(odd) {
        background-color: #222;
    }

    /* Styles for the new Tournament section */
    .tournament-section-content {
        background: #292929;
        border: 2px solid #00bfae88;
        border-radius: 12px;
        padding: 16px;
        margin-top: 20px;
    }

    .tournament-section-content h3 {
        color: #00bfae;
        margin-top: 0;
        margin-bottom: 10px;
    }

    .tournament-section-content .dropdown-container {
        margin-bottom: 15px;
    }

    .tournament-section-content select,
    .tournament-section-content button {
        padding: 8px 12px;
        border-radius: 6px;
        border: 1px solid #555;
        background: #222;
        color: #fff;
        font-size: 1rem;
        cursor: pointer;
        margin-right: 10px;
    }

    .tournament-section-content select {
        width: calc(50% - 15px); /* Adjust width for two dropdowns side-by-side */
        max-width: 200px;
    }

    .tournament-section-content button {
        background: #00bfae;
        border-color: #00bfae;
    }

    .tournament-section-content button:hover {
        background: #008f82;
        border-color: #008f82;
    }

    .tournament-section-content .group-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 10px;
    }

    .tournament-section-content .group-table th,
    .tournament-section-content .group-table td {
        border: 1px solid #333;
        padding: 8px;
        text-align: left;
    }

    .tournament-section-content .group-table th {
        background-color: #00bfae;
        color: #111;
    }

    .tournament-section-content .group-table tbody tr:nth-child(even) {
        background-color: #292929;
    }

    .tournament-section-content .group-table tbody tr:nth-child(odd) {
        background-color: #222;
    }

    .tournament-section-content .playoff-bracket {
        margin-top: 20px;
        text-align: center; /* Center the bracket content */
        color: #ddd;
    }

    .tournament-section-content .playoff-bracket img {
        max-width: 100%;
        height: auto;
        display: block;
        margin: 0 auto;
        border-radius: 8px;
        border: 1px solid #00bfae;
    }

    /* Styles for the Tournament Creation Modal */
    .modal {
      display: none; /* Hidden by default */
      position: fixed; /* Stay in place */
      z-index: 1001; /* Sit on top */
      left: 0;
      top: 0;
      width: 100%; /* Full width */
      height: 100%; /* Full height */
      overflow: auto; /* Enable scroll if needed */
      background-color: rgba(0,0,0,0.6); /* Black w/ opacity */
      padding-top: 60px;
    }

    .modal-content {
      background-color: #333;
      margin: 5% auto; /* 5% from the top and centered */
      padding: 20px;
      border: 1px solid #00bfae;
      border-radius: 12px;
      width: 90%; /* Could be more responsive */
      max-width: 500px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.5);
      animation: fadeIn 0.3s ease-out;
      position: relative;
    }

    .close-button {
      color: #aaa;
      position: absolute;
      top: 10px;
      right: 20px;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
    }

    .close-button:hover,
    .close-button:focus {
      color: #fff;
      text-decoration: none;
      cursor: pointer;
    }

    .modal h2 {
      color: #00bfae;
      text-align: center;
      margin-top: 0;
      margin-bottom: 20px;
      font-size: 1.8rem;
    }

    .form-group {
      margin-bottom: 15px;
    }

    .form-group label {
      display: block;
      margin-bottom: 5px;
      color: #eee;
      font-size: 0.95rem;
    }

    .form-group input[type="text"],
    .form-group input[type="date"],
    .form-group input[type="number"],
    .form-group textarea,
    .form-group select {
      width: calc(100% - 20px);
      padding: 10px;
      border-radius: 6px;
      border: 1px solid #555;
      background: #222;
      color: #fff;
      font-size: 1rem;
      outline: none;
    }

    .form-group textarea {
      resize: vertical;
      min-height: 80px;
    }

    .submit-btn {
      background: #00bfae;
      color: #fff;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      font-size: 1.1rem;
      font-weight: bold;
      cursor: pointer;
      display: block;
      width: 100%;
      max-width: 250px;
      margin: 20px auto 0;
      transition: background 0.2s ease-in-out;
    }

    .submit-btn:hover {
      background: #008f82;
    }
  </style>
</head>
<body>
  <div class="topbar">
    <div class="lang-btn" id="langBtn">🌐</div>
    <div id="langPopup" class="lang-popup popup">
      <button class="lang-option" data-lang="uk">🇺🇦 Українська</button>
      <button class="lang-option" data-lang="en">🇬🇧 English</button>
      <button class="lang-option" data-lang="ru">🇷🇺 Русский</button>
      <button class="lang-option" data-lang="pl">🇵🇱 Polski</button>
    </div>
    <img id="avatar" class="avatar-small" src="avatar.jpg" alt="Avatar">
    <button id="notificationBtn" class="notification-btn" title="Сповіщення">
      🔔
      <span id="notificationBadge" class="notification-badge" style="display:none;">0</span>
    </button>
    <div class="admin-menu" id="adminMenuBtn" title="Адмін-меню">🛡️</div>
    <div id="adminPopup" class="adminPopup popup">
      <h2 id="adminMenuTitle" style="color:#00bfae; margin-top:0;">Адмін-меню</h2>
      <div style="display:flex; flex-direction:column; gap:12px;">
        <button id="createTournamentAdminBtn" data-i18n="create_tournament_btn">➕ Створити турнір</button>
        <button id="banUserBtn" data-i18n="ban_user">🚫 Заблокувати користувача</button>
        <button id="unbanUserBtn" data-i18n="unban_user">✅ Розблокувати користувача</button>
        <button id="givePrizeBtn" data-i18n="give_prize">🏆 Видати приз</button>
        <button id="disqualifyTeamBtn" data-i18n="disqualify_team">❌ Дискваліфікувати команду</button>
        <button id="tournamentMenuBtn" data-i18n="tournament_menu_btn">🏆 Турнір</button>
      </div>
    </div>

    <div id="profilePopup" class="popup">
      <button class="register-btn" id="registerBtn" data-i18n="register">Зареєструватись</button>
    </div>
    <form class="profile-form" id="profileForm" style="display:none;">
      <label for="standoffNick" data-i18n="standoff_nick">Нік в Standoff</label>
      <input type="text" id="standoffNick" name="standoffNick" required maxlength="32" autocomplete="off">
      <label for="standoffId" data-i18n="standoff_id">ID в Standoff</label>
      <input type="text" id="standoffId" name="standoffId" required maxlength="32" autocomplete="off">
      <label for="tgUser" data-i18n="tg_user">Telegram</label>
      <input type="text" id="tgUser" name="tgUser" readonly>
      <button type="submit" class="done-btn" id="doneBtn" data-i18n="done">Готово</button>
    </form>

    <div class="player-profile" id="playerProfile">
      <div class="player-profile-title" data-i18n="profile">Профіль гравця</div>
      <div class="player-profile-row">
        <span data-i18n="standoff_nick">Нік в Standoff</span>: <span id="profileNick"></span>
      </div>
      <div class="player-profile-row">
        <span data-i18n="standoff_id">ID в Standoff</span>: <span id="profileId"></span>
      </div>
      <div class="player-profile-row">
        <span data-i18n="tg_user">Telegram</span>: <span id="profileTg"></span>
      </div>
    </div>

    <button class="create-team-btn" id="createTeamBtn" style="display:none;" data-i18n="create_team">Створити команду</button>
    <div class="success-message" id="successMsg" style="display:none;" data-i18n="profile_saved">Профіль збережено!</div>

    <form class="team-form" id="teamForm" style="display:none;">
      <label for="teamAvatar" data-i18n="team_avatar">Аватарка команди</label>
      <input type="file" id="teamAvatar" accept="image/*">
      <img id="teamAvatarPreview" class="team-avatar-preview" src="#" alt="Team Avatar">

      <label for="teamTag" data-i18n="team_tag">Тег команди</label>
      <input type="text" id="teamTag" maxlength="12" required data-i18n-placeholder="team_tag_ph">

      <label for="teamName" data-i18n="team_name">Назва команди</label>
      <input type="text" id="teamName" maxlength="32" required data-i18n-placeholder="team_name_ph">

      <div class="team-player-block">
        <div class="team-player-title" data-i18n="main_player1">Гравець 1 (капітан)</div>
        <input type="text" id="main1Id" placeholder="ID в Standoff 2" required data-i18n-placeholder="player_id_ph">
        <input type="text" id="main1Nick" placeholder="Нікнейм" required data-i18n-placeholder="player_nick_ph">
        <input type="text" id="main1Tg" placeholder="Telegram" required data-i18n-placeholder="player_tg_ph">
      </div>
      <div class="team-player-block">
        <div class="team-player-title" data-i18n="main_player2">Гравець 2 (основний)</div>
        <input type="text" id="main2Id" placeholder="ID в Standoff 2" required data-i18n-placeholder="player_id_ph">
        <input type="text" id="main2Nick" placeholder="Нікнейм" required data-i18n-placeholder="player_nick_ph">
        <input type="text" id="main2Tg" placeholder="Telegram" required data-i18n-placeholder="player_tg_ph">
      </div>
      <div class="team-player-block">
        <div class="team-player-title" data-i18n="main_player3">Гравець 3 (основний)</div>
        <input type="text" id="main3Id" placeholder="ID в Standoff 2" required data-i18n-placeholder="player_id_ph">
        <input type="text" id="main3Nick" placeholder="Нікнейм" required data-i18n-placeholder="player_nick_ph">
        <input type="text" id="main3Tg" placeholder="Telegram" required data-i18n-placeholder="player_tg_ph">
      </div>
      <div class="team-player-block">
        <div class="team-player-title" data-i18n="main_player4">Гравець 4 (основний)</div>
        <input type="text" id="main4Id" placeholder="ID в Standoff 2" required data-i18n-placeholder="player_id_ph">
        <input type="text" id="main4Nick" placeholder="Нікнейм" required data-i18n-placeholder="player_nick_ph">
        <input type="text" id="main4Tg" placeholder="Telegram" required data-i18n-placeholder="player_tg_ph">
      </div>
      <div class="team-player-block">
        <div class="team-player-title" data-i18n="main_player5">Гравець 5 (основний)</div>
        <input type="text" id="main5Id" placeholder="ID в Standoff 2" required data-i18n-placeholder="player_id_ph">
        <input type="text" id="main5Nick" placeholder="Нікнейм" required data-i18n-placeholder="player_nick_ph">
        <input type="text" id="main5Tg" placeholder="Telegram" required data-i18n-placeholder="player_tg_ph">
      </div>
      <div class="team-player-block">
        <div class="team-player-title" data-i18n="spare_player1">Гравець 6 (запасний)</div>
        <input type="text" id="spare1Id" placeholder="ID в Standoff 2" required data-i18n-placeholder="player_id_ph">
        <input type="text" id="spare1Nick" placeholder="Нікнейм" required data-i18n-placeholder="player_nick_ph">
        <input type="text" id="spare1Tg" placeholder="Telegram" required data-i18n-placeholder="player_tg_ph">
      </div>
      <div class="team-player-block">
        <div class="team-player-title" data-i18n="spare_player2">Гравець 7 (запасний)</div>
        <input type="text" id="spare2Id" placeholder="ID в Standoff 2" required data-i18n-placeholder="player_id_ph">
        <input type="text" id="spare2Nick" placeholder="Нікнейм" required data-i18n-placeholder="player_nick_ph">
        <input type="text" id="spare2Tg" placeholder="Telegram" required data-i18n-placeholder="player_tg_ph">
      </div>

      <button type="submit" class="done-btn" id="teamDoneBtn" data-i18n="team_done">Готово</button>
    </form>

    <div class="team-success-message" id="teamSuccessMsg" style="display:none;" data-i18n="team_created">Команду створено!</div>
  </div>

  <div id="notificationPopup" class="popup">
    <div style="font-weight:bold; color:#00bfae; margin-bottom:8px;" id="notificationTitle">Сповіщення</div>
    <div id="notificationList" style="width:100%;"></div>
    <button id="clearNotificationsBtn" class="done-btn" style="margin-top:10px;">Очистити</button>
  </div>

  <div id="homeSection" class="section active">
    <div class="main-section" id="mainSection">
      <div class="news-section">
        <div class="news-title" data-i18n="news">Новини</div>
        <div class="news-list" id="newsList">
          <div class="news-card">
            <h4 data-i18n="news1title">🔔 Оновлення</h4>
            <p data-i18n="news1desc">Ми додали підтримку англійської мови та оновили інтерфейс.</p>
          </div>
          <div class="news-card">
            <h4 data-i18n="news2title">🏆 Турніри оновлено</h4>
            <p data-i18n="news2desc">Тепер усі турніри доступні на окремій сторінці.</p>
          </div>
        </div>
      </div>

      <div class="disciplines-section">
        <div class="disciplines-title" data-i18n="disciplines">Дисципліни</div>
        <div class="disciplines-list">
          <div class="discipline-card">
            <img src="Standoff2.jpg" alt="Standoff 2" class="discipline-img">
            <div class="discipline-name">Standoff 2</div>
          </div>
        </div>
      </div>

      <div class="tournaments-section">
        <div class="tournaments-title" data-i18n="tournaments">Турніри</div>
        <div class="tournament-list" id="tournamentList">
          <div class="tournament-card">
            <h4>RFORZ Grad Prix</h4>
            <p data-i18n="tournament1desc">Старт: 1 липня. Призовий фонд: 5000₴</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div id="tournamentViewSection" class="section">
    <h2 data-i18n="tournament_view_title">Перегляд Турніру</h2>
    <div class="tournament-section-content">
      <div id="userTournamentView">
        <div class="dropdown-container">
          <select id="groupStageDropdown">
            <option value="">Виберіть групу</option>
            <option value="groupA">Група A</option>
            <option value="groupB">Група B</option>
          </select>
          <div id="groupATable" style="display:none;">
            <h3>Група A</h3>
            <table class="group-table">
              <thead>
                <tr>
                  <th>Команда</th>
                  <th>Перемоги</th>
                  <th>Поразки</th>
                </tr>
              </thead>
              <tbody>
                <tr><td>Команда Alpha</td><td>3</td><td>0</td></tr>
                <tr><td>Команда Beta</td><td>2</td><td>1</td></tr>
                <tr><td>Команда Gamma</td><td>1</td><td>2</td></tr>
                <tr><td>Команда Delta</td><td>0</td><td>3</td></tr>
              </tbody>
            </table>
          </div>
          <div id="groupBTable" style="display:none;">
            <h3>Група B</h3>
            <table class="group-table">
              <thead>
                <tr>
                  <th>Команда</th>
                  <th>Перемоги</th>
                  <th>Поразки</th>
                </tr>
              </thead>
              <tbody>
                <tr><td>Команда Echo</td><td>3</td><td>0</td></tr>
                <tr><td>Команда Foxtrot</td><td>2</td><td>1</td></tr>
                <tr><td>Команда Golf</td><td>1</td><td>2</td></tr>
                <tr><td>Команда Hotel</td><td>0</td><td>3</td></tr>
              </tbody>
            </table>
          </div>
        </div>
        <div class="dropdown-container">
          <select id="playoffDropdown">
            <option value="">Виберіть етап плей-офф</option>
            <option value="playoffBracket">Сітка плей-офф</option>
          </select>
          <div id="playoffBracketView" class="playoff-bracket" style="display:none;">
            <h3>Сітка плей-офф</h3>
            <p>Тут буде відображено сітку плей-офф.</p>
          </div>
        </div>
      </div>
      <div id="adminTournamentEdit" style="display:none;">
        <h3>Редагувати Турнір</h3>
        <div class="admin-edit-options">
          <button id="editGroupStageBtn">Редагувати Груповий Етап</button>
          <button id="viewPlayoffBracketAdminBtn">Переглянути Сітку Плей-офф</button>
        </div>
        <div id="groupStageEdit" style="display:none;">
          <h4>Редагування Групового Етапу</h4>
          <input type="text" id="teamNameInput" placeholder="Назва команди">
          <select id="groupSelect">
            <option value="groupA">Група A</option>
            <option value="groupB">Група B</option>
          </select>
          <button id="addTeamBtn">Додати Команду</button>
          <button id="removeTeamBtn">Видалити Команду</button>
          <div id="currentGroupATable">
            <h5>Група A (поточна)</h5>
            <table class="group-table" id="adminGroupATable">
              <thead>
                <tr><th>Команда</th><th>Дії</th></tr>
              </thead>
              <tbody>
                <tr><td>Команда Alpha</td><td><button data-team="Команда Alpha" class="remove-btn">Видалити</button></td></tr>
                <tr><td>Команда Beta</td><td><button data-team="Команда Beta" class="remove-btn">Видалити</button></td></tr>
              </tbody>
            </table>
          </div>
          <div id="currentGroupBTable">
            <h5>Група B (поточна)</h5>
            <table class="group-table" id="adminGroupBTable">
              <thead>
                <tr><th>Команда</th><th>Дії</th></tr>
              </thead>
              <tbody>
                <tr><td>Команда Echo</td><td><button data-team="Команда Echo" class="remove-btn">Видалити</button></td></tr>
              </tbody>
            </table>
          </div>
        </div>
        <div id="adminPlayoffBracketView" class="playoff-bracket" style="display:none;">
          <h4>Сітка Плей-офф (Адмін)</h4>
          <p>Тут буде адмін-інтерфейс для керування сіткою плей-офф.</p>
          <p>Будь ласка, надайте зображення сітки плей-офф, і я зможу розмістити його тут, зберігши поточний фон.</p>
        </div>
      </div>
    </div>
  </div>

  <div id="rulesSection" class="section">
    <h2 data-i18n="rules_main_title">Правила турніру</h2>
    <details>
      <summary data-i18n="rules_1v1_summary">Турніри 1х1</summary>
      <p data-i18n="rules_1v1_text">• Гравці грають один проти одного.<br> • Раунди проходять до 3 перемог.<br> • Перемагає той, хто перший виграє 3 раунди. </p>
    </details>
    <details>
      <summary data-i18n="rules_2v2_summary">Турніри 2х2</summary>
      <p data-i18n="rules_2v2_text">• Команди по 2 гравці.<br> • Успіх залежить від координації та злагодженої гри.<br> • Перші до 5 перемог — проходять далі. </p>
    </details>
    <details>
      <summary data-i18n="rules_5v5_standoff_summary">Правила Турніру по Standoff 2 (5 на 5)</summary>
      <div>
        <p data-i18n="rules_5v5_standoff_1_title">1. Общие положения:</p>
        <p data-i18n="rules_5v5_standoff_1_1">• Турнір проводиться по дисципліні Standoff 2.</p>
        <p data-i18n="rules_5v5_standoff_1_2">• Формат матчей: 5 на 5.</p>
        <p data-i18n="rules_5v5_standoff_1_3">• Все участники обязаны соблюдать правила честной игры и проявлять уважение к другим игрокам и судьям турнира.</p>
        <p data-i18n="rules_5v5_standoff_2_title">2. Участие и регистрация:</p>
        <p data-i18n="rules_5v5_standoff_2_1">• Команда состоит из 5 основных игроков и до 2 запасных.</p>
        <p data-i18n="rules_5v5_standoff_2_2">• Рагионы: Польша, Нидерланды, Франция.</p>
        <p data-i18n="rules_5v5_standoff_2_3">• Максимально допустимый пинг — 100 мс. Игроки с превышением этого значения могут быть отстранены от участия.</p>
        <p data-i18n="rules_5v5_standoff_2_4">• Регистрация проходит через указанную организаторами платформу или форму.</p>
        <p data-i18n="rules_5v5_standoff_3_title">3. Технические требования:</p>
        <p data-i18n="rules_5v5_standoff_3_1">• Игра проводится только на мобильных устройствах. Использование эмуляторов запрещено.</p>
        <p data-i18n="rules_5v5_standoff_3_2">• Проверка пинга производится перед каждым матчем.</p>
        <p data-i18n="rules_5v5_standoff_3_3">• Использование VPN, прокси и любых средств для изменения региона/пинга строго запрещено.</p>
        <p data-i18n="rules_5v5_standoff_4_title">4. Формат турнира:</p>
        <p data-i18n="rules_5v5_standoff_4_1">• Матчи группового этапа проходять у форматі Best of 2 (BO2). Полуфинал — Best of 3 (BO3).</p>
        <p data-i18n="rules_5v5_standoff_4_2">• Финал – Best of 5 (BO5).</p>
        <p data-i18n="rules_5v5_standoff_4_3">• Победа присуждается команде, первой выигравшей 13 раундов.</p>
        <p data-i18n="rules_5v5_standoff_4_4">• Карты выбираются методом “ban/pick” (отказ/выбор).</p>
        <p data-i18n="rules_5v5_standoff_4_5">• Перерывы между половинами — 1 минута. Переключение сторон происходит после 12 раундов.</p>
        <p data-i18n="rules_5v5_standoff_5_title">5. Поведение игроков:</p>
        <p data-i18n="rules_5v5_standoff_5_1">• Запрещено использование стороннего ПО, читов и багов.</p>
        <p data-i18n="rules_5v5_standoff_5_2">• Оскорбления, токсичное поведение и провокации запрещены.</p>
        <p data-i18n="rules_5v5_standoff_5_3">• Все спорные ситуации решаются судьёй матча. Решения администрации окончательны.</p>
        <p data-i18n="rules_5v5_standoff_6_title">6. Прерывание матча:</p>
        <p data-i18n="rules_5v5_standoff_6_1">• При вылете игрока матч продолжается, если ситуация не критична.</p>
        <p data-i18n="rules_5v5_standoff_6_2">• В случае технических проблем команда обязана уведомить администратора в течение 2 минут.</p>
        <p data-i18n="rules_5v5_standoff_6_3">• Допускается 1 техническая пауза на матч продолжительностью до 5 минут (по согласованию с судьёй).</p>
        <p data-i18n="rules_5v5_standoff_7_title">7. Санкции:</p>
        <p data-i18n="rules_5v5_standoff_7_1">• 1-е нарушение правил — предупреждение.</p>
        <p data-i18n="rules_5v5_standoff_7_2">• 2-е — дисквалификация игрока или всей команды в зависимости от тяжести нарушения.</p>
        <p data-i18n="rules_5v5_standoff_7_3">• Повторяющиеся нарушения — немедленное снятие с турнира.</p>
        <p data-i18n="rules_5v5_standoff_8_title">8. Призы и награды:</p>
        <p data-i18n="rules_5v5_standoff_8_1">• Призовой фонд та розподіл місць оголошуються перед початком турніру.</p>
        <p data-i18n="rules_5v5_standoff_8_2">• Призи розподіляються всередині команди самостійно або порівну (за замовчуванням).</p>
      </div>
    </details>
  </div>
  <div id="awardsSection" class="section">
    <h2 data-i18n="awards_title">Нагороди</h2>
    <p data-i18n="awards_text">Усі учасники фіналу отримують спеціальні бонуси. Переможці — призи та сертифікати.</p>
    <div id="myAwardsList">
    </div>
  </div>
  <div id="tournamentDetailsSection" class="section">
    <button id="backToAwardsBtn" class="back-btn" data-i18n="back_to_awards">← До моїх нагород</button>
    <h2 id="tournamentDetailsTitle" data-i18n="tournament_details_title_dynamic">Деталі Турніру та Рейтинг</h2>
    <div id="rankingTableContainer">
    </div>
  </div>
  <div id="supportSection" class="section">
    <h2 data-i18n="support_title">Підтримка</h2>
    <p data-i18n="support_text">Напишіть нам, якщо у вас виникли питання чи проблеми. Наша команда підтримки готова допомогти!</p>
    <button class="btn-primary" data-i18n="contact_support_btn">Зв'язатись з підтримкою</button>
  </div>

  <div id="createTournamentModal" class="modal">
    <div class="modal-content">
      <span class="close-button">&times;</span>
      <h2>Створити Турнір</h2>
      <form id="createTournamentForm">
        <div class="form-group">
          <label for="tournamentName">Назва турніру:</label>
          <input type="text" id="tournamentName" name="tournamentName" required>
        </div>
        <div class="form-group">
          <label for="tournamentDiscipline">Дисципліна:</label>
          <select id="tournamentDiscipline" name="tournamentDiscipline" required>
            <option value="">Виберіть дисципліну</option>
            <option value="Standoff 2">Standoff 2</option>
            </select>
        </div>
        <div class="form-group">
          <label for="tournamentDate">Дата проведення:</label>
          <input type="date" id="tournamentDate" name="tournamentDate" required>
        </div>
        <div class="form-group">
          <label for="tournamentPrize">Призовий фонд:</label>
          <input type="text" id="tournamentPrize" name="tournamentPrize" placeholder="Наприклад: 5000₴ або Скіни">
        </div>
        <div class="form-group">
          <label for="tournamentDescription">Опис:</label>
          <textarea id="tournamentDescription" name="tournamentDescription" rows="4"></textarea>
        </div>
        <button type="submit" class="submit-btn">Створити</button>
      </form>
    </div>
  </div>


  <div class="bottom-nav">
    <div class="nav-item active" data-section="homeSection">
      <span>🏠</span>
      <span data-i18n="home">Головна</span>
    </div>
    <div class="nav-item" data-section="tournamentViewSection">
      <span>🏆</span>
      <span data-i18n="tournaments">Турніри</span>
    </div>
    <div class="nav-item" data-section="rulesSection">
      <span>📜</span>
      <span data-i18n="rules">Правила</span>
    </div>
    <div class="nav-item" data-section="awardsSection">
      <span>🏅</span>
      <span data-i18n="awards">Нагороди</span>
    </div>
    <div class="nav-item" data-section="supportSection">
      <span>❓</span>
      <span data-i18n="support">Підтримка</span>
    </div>
  </div>

  <script>
    const i18n = {
      'uk': {
        'home': 'Головна',
        'tournaments': 'Турніри',
        'rules': 'Правила',
        'awards': 'Нагороди',
        'support': 'Підтримка',
        'profile': 'Профіль гравця',
        'standoff_nick': 'Нік в Standoff',
        'standoff_id': 'ID в Standoff',
        'tg_user': 'Telegram',
        'register': 'Зареєструватись',
        'done': 'Готово',
        'profile_saved': 'Профіль збережено!',
        'create_team': 'Створити команду',
        'team_avatar': 'Аватарка команди',
        'team_tag': 'Тег команди',
        'team_tag_ph': 'Наприклад: КЛАНИ',
        'team_name': 'Назва команди',
        'team_name_ph': 'Наприклад: КЛАН А1',
        'main_player1': 'Гравець 1 (капітан)',
        'main_player2': 'Гравець 2 (основний)',
        'main_player3': 'Гравець 3 (основний)',
        'main_player4': 'Гравець 4 (основний)',
        'main_player5': 'Гравець 5 (основний)',
        'spare_player1': 'Гравець 6 (запасний)',
        'spare_player2': 'Гравець 7 (запасний)',
        'player_id_ph': 'ID в Standoff 2',
        'player_nick_ph': 'Нікнейм',
        'player_tg_ph': 'Telegram',
        'team_done': 'Готово',
        'team_created': 'Команду створено!',
        'ban_user': '🚫 Заблокувати користувача',
        'unban_user': '✅ Розблокувати користувача',
        'give_prize': '🏆 Видати приз',
        'disqualify_team': '❌ Дискваліфікувати команду',
        'tournament_menu_btn': '🏆 Турнір',
        'admin_menu': 'Адмін-меню',
        'news': 'Новини',
        'news1title': '🔔 Оновлення',
        'news1desc': 'Ми додали підтримку англійської мови та оновили інтерфейс.',
        'news2title': '🏆 Турніри оновлено',
        'news2desc': 'Тепер усі турніри доступні на окремій сторінці.',
        'disciplines': 'Дисципліни',
        'rules_main_title': 'Правила турніру',
        'rules_1v1_summary': 'Турніри 1х1',
        'rules_1v1_text': '• Гравці грають один проти одного.<br> • Раунди проходять до 3 перемог.<br> • Перемагає той, хто перший виграє 3 раунди. ',
        'rules_2v2_summary': 'Турніри 2х2',
        'rules_2v2_text': '• Команди по 2 гравці.<br> • Успіх залежить від координації та злагодженої гри.<br> • Перші до 5 перемог — проходять далі. ',
        'rules_5v5_standoff_summary': 'Правила Турніру по Standoff 2 (5 на 5)',
        'rules_5v5_standoff_1_title': '1. Общие положения:',
        'rules_5v5_standoff_1_1': '• Турнір проводиться по дисципліні Standoff 2.',
        'rules_5v5_standoff_1_2': '• Формат матчей: 5 на 5.',
        'rules_5v5_standoff_1_3': '• Все участники обязаны соблюдать правила честной игры и проявлять уважение к другим игрокам и судьям турнира.',
        'rules_5v5_standoff_2_title': '2. Участие и регистрация:',
        'rules_5v5_standoff_2_1': '• Команда состоит из 5 основных игроков и до 2 запасных.',
        'rules_5v5_standoff_2_2': '• Рагионы: Польша, Нидерланды, Франция.',
        'rules_5v5_standoff_2_3': '• Максимально допустимый пинг — 100 мс. Игроки с превышением этого значения могут быть отстранены от участия.',
        'rules_5v5_standoff_2_4': '• Регистрация проходит через указанную организаторами платформу или форму.',
        'rules_5v5_standoff_3_title': '3. Технические требования:',
        'rules_5v5_standoff_3_1': '• Игра проводится только на мобильных устройствах. Использование эмуляторов запрещено.',
        'rules_5v5_standoff_3_2': '• Проверка пинга производится перед каждым матчем.',
        'rules_5v5_standoff_3_3': '• Использование VPN, прокси и любых средств для изменения региона/пинга строго запрещено.',
        'rules_5v5_standoff_4_title': '4. Формат турнира:',
        'rules_5v5_standoff_4_1': '• Матчи группового этапа проходять у форматі Best of 2 (BO2). Полуфинал — Best of 3 (BO3).',
        'rules_5v5_standoff_4_2': '• Финал – Best of 5 (BO5).',
        'rules_5v5_standoff_4_3': '• Победа присуждается команде, первой выигравшей 13 раундов.',
        'rules_5v5_standoff_4_4': '• Карты выбираются методом “ban/pick” (отказ/выбор).',
        'rules_5v5_standoff_4_5': '• Перерывы между половинами — 1 минута. Переключение сторон происходит после 12 раундов.',
        'rules_5v5_standoff_5_title': '5. Поведение игроков:',
        'rules_5v5_standoff_5_1': '• Запрещено использование стороннего ПО, читов и багов.',
        'rules_5v5_standoff_5_2': '• Оскорбления, токсичное поведение и провокации запрещены.',
        'rules_5v5_standoff_5_3': '• Все спорные ситуации решаются судьёй матча. Решения администрации окончательны.',
        'rules_5v5_standoff_6_title': '6. Прерывание матча:',
        'rules_5v5_standoff_6_1': '• При вылете игрока матч продолжается, если ситуация не критична.',
        'rules_5v5_standoff_6_2': '• В случае технических проблем команда обязана уведомить администратора в течение 2 минут.',
        'rules_5v5_standoff_6_3': '• Допускается 1 техническая пауза на матч продолжительностью до 5 минут (по согласованию с судьёй).',
        'rules_5v5_standoff_7_title': '7. Санкции:',
        'rules_5v5_standoff_7_1': '• 1-е нарушение правил — предупреждение.',
        'rules_5v5_standoff_7_2': '• 2-е — дисквалификация игрока или всей команды в зависимости от тяжести нарушения.',
        'rules_5v5_standoff_7_3': '• Повторяющиеся нарушения — немедленное снятие с турнира.',
        'rules_5v5_standoff_8_title': '8. Призы и награды:',
        'rules_5v5_standoff_8_1': '• Призовой фонд та розподіл місць оголошуються перед початком турніру.',
        'rules_5v5_standoff_8_2': '• Призи розподіляються всередині команди самостійно або порівну (за замовчуванням).',
        'awards_title': 'Нагороди',
        'awards_text': 'Усі учасники фіналу отримують спеціальні бонуси. Переможці — призи та сертифікати.',
        'back_to_awards': '← До моїх нагород',
        'tournament_details_title_dynamic': 'Деталі Турніру та Рейтинг',
        'support_title': 'Підтримка',
        'support_text': 'Напишіть нам, якщо у вас виникли питання чи проблеми. Наша команда підтримки готова допомогти!',
        'contact_support_btn': "Зв'язатись з підтримкою",
        'tournament_view_title': 'Перегляд Турніру',
        'create_tournament_btn': '➕ Створити турнір'
      },
      'en': {
        'home': 'Home',
        'tournaments': 'Tournaments',
        'rules': 'Rules',
        'awards': 'Awards',
        'support': 'Support',
        'profile': 'Player Profile',
        'standoff_nick': 'Standoff Nick',
        'standoff_id': 'Standoff ID',
        'tg_user': 'Telegram',
        'register': 'Register',
        'done': 'Done',
        'profile_saved': 'Profile Saved!',
        'create_team': 'Create Team',
        'team_avatar': 'Team Avatar',
        'team_tag': 'Team Tag',
        'team_tag_ph': 'e.g., CLANS',
        'team_name': 'Team Name',
        'team_name_ph': 'e.g., CLAN A1',
        'main_player1': 'Player 1 (Captain)',
        'main_player2': 'Player 2 (Main)',
        'main_player3': 'Player 3 (Main)',
        'main_player4': 'Player 4 (Main)',
        'main_player5': 'Player 5 (Main)',
        'spare_player1': 'Player 6 (Substitute)',
        'spare_player2': 'Player 7 (Substitute)',
        'player_id_ph': 'Standoff 2 ID',
        'player_nick_ph': 'Nickname',
        'player_tg_ph': 'Telegram',
        'team_done': 'Done',
        'team_created': 'Team Created!',
        'ban_user': '🚫 Ban User',
        'unban_user': '✅ Unban User',
        'give_prize': '🏆 Give Prize',
        'disqualify_team': '❌ Disqualify Team',
        'tournament_menu_btn': '🏆 Tournament',
        'admin_menu': 'Admin Menu',
        'news': 'News',
        'news1title': '🔔 Update',
        'news1desc': 'We have added English language support and updated the interface.',
        'news2title': '🏆 Tournaments Updated',
        'news2desc': 'All tournaments are now available on a separate page.',
        'disciplines': 'Disciplines',
        'rules_main_title': 'Tournament Rules',
        'rules_1v1_summary': '1v1 Tournaments',
        'rules_1v1_text': '• Players play against each other.<br> • Rounds are played until 3 wins.<br> • The first to win 3 rounds wins. ',
        'rules_2v2_summary': '2v2 Tournaments',
        'rules_2v2_text': '• Teams of 2 players.<br> • Success depends on coordination and well-coordinated play.<br> • First to 5 wins — advance. ',
        'rules_5v5_standoff_summary': 'Standoff 2 Tournament Rules (5v5)',
        'rules_5v5_standoff_1_title': '1. General provisions:',
        'rules_5v5_standoff_1_1': '• The tournament is held in the discipline Standoff 2.',
        'rules_5v5_standoff_1_2': '• Match format: 5 vs 5.',
        'rules_5v5_standoff_1_3': '• All participants must observe the rules of fair play and show respect for other players and tournament judges.',
        'rules_5v5_standoff_2_title': '2. Participation and registration:',
        'rules_5v5_standoff_2_1': '• A team consists of 5 main players and up to 2 substitutes.',
        'rules_5v5_standoff_2_2': '• Regions: Poland, Netherlands, France.',
        'rules_5v5_standoff_2_3': '• Maximum allowed ping - 100 ms. Players exceeding this value may be suspended from participation.',
        'rules_5v5_standoff_2_4': '• Registration takes place via the platform or form specified by the organizers.',
        'rules_5v5_standoff_3_title': '3. Technical requirements:',
        'rules_5v5_standoff_3_1': '• The game is played only on mobile devices. Emulators are prohibited.',
        'rules_5v5_standoff_3_2': '• Ping check is performed before each match.',
        'rules_5v5_standoff_3_3': '• The use of VPN, proxies and any means to change the region / ping is strictly prohibited.',
        'rules_5v5_standoff_4_title': '4. Tournament format:',
        'rules_5v5_standoff_4_1': '• Group stage matches are held in Best of 2 (BO2) format. Semifinals - Best of 3 (BO3).',
        'rules_5v5_standoff_4_2': '• Final - Best of 5 (BO5).',
        'rules_5v5_standoff_4_3': '• Victory is awarded to the team that first wins 13 rounds.',
        'rules_5v5_standoff_4_4': '• Maps are selected by “ban/pick” method.',
        'rules_5v5_standoff_4_5': '• Breaks between halves - 1 minute. Sides are switched after 12 rounds.',
        'rules_5v5_standoff_5_title': '5. Player behavior:',
        'rules_5v5_standoff_5_1': '• The use of third-party software, cheats and bugs is prohibited.',
        'rules_5v5_standoff_5_2': '• Insults, toxic behavior and provocations are prohibited.',
        'rules_5v5_standoff_5_3': '• All disputes are resolved by the match judge. Administrative decisions are final.',
        'rules_5v5_standoff_6_title': '6. Match interruption:',
        'rules_5v5_standoff_6_1': '• If a player crashes, the match continues if the situation is not critical.',
        'rules_5v5_standoff_6_2': '• In case of technical problems, the team must notify the administrator within 2 minutes.',
        'rules_5v5_standoff_6_3': '• 1 technical pause per match lasting up to 5 minutes is allowed (by agreement with the judge).',
        'rules_5v5_standoff_7_title': '7. Sanctions:',
        'rules_5v5_standoff_7_1': '• 1st violation of the rules - warning.',
        'rules_5v5_standoff_7_2': '• 2nd - disqualification of the player or the entire team depending on the severity of the violation.',
        'rules_5v5_standoff_7_3': '• Repeated violations - immediate removal from the tournament.',
        'rules_5v5_standoff_8_title': '8. Prizes and awards:',
        'rules_5v5_standoff_8_1': '• The prize pool and distribution of places are announced before the start of the tournament.',
        'rules_5v5_standoff_8_2': '• Prizes are distributed within the team independently or equally (by default).',
        'awards_title': 'Awards',
        'awards_text': 'All finalists receive special bonuses. Winners receive prizes and certificates.',
        'back_to_awards': '← Back to my awards',
        'tournament_details_title_dynamic': 'Tournament Details and Ranking',
        'support_title': 'Support',
        'support_text': 'Write to us if you have any questions or problems. Our support team is ready to help!',
        'contact_support_btn': "Contact Support",
        'tournament_view_title': 'Tournament View',
        'create_tournament_btn': '➕ Create Tournament'
      },
      'ru': {
        'home': 'Главная',
        'tournaments': 'Турниры',
        'rules': 'Правила',
        'awards': 'Награды',
        'support': 'Поддержка',
        'profile': 'Профиль игрока',
        'standoff_nick': 'Ник в Standoff',
        'standoff_id': 'ID в Standoff',
        'tg_user': 'Telegram',
        'register': 'Зарегистрироваться',
        'done': 'Готово',
        'profile_saved': 'Профиль сохранен!',
        'create_team': 'Создать команду',
        'team_avatar': 'Аватарка команды',
        'team_tag': 'Тег команды',
        'team_tag_ph': 'Например: КЛАНЫ',
        'team_name': 'Название команды',
        'team_name_ph': 'Например: КЛАН А1',
        'main_player1': 'Игрок 1 (капитан)',
        'main_player2': 'Игрок 2 (основной)',
        'main_player3': 'Игрок 3 (основной)',
        'main_player4': 'Игрок 4 (основной)',
        'main_player5': 'Игрок 5 (основной)',
        'spare_player1': 'Игрок 6 (запасной)',
        'spare_player2': 'Игрок 7 (запасной)',
        'player_id_ph': 'ID в Standoff 2',
        'player_nick_ph': 'Никнейм',
        'player_tg_ph': 'Telegram',
        'team_done': 'Готово',
        'team_created': 'Команда создана!',
        'ban_user': '🚫 Заблокировать пользователя',
        'unban_user': '✅ Разблокировать пользователя',
        'give_prize': '🏆 Выдать приз',
        'disqualify_team': '❌ Дисквалифицировать команду',
        'tournament_menu_btn': '🏆 Турнир',
        'admin_menu': 'Админ-меню',
        'news': 'Новости',
        'news1title': '🔔 Обновление',
        'news1desc': 'Мы добавили поддержку английского языка и обновили интерфейс.',
        'news2title': '🏆 Турниры обновлены',
        'news2desc': 'Теперь все турниры доступны на отдельной странице.',
        'disciplines': 'Дисциплины',
        'rules_main_title': 'Правила турнира',
        'rules_1v1_summary': 'Турниры 1х1',
        'rules_1v1_text': '• Игроки играют один против друга.<br> • Раунды проходят до 3 побед.<br> • Побеждает тот, кто первый выиграет 3 раунда. ',
        'rules_2v2_summary': 'Турниры 2х2',
        'rules_2v2_text': '• Команды по 2 игрока.<br> • Успех зависит от координации и слаженной игры.<br> • Первые до 5 побед — проходят дальше. ',
        'rules_5v5_standoff_summary': 'Правила Турнира по Standoff 2 (5 на 5)',
        'rules_5v5_standoff_1_title': '1. Общие положения:',
        'rules_5v5_standoff_1_1': '• Турнир проводится по дисциплине Standoff 2.',
        'rules_5v5_standoff_1_2': '• Формат матчей: 5 на 5.',
        'rules_5v5_standoff_1_3': '• Все участники обязаны соблюдать правила честной игры и проявлять уважение к другим игрокам и судьям турнира.',
        'rules_5v5_standoff_2_title': '2. Участие и регистрация:',
        'rules_5v5_standoff_2_1': '• Команда состоит из 5 основных игроков и до 2 запасных.',
        'rules_5v5_standoff_2_2': '• Регионы: Польша, Нидерланды, Франция.',
        'rules_5v5_standoff_2_3': '• Максимально допустимый пинг — 100 мс. Игроки с превышением этого значения могут быть отстранены от участия.',
        'rules_5v5_standoff_2_4': '• Регистрация проходит через указанную организаторами платформу или форму.',
        'rules_5v5_standoff_3_title': '3. Технические требования:',
        'rules_5v5_standoff_3_1': '• Игра проводится только на мобильных устройствах. Использование эмуляторов запрещено.',
        'rules_5v5_standoff_3_2': '• Проверка пинга производится перед каждым матчем.',
        'rules_5v5_standoff_3_3': '• Использование VPN, прокси и любых средств для изменения региона/пинга строго запрещено.',
        'rules_5v5_standoff_4_title': '4. Формат турнира:',
        'rules_5v5_standoff_4_1': '• Матчи группового этапа проходять у форматі Best of 2 (BO2). Полуфинал — Best of 3 (BO3).',
        'rules_5v5_standoff_4_2': '• Финал – Best of 5 (BO5).',
        'rules_5v5_standoff_4_3': '• Победа присуждается команде, первой выигравшей 13 раундов.',
        'rules_5v5_standoff_4_4': '• Карты выбираются методом “ban/pick” (отказ/выбор).',
        'rules_5v5_standoff_4_5': '• Перерывы между половинами — 1 минута. Переключение сторон происходит после 12 раундов.',
        'rules_5v5_standoff_5_title': '5. Поведение игроков:',
        'rules_5v5_standoff_5_1': '• Запрещено использование стороннего ПО, читов и багов.',
        'rules_5v5_standoff_5_2': '• Оскорбления, токсичное поведение и провокации запрещены.',
        'rules_5v5_standoff_5_3': '• Все спорные ситуации решаются судьёй матча. Решения администрации окончательны.',
        'rules_5v5_standoff_6_title': '6. Прерывание матча:',
        'rules_5v5_standoff_6_1': '• При вылете игрока матч продолжается, если ситуация не критична.',
        'rules_5v5_standoff_6_2': '• В случае технических проблем команда обязана уведомить администратора в течение 2 минут.',
        'rules_5v5_standoff_6_3': '• Допускается 1 техническая пауза на матч продолжительностью до 5 минут (по согласованию с судьёй).',
        'rules_5v5_standoff_7_title': '7. Санкции:',
        'rules_5v5_standoff_7_1': '• 1-е нарушение правил — предупреждение.',
        'rules_5v5_standoff_7_2': '• 2-е — дисквалификация игрока или всей команды в зависимости от тяжести нарушения.',
        'rules_5v5_standoff_7_3': '• Повторяющиеся нарушения — немедленное снятие с турнира.',
        'rules_5v5_standoff_8_title': '8. Призы и награды:',
        'rules_5v5_standoff_8_1': '• Призовой фонд та распределение мест объявляются перед началом турнира.',
        'rules_5v5_standoff_8_2': '• Призы распределяются внутри команды самостоятельно или поровну (по умолчанию).',
        'awards_title': 'Награды',
        'awards_text': 'Все финалисты получают специальные бонусы. Победители — призы и сертификаты.',
        'back_to_awards': '← К моим наградам',
        'tournament_details_title_dynamic': 'Детали Турнира и Рейтинг',
        'support_title': 'Поддержка',
        'support_text': 'Напишите нам, если у вас возникли вопросы или проблемы. Наша команда поддержки готова помочь!',
        'contact_support_btn': "Связаться с поддержкой",
        'tournament_view_title': 'Просмотр Турнира',
        'create_tournament_btn': '➕ Создать турнир'
      },
      'pl': {
        'home': 'Strona główna',
        'tournaments': 'Turnieje',
        'rules': 'Zasady',
        'awards': 'Nagrody',
        'support': 'Wsparcie',
        'profile': 'Profil gracza',
        'standoff_nick': 'Nick w Standoff',
        'standoff_id': 'ID w Standoff',
        'tg_user': 'Telegram',
        'register': 'Zarejestruj się',
        'done': 'Gotowe',
        'profile_saved': 'Profil zapisany!',
        'create_team': 'Stwórz drużynę',
        'team_avatar': 'Awatar drużyny',
        'team_tag': 'Tag drużyny',
        'team_tag_ph': 'Np. KLANY',
        'team_name': 'Nazwa drużyny',
        'team_name_ph': 'Np. KLAN A1',
        'main_player1': 'Gracz 1 (kapitan)',
        'main_player2': 'Gracz 2 (główny)',
        'main_player3': 'Gracz 3 (główny)',
        'main_player4': 'Gracz 4 (główny)',
        'main_player5': 'Gracz 5 (główny)',
        'spare_player1': 'Gracz 6 (rezerwowy)',
        'spare_player2': 'Gracz 7 (rezerwowy)',
        'player_id_ph': 'ID w Standoff 2',
        'player_nick_ph': 'Nazwa gracza',
        'player_tg_ph': 'Telegram',
        'team_done': 'Gotowe',
        'team_created': 'Drużyna stworzona!',
        'ban_user': '🚫 Zablokuj użytkownika',
        'unban_user': '✅ Odblokuj użytkownika',
        'give_prize': '🏆 Przyznaj nagrodę',
        'disqualify_team': '❌ Zdyskwalifikuj drużynę',
        'tournament_menu_btn': '🏆 Turniej',
        'admin_menu': 'Menu administratora',
        'news': 'Aktualności',
        'news1title': '🔔 Aktualizacja',
        'news1desc': 'Dodaliśmy obsługę języka angielskiego i zaktualizowaliśmy interfejs.',
        'news2title': '🏆 Turnieje zaktualizowane',
        'news2desc': 'Wszystkie turnieje są teraz dostępne na osobnej stronie.',
        'disciplines': 'Dyscypliny',
        'rules_main_title': 'Zasady turnieju',
        'rules_1v1_summary': 'Turnieje 1x1',
        'rules_1v1_text': '• Gracze grają jeden przeciwko drugiemu.<br> • Rundy rozgrywane są do 3 zwycięstw.<br> • Wygrywa ten, kto pierwszy wygra 3 rundy. ',
        'rules_2v2_summary': 'Turnieje 2x2',
        'rules_2v2_text': '• Drużyny po 2 graczy.<br> • Sukces zależy od koordynacji i zgranej gry.<br> • Pierwsi do 5 zwycięstw — przechodzą dalej. ',
        'rules_5v5_standoff_summary': 'Zasady Turnieju Standoff 2 (5 na 5)',
        'rules_5v5_standoff_1_title': '1. Postanowienia ogólne:',
        'rules_5v5_standoff_1_1': '• Turniej odbywa się w dyscyplinie Standoff 2.',
        'rules_5v5_standoff_1_2': '• Format meczów: 5 na 5.',
        'rules_5v5_standoff_1_3': '• Wszyscy uczestnicy zobowiązani są do przestrzegania zasad fair play i okazywania szacunku innym graczom i sędziom turnieju.',
        'rules_5v5_standoff_2_title': '2. Uczestnictwo i rejestracja:',
        'rules_5v5_standoff_2_1': '• Drużyna składa się z 5 graczy podstawowych i do 2 rezerwowych.',
        'rules_5v5_standoff_2_2': '• Regiony: Polska, Holandia, Francja.',
        'rules_5v5_standoff_2_3': '• Maksymalny dozwolony ping — 100 ms. Gracze z przekroczonym limitem mogą zostać wykluczeni z udziału.',
        'rules_5v5_standoff_2_4': '• Rejestracja odbywa się za pośrednictwem platformy lub formularza wskazanego przez organizatorów.',
        'rules_5v5_standoff_3_title': '3. Wymagania techniczne:',
        'rules_5v5_standoff_3_1': '• Gra odbywa się tylko na urządzeniach mobilnych. Używanie emulatorów jest zabronione.',
        'rules_5v5_standoff_3_2': '• Sprawdzenie pingu odbywa się przed każdym meczem.',
        'rules_5v5_standoff_3_3': '• Używanie VPN, proxy i wszelkich środków do zmiany regionu/pingu jest surowo zabronione.',
        'rules_5v5_standoff_4_title': '4. Format turnieju:',
        'rules_5v5_standoff_4_1': '• Mecze fazy grupowej odbywają się w formacie Best of 2 (BO2). Półfinał — Best of 3 (BO3).',
        'rules_5v5_standoff_4_2': '• Finał – Best of 5 (BO5).',
        'rules_5v5_standoff_4_3': '• Zwycięstwo przyznawane jest drużynie, która jako pierwsza wygra 13 rund.',
        'rules_5v5_standoff_4_4': '• Mapy są wybierane metodą „ban/pick” (odrzucenie/wybór).',
        'rules_5v5_standoff_4_5': '• Przerwy między połowami — 1 minuta. Zmiana stron następuje po 12 rundach.',
        'rules_5v5_standoff_5_title': '5. Zachowanie graczy:',
        'rules_5v5_standoff_5_1': '• Zabronione jest używanie zewnętrznego oprogramowania, cheatów i błędów.',
        'rules_5v5_standoff_5_2': '• Obraźliwe, toksyczne zachowanie i prowokacje są zabronione.',
        'rules_5v5_standoff_5_3': '• Wszystkie sporne sytuacje rozstrzyga sędzia meczu. Decyzje administracji są ostateczne.',
        'rules_5v5_standoff_6_title': '6. Przerwanie meczu:',
        'rules_5v5_standoff_6_1': '• W przypadku wyjścia gracza mecz jest kontynuowany, jeśli sytuacja nie jest krytyczna.',
        'rules_5v5_standoff_6_2': '• W przypadku problemów technicznych drużyna zobowiązana jest powiadomić administratora w ciągu 2 minut.',
        'rules_5v5_standoff_6_3': '• Dozwolona jest 1 pauza techniczna na mecz trwająca do 5 minut (po uzgodnieniu z sędzią).',
        'rules_5v5_standoff_7_title': '7. Sankcje:',
        'rules_5v5_standoff_7_1': '• 1. naruszenie zasad — ostrzeżenie.',
        'rules_5v5_standoff_7_2': '• 2. — dyskwalifikacja gracza lub całej drużyny w zależności od wagi naruszenia.',
        'rules_5v5_standoff_7_3': '• Powtarzające się naruszenia — natychmiastowe usunięcie z turnieju.',
        'rules_5v5_standoff_8_title': '8. Nagrody:',
        'rules_5v5_standoff_8_1': '• Pula nagród i podział miejsc ogłaszane są przed rozpoczęciem turnieju.',
        'rules_5v5_standoff_8_2': '• Nagrody są dzielone w drużynie samodzielnie lub równo (domyślnie).',
        'awards_title': 'Nagrody',
        'awards_text': 'Wszyscy finaliści otrzymują specjalne bonusy. Zwycięzcy otrzymują nagrody i certyfikaty.',
        'back_to_awards': '← Powrót do moich nagród',
        'tournament_details_title_dynamic': 'Szczegóły Turnieju i Ranking',
        'support_title': 'Wsparcie',
        'support_text': 'Napisz do nas, jeśli masz pytania lub problemy. Nasz zespół wsparcia jest gotowy do pomocy!',
        'contact_support_btn': "Skontaktuj się z pomocą techniczną",
        'tournament_view_title': 'Podgląd Turnieju',
        'create_tournament_btn': '➕ Stwórz turniej'
      }
    };

    let userProfile = JSON.parse(localStorage.getItem('userProfile')) || null;
    let notifications = JSON.parse(localStorage.getItem('notifications')) || [];
    let currentLanguage = localStorage.getItem('language') || 'uk';
    let isAdmin = localStorage.getItem('isAdmin') === 'true'; // Load admin status

    const langBtn = document.getElementById('langBtn');
    const langPopup = document.getElementById('langPopup');
    const profilePopup = document.getElementById('profilePopup');
    const avatar = document.getElementById('avatar');
    const registerBtn = document.getElementById('registerBtn');
    const profileForm = document.getElementById('profileForm');
    const doneBtn = document.getElementById('doneBtn');
    const successMsg = document.getElementById('successMsg');
    const playerProfile = document.getElementById('playerProfile');
    const createTeamBtn = document.getElementById('createTeamBtn');
    const teamForm = document.getElementById('teamForm');
    const teamSuccessMsg = document.getElementById('teamSuccessMsg');
    const teamAvatarInput = document.getElementById('teamAvatar');
    const teamAvatarPreview = document.getElementById('teamAvatarPreview');
    const notificationBtn = document.getElementById('notificationBtn');
    const notificationBadge = document.getElementById('notificationBadge');
    const notificationPopup = document.getElementById('notificationPopup');
    const notificationList = document.getElementById('notificationList');
    const clearNotificationsBtn = document.getElementById('clearNotificationsBtn');
    const adminMenuBtn = document.getElementById('adminMenuBtn');
    const adminPopup = document.getElementById('adminPopup');
    const adminMenuTitle = document.getElementById('adminMenuTitle');
    const createTournamentAdminBtn = document.getElementById('createTournamentAdminBtn');
    const tournamentMenuBtn = document.getElementById('tournamentMenuBtn');

    // Tournament creation modal elements
    const createTournamentModal = document.getElementById('createTournamentModal');
    const closeTournamentModalBtn = createTournamentModal.querySelector('.close-button');
    const createTournamentForm = document.getElementById('createTournamentForm');

    // Tournament View Section elements
    const tournamentViewSection = document.getElementById('tournamentViewSection');
    const groupStageDropdown = document.getElementById('groupStageDropdown');
    const playoffDropdown = document.getElementById('playoffDropdown');
    const groupATable = document.getElementById('groupATable');
    const groupBTable = document.getElementById('groupBTable');
    const playoffBracketView = document.getElementById('playoffBracketView');

    // Admin Tournament Edit elements
    const adminTournamentEdit = document.getElementById('adminTournamentEdit');
    const editGroupStageBtn = document.getElementById('editGroupStageBtn');
    const viewPlayoffBracketAdminBtn = document.getElementById('viewPlayoffBracketAdminBtn');
    const groupStageEdit = document.getElementById('groupStageEdit');
    const teamNameInput = document.getElementById('teamNameInput');
    const groupSelect = document.getElementById('groupSelect');
    const addTeamBtn = document.getElementById('addTeamBtn');
    const removeTeamBtn = document.getElementById('removeTeamBtn');
    const adminGroupATable = document.getElementById('adminGroupATable');
    const adminGroupBTable = document.getElementById('adminGroupBTable');
    const adminPlayoffBracketView = document.getElementById('adminPlayoffBracketView');


    const sections = document.querySelectorAll('.section');
    const navItems = document.querySelectorAll('.nav-item');

    // Sample awards data (can be fetched from backend)
    const awards = [
      { id: 'award1', icon: '🌟', title: 'Учасник фіналу', description: 'За участь у фінальному етапі турніру', tournament: 'RFORZ Grand Prix' },
      { id: 'award2', icon: '🥇', title: 'Переможець сезону', description: 'За перше місце у сезонному турнірі', tournament: 'Summer Cup 2024' },
      { id: 'award3', icon: '🔥', title: 'Найкращий гравець', description: 'Нагорода за видатні навички та внесок', tournament: 'Pro Series 2024' },
      { id: 'award4', icon: '🏆', title: 'Чемпіон', description: 'Головний трофей турніру', tournament: 'Autumn Championship' },
      { id: 'award5', icon: '🏅', title: 'Медаль за відвагу', description: 'За мужність та стійкість у складних матчах', tournament: 'Winter Showdown' }
    ];

    // Sample ranking data for tournament details
    const tournamentRankings = {
        'RFORZ Grand Prix': [
            { rank: 1, team: 'Team Alpha', wins: 10, losses: 1 },
            { rank: 2, team: 'Team Beta', wins: 8, losses: 3 },
            { rank: 3, team: 'Team Gamma', wins: 7, losses: 4 },
            { rank: 4, team: 'Team Delta', wins: 6, losses: 5 },
            { rank: 5, team: 'Team Epsilon', wins: 5, losses: 6 }
        ],
        'Summer Cup 2024': [
            { rank: 1, team: 'Team Frost', wins: 12, losses: 0 },
            { rank: 2, team: 'Team Blaze', wins: 9, losses: 3 },
            { rank: 3, team: 'Team Gale', wins: 8, losses: 4 }
        ]
    };

    function applyLanguage(lang) {
      document.querySelectorAll('[data-i18n]').forEach(element => {
        const key = element.getAttribute('data-i18n');
        if (i18n[lang] && i18n[lang][key]) {
          element.innerHTML = i18n[lang][key];
        }
      });
      document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
        const key = element.getAttribute('data-i18n-placeholder');
        if (i18n[lang] && i18n[lang][key]) {
          element.placeholder = i18n[lang][key];
        }
      });
      document.title = i18n[lang]['Telegram WebApp'] || 'Telegram WebApp';
      adminMenuTitle.textContent = i18n[lang]['admin_menu'];
    }

    function updateProfileDisplay() {
      if (userProfile) {
        document.getElementById('profileNick').textContent = userProfile.standoffNick;
        document.getElementById('profileId').textContent = userProfile.standoffId;
        document.getElementById('profileTg').textContent = userProfile.tgUser;
        registerBtn.style.display = 'none';
        profileForm.style.display = 'none';
        playerProfile.style.display = 'block';
        createTeamBtn.style.display = 'block';
      } else {
        registerBtn.style.display = 'block';
        playerProfile.style.display = 'none';
        createTeamBtn.style.display = 'none';
      }
    }

    function showSection(sectionId) {
      sections.forEach(section => {
        section.classList.remove('active');
      });
      document.getElementById(sectionId).classList.add('active');

      navItems.forEach(item => {
        item.classList.remove('active');
        if (item.getAttribute('data-section') === sectionId) {
          item.classList.add('active');
        }
      });

      // Close popups when switching sections
      langPopup.classList.remove('active');
      profilePopup.classList.remove('active');
      notificationPopup.classList.remove('active');
      adminPopup.classList.remove('active');
      createTournamentModal.style.display = 'none'; // Ensure modal is hidden
    }

    function showNotificationBadge() {
      if (notifications.length > 0) {
        notificationBadge.textContent = notifications.length;
        notificationBadge.style.display = 'flex';
      } else {
        notificationBadge.style.display = 'none';
      }
    }

    function renderNotifications() {
      notificationList.innerHTML = '';
      if (notifications.length === 0) {
        notificationList.innerHTML = '<p style="text-align:center; color:#bbb;">Немає нових сповіщень.</p>';
        return;
      }
      notifications.forEach((note, index) => {
        const notificationItem = document.createElement('div');
        notificationItem.classList.add('notification-item');
        notificationItem.style.cssText = `
          background: #292929;
          border-radius: 8px;
          padding: 10px 12px;
          margin-bottom: 8px;
          color: #eee;
          font-size: 0.95rem;
          display: flex;
          justify-content: space-between;
          align-items: center;
        `;
        notificationItem.innerHTML = `
          <span>${note.message}</span>
          <button data-index="${index}" class="delete-notification-btn" style="
            background: none;
            border: none;
            color: #e53935;
            font-size: 1.2rem;
            cursor: pointer;
            margin-left: 10px;
          ">&times;</button>
        `;
        notificationList.appendChild(notificationItem);
      });
      document.querySelectorAll('.delete-notification-btn').forEach(button => {
        button.addEventListener('click', (event) => {
          const indexToRemove = parseInt(event.target.dataset.index);
          notifications.splice(indexToRemove, 1);
          localStorage.setItem('notifications', JSON.stringify(notifications));
          renderNotifications();
          showNotificationBadge();
        });
      });
    }

    function displayAwards() {
        const myAwardsList = document.getElementById('myAwardsList');
        myAwardsList.innerHTML = ''; // Clear previous awards

        if (awards.length === 0) {
            myAwardsList.innerHTML = '<p style="text-align: center; color: #bbb;">Наразі у вас немає нагород.</p>';
            return;
        }

        awards.forEach(award => {
            const awardCard = document.createElement('div');
            awardCard.classList.add('award-card');
            awardCard.dataset.awardId = award.id; // Store award ID for later use
            awardCard.dataset.tournamentName = award.tournament; // Store tournament name

            let iconHtml = '';
            if (award.icon.startsWith('http')) { // Assuming it's an image URL
                iconHtml = `<img src="${award.icon}" alt="Award Icon" class="award-card-img">`;
            } else { // Assuming it's an emoji
                iconHtml = `<span class="award-card-icon">${award.icon}</span>`;
            }

            awardCard.innerHTML = `
                <div class="award-content-wrapper">
                    ${iconHtml}
                    <div class="award-text-content">
                        <h4>${award.title}</h4>
                        <p class="tournament-name-on-card">${award.tournament}</p>
                    </div>
                </div>
            `;
            myAwardsList.appendChild(awardCard);
        });
    }

    function showTournamentDetails(tournamentName) {
        const rankingTableContainer = document.getElementById('rankingTableContainer');
        const tournamentDetailsTitle = document.getElementById('tournamentDetailsTitle');
        rankingTableContainer.innerHTML = ''; // Clear previous content

        tournamentDetailsTitle.textContent = `Деталі Турніру: ${tournamentName}`;

        const rankings = tournamentRankings[tournamentName];

        if (rankings && rankings.length > 0) {
            const table = document.createElement('table');
            table.classList.add('ranking-table');
            let tableHTML = `
                <thead>
                    <tr>
                        <th>Місце</th>
                        <th>Команда</th>
                        <th>Перемоги</th>
                        <th>Поразки</th>
                    </tr>
                </thead>
                <tbody>
            `;
            rankings.forEach(entry => {
                tableHTML += `
                    <tr>
                        <td>${entry.rank}</td>
                        <td>${entry.team}</td>
                        <td>${entry.wins}</td>
                        <td>${entry.losses}</td>
                    </tr>
                `;
            });
            tableHTML += `</tbody>`;
            table.innerHTML = tableHTML;
            rankingTableContainer.appendChild(table);
        } else {
            rankingTableContainer.innerHTML = `<p style="text-align: center; color: #bbb;">Наразі немає рейтингу для цього турніру.</p>`;
        }
        showSection('tournamentDetailsSection');
    }

    // Function to generate playoff bracket (simple example)
    function generatePlayoffBracket(containerId) {
        const container = document.getElementById(containerId);
        container.innerHTML = ''; // Clear existing content

        // This is a placeholder. In a real application, you would dynamically
        // generate the bracket HTML/SVG based on tournament data.
        const bracketHtml = `
            <img src="Playoff_Bracket_Placeholder.png" alt="Сітка плей-офф" style="max-width:100%; height:auto; border-radius:8px; border:1px solid #00bfae;">
            <p style="margin-top:10px; font-size:0.9rem; color:#ccc;">(Зображення сітки плей-офф, лише для прикладу)</p>
        `;
        container.innerHTML = bracketHtml;
    }


    // Event Listeners
    langBtn.addEventListener('click', () => {
      langPopup.classList.toggle('active');
      profilePopup.classList.remove('active');
      notificationPopup.classList.remove('active');
      adminPopup.classList.remove('active'); // Close admin popup
    });

    document.querySelectorAll('.lang-option').forEach(button => {
      button.addEventListener('click', (event) => {
        currentLanguage = event.target.dataset.lang;
        localStorage.setItem('language', currentLanguage);
        applyLanguage(currentLanguage);
        langPopup.classList.remove('active');
      });
    });

    avatar.addEventListener('click', () => {
      profilePopup.classList.toggle('active');
      langPopup.classList.remove('active');
      notificationPopup.classList.remove('active');
      adminPopup.classList.remove('active'); // Close admin popup
    });

    registerBtn.addEventListener('click', () => {
      registerBtn.style.display = 'none';
      profileForm.style.display = 'flex';
      profilePopup.classList.add('active'); // Ensure popup is active
      // Pre-fill Telegram username if available from Telegram WebApp API
      if (window.Telegram && window.Telegram.WebApp && window.Telegram.WebApp.initDataUnsafe && window.Telegram.WebApp.initDataUnsafe.user) {
        document.getElementById('tgUser').value = `@${window.Telegram.WebApp.initDataUnsafe.user.username || 'N/A'}`;
      } else {
        document.getElementById('tgUser').value = 'N/A'; // Fallback
      }
    });

    profileForm.addEventListener('submit', (event) => {
      event.preventDefault();
      userProfile = {
        standoffNick: document.getElementById('standoffNick').value,
        standoffId: document.getElementById('standoffId').value,
        tgUser: document.getElementById('tgUser').value
      };
      localStorage.setItem('userProfile', JSON.stringify(userProfile));
      updateProfileDisplay();
      profilePopup.classList.remove('active');
      successMsg.style.display = 'block';
      setTimeout(() => successMsg.style.display = 'none', 3000);
    });

    createTeamBtn.addEventListener('click', () => {
      createTeamBtn.style.display = 'none';
      playerProfile.style.display = 'none';
      teamForm.style.display = 'flex';
      profilePopup.classList.add('active'); // Ensure popup is active
    });

    teamAvatarInput.addEventListener('change', (event) => {
      const file = event.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = (e) => {
          teamAvatarPreview.src = e.target.result;
          teamAvatarPreview.style.display = 'block';
        };
        reader.readAsDataURL(file);
      } else {
        teamAvatarPreview.style.display = 'none';
        teamAvatarPreview.src = '#';
      }
    });

    teamForm.addEventListener('submit', (event) => {
      event.preventDefault();
      // In a real app, you'd send this data to a backend
      alert('Команду створено!');
      teamSuccessMsg.style.display = 'block';
      setTimeout(() => teamSuccessMsg.style.display = 'none', 3000);

      teamForm.style.display = 'none';
      if (userProfile) {
        playerProfile.style.display = 'block';
        createTeamBtn.style.display = 'block';
      }
      profilePopup.classList.remove('active');
    });

    notificationBtn.addEventListener('click', () => {
      notificationPopup.classList.toggle('active');
      langPopup.classList.remove('active');
      profilePopup.classList.remove('active');
      adminPopup.classList.remove('active'); // Close admin popup
      renderNotifications();
    });

    clearNotificationsBtn.addEventListener('click', () => {
      notifications = [];
      localStorage.setItem('notifications', JSON.stringify(notifications));
      renderNotifications();
      showNotificationBadge();
    });

    adminMenuBtn.addEventListener('click', () => {
      adminPopup.classList.toggle('active');
      langPopup.classList.remove('active');
      profilePopup.classList.remove('active');
      notificationPopup.classList.remove('active');
    });

    createTournamentAdminBtn.addEventListener('click', () => {
      createTournamentModal.style.display = 'block';
      adminPopup.classList.remove('active'); // Close admin menu when opening modal
    });

    closeTournamentModalBtn.addEventListener('click', () => {
      createTournamentModal.style.display = 'none';
    });

    createTournamentForm.addEventListener('submit', (event) => {
      event.preventDefault();
      const tournamentData = {
        name: document.getElementById('tournamentName').value,
        discipline: document.getElementById('tournamentDiscipline').value,
        date: document.getElementById('tournamentDate').value,
        prize: document.getElementById('tournamentPrize').value,
        description: document.getElementById('tournamentDescription').value
      };
      console.log('New Tournament Data:', tournamentData);
      alert('Турнір успішно створено! (Дані відправлені в консоль)');
      createTournamentModal.style.display = 'none';
      createTournamentForm.reset();
    });

    tournamentMenuBtn.addEventListener('click', () => {
        // Toggle visibility for admin tournament edit section
        adminTournamentEdit.style.display = adminTournamentEdit.style.display === 'none' ? 'block' : 'none';
        // Hide user view if admin view is shown
        userTournamentView.style.display = adminTournamentEdit.style.display === 'block' ? 'none' : 'block';
        adminPopup.classList.remove('active'); // Close admin menu
    });

    editGroupStageBtn.addEventListener('click', () => {
        groupStageEdit.style.display = 'block';
        adminPlayoffBracketView.style.display = 'none';
    });

    viewPlayoffBracketAdminBtn.addEventListener('click', () => {
        adminPlayoffBracketView.style.display = 'block';
        groupStageEdit.style.display = 'none';
        generatePlayoffBracket('adminPlayoffBracketView'); // Generate bracket for admin view
    });

    addTeamBtn.addEventListener('click', () => {
        const teamName = teamNameInput.value.trim();
        const group = groupSelect.value;
        if (teamName && group) {
            const targetTable = group === 'groupA' ? adminGroupATable.querySelector('tbody') : adminGroupBTable.querySelector('tbody');
            const newRow = document.createElement('tr');
            newRow.innerHTML = `<td>${teamName}</td><td><button data-team="${teamName}" class="remove-btn">Видалити</button></td>`;
            targetTable.appendChild(newRow);
            teamNameInput.value = ''; // Clear input
            attachRemoveTeamListeners(); // Re-attach listeners for new buttons
        } else {
            alert('Будь ласка, введіть назву команди та виберіть групу.');
        }
    });

    removeTeamBtn.addEventListener('click', () => {
        // This button acts as a general remover for the input team name from the selected group
        const teamName = teamNameInput.value.trim();
        const group = groupSelect.value;
        if (teamName && group) {
            const targetTable = group === 'groupA' ? adminGroupATable.querySelector('tbody') : adminGroupBTable.querySelector('tbody');
            const rows = targetTable.querySelectorAll('tr');
            let removed = false;
            rows.forEach(row => {
                if (row.querySelector('td') && row.querySelector('td').textContent === teamName) {
                    row.remove();
                    removed = true;
                }
            });
            if (removed) {
                alert(`Команду "${teamName}" видалено з ${group}.`);
                teamNameInput.value = ''; // Clear input
            } else {
                alert(`Команду "${teamName}" не знайдено в ${group}.`);
            }
        } else {
            alert('Будь ласка, введіть назву команди та виберіть групу для видалення.');
        }
    });

    function attachRemoveTeamListeners() {
        document.querySelectorAll('.remove-btn').forEach(button => {
            button.onclick = (event) => {
                const teamToRemove = event.target.dataset.team;
                event.target.closest('tr').remove();
                alert(`Команду "${teamToRemove}" видалено.`);
            };
        });
    }

    // Initial attachment for existing remove buttons
    attachRemoveTeamListeners();

    groupStageDropdown.addEventListener('change', () => {
      groupATable.style.display = 'none';
      groupBTable.style.display = 'none';
      playoffBracketView.style.display = 'none';

      if (groupStageDropdown.value === 'groupA') {
        groupATable.style.display = 'block';
      } else if (groupStageDropdown.value === 'groupB') {
        groupBTable.style.display = 'block';
      }
    });

    playoffDropdown.addEventListener('change', () => {
      groupATable.style.display = 'none';
      groupBTable.style.display = 'none';
      playoffBracketView.style.display = 'none';

      if (playoffDropdown.value === 'playoffBracket') {
        playoffBracketView.style.display = 'block';
        generatePlayoffBracket('playoffBracketView');
      }
    });


    // Navigation
    navItems.forEach(item => {
      item.addEventListener('click', () => {
        const sectionId = item.getAttribute('data-section');
        showSection(sectionId);
      });
    });

    // Event listener for award cards
    document.getElementById('awardsSection').addEventListener('click', (event) => {
        const awardCard = event.target.closest('.award-card');
        if (awardCard) {
            const tournamentName = awardCard.dataset.tournamentName;
            if (tournamentName) {
                showTournamentDetails(tournamentName);
            }
        }
    });

    document.getElementById('backToAwardsBtn').addEventListener('click', () => {
        showSection('awardsSection');
    });

    // Initialize functions on load
    document.addEventListener('DOMContentLoaded', () => {
      applyLanguage(currentLanguage);
      updateProfileDisplay();
      showNotificationBadge();
      displayAwards(); // Call to display awards on page load

      // Admin menu visibility based on isAdmin status
      if (isAdmin) {
        adminMenuBtn.style.display = 'block';
      } else {
        adminMenuBtn.style.display = 'none';
      }

      // Hide all sections except home on initial load
      showSection('homeSection');
    });
  </script>
</body>
</html>
