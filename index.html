<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Telegram WebApp</title>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-TZN665FNYF"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-TZN665FNYF');
  </script>
  <style>
    body {
      margin: 0;
      background: #222;
      color: #fff;
      font-family: 'Segoe UI', Arial, sans-serif; /* Nicer font */
      padding-bottom: 60px;
    }
    .topbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px;
      position: relative;
    }
    .lang-btn {
      font-size: 1.5rem;
      cursor: pointer;
    }
    .lang-popup {
      display: none;
      position: absolute;
      top: 60px;
      left: 16px;
      background: #333;
      padding: 10px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.4);
      flex-direction: column;
      z-index: 10;
      width: 200px;
    }
    .lang-popup.active {
      display: flex;
    }
    .lang-option {
      background: none;
      color: #fff;
      border: none;
      padding: 8px 12px;
      text-align: left;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .lang-option:hover {
      background: #444;
    }
    .avatar-small {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      border: 2px solid #00bfae;
      cursor: pointer;
      object-fit: cover;
      background: #111;
      transition: box-shadow 0.2s;
    }
    .avatar-small:hover {
      box-shadow: 0 0 0 4px #00bfae55;
    }
    /* Updated Profile Popup positioning */
    #profilePopup {
      top: 60px;
      right: 16px; /* Moved to right */
      left: auto; /* Reset left */
      max-width: 360px;
    }
    .popup {
      display: none;
      position: absolute;
      top: 60px;
      right: 0;
      background: #333;
      padding: 24px 20px 20px 20px;
      border-radius: 16px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.5);
      z-index: 10;
      flex-direction: column;
      min-width: 0px;
      align-items: center;
      animation: fadeIn 0.2s;
    }
    .popup.active {
      display: flex;
    }

    .register-btn, .done-btn, .create-team-btn {
      background: #2196f3;
      color: #fff;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: bold;
      cursor: pointer;
      margin: 8px 0;
      transition: background 0.2s;
      width: 100%;
      max-width: 220px;
    }
    .register-btn:hover, .done-btn:hover, .create-team-btn:hover {
      background: #1976d2;
    }

    .profile-form,
    .team-form {
      display: flex;
      flex-direction: column;
      gap: 12px;
      width: 100%;
      max-width: 340px;
      margin-top: 8px;
      align-items: center;
    }
    .profile-form label,
    .team-form label {
      font-size: 0.95rem;
      color: #bbb;
      margin-bottom: 2px;
      align-self: flex-start;
    }
    .profile-form input,
    .team-form input[type="text"],
    .team-form input[type="file"] {
      padding: 8px;
      border-radius: 6px;
      border: 1px solid #555;
      background: #222;
      color: #fff;
      font-size: 1rem;
      outline: none;
      width: 100%;
    }
    .profile-form input[readonly] {
      background: #222;
      color: #aaa;
      border: 1px solid #444;
    }

    .player-profile {
      width: 100%;
      max-width: 220px;
      background: #222;
      border-radius: 10px;
      padding: 12px 14px;
      font-size: 1rem;
      display: none;
      color: #fff;
    }
    .player-profile-title {
      margin-bottom: 8px;
      color: #00bfae;
      font-weight: bold;
      font-size: 1.05rem;
    }
    .player-profile-row {
      margin-bottom: 4px;
      word-break: break-word;
    }

    .success-message, .team-success-message {
      color: #00bfae;
      font-size: 1rem;
      margin: 10px 0 0 0;
      text-align: center;
    }

    .team-avatar-preview {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid #00bfae;
      margin-bottom: 8px;
      background: #111;
      display: none;
    }

    .team-player-block {
      background: #292929;
      border-radius: 8px;
      padding: 10px 12px;
      margin-bottom: 8px;
      width: 100%;
      box-sizing: border-box;
    }
    .team-player-title {
      color: #00bfae;
      font-weight: bold;
      margin-bottom: 4px;
      font-size: 1rem;
    }

    .notification-btn {
      background: none;
      border: none;
      font-size: 2rem;
      cursor: pointer;
      position: relative;
      margin-left: 8px;
      color: #fff;
    }
    .notification-badge {
      position: absolute;
      top: 2px;
      right: 10px;
      background: #e53935;
      color: #fff;
      border-radius: 50%;
      font-size: 0.85rem;
      min-width: 20px;
      min-height: 20px;
      padding: 0 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      border: 2px solid #222;
      box-sizing: border-box;
      z-index: 2;
    }

    #adminPopup {
      display: none;
      position: fixed;
      top: 90px;
      right: 20px;
      background: #1e1e1e;
      border: 2px solid #00bfae;
      border-radius: 16px;
      padding: 20px 24px;
      z-index: 999;
      width: 320px;
      box-shadow: 0 0 20px rgba(0, 191, 174, 0.3);
      font-family: 'Segoe UI', sans-serif;
      animation: fadeIn 0.2s ease-in-out;
    }

    #adminPopup.active {
      display: block;
    }

    #adminPopup h2 {
      color: #00bfae;
      margin-top: 0;
      margin-bottom: 16px;
      font-size: 20px;
      text-align: center;
    }

    #adminPopup button {
      padding: 10px 16px;
      font-size: 15px;
      background-color: #2b2b2b;
      color: #eee;
      border: 1px solid #00bfae;
      border-radius: 10px;
      margin-bottom: 10px;
      width: 100%;
      transition: background 0.2s;
    }

    #adminPopup button:hover {
      background-color: #00bfae;
      color: #111;
    }

    #closeAdminModal {
      position: absolute;
      top: 10px;
      right: 10px;
      background: transparent;
      color: #aaa;
      border: none;
      font-size: 18px;
      cursor: pointer;
    }

    #adminMenuBtn {
      font-size: 28px;
      padding: 12px 16px;
      cursor: pointer;
      transition: all 0.2s ease-in-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: scale(0.95);}
      to { opacity: 1; transform: scale(1);}
    }

    .nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      color: #ccc;
      font-size: 0.85rem;
      cursor: pointer;
    }
    .nav-item span {
      font-size: 1.2rem;
      margin-bottom: 2px;
    }
    .nav-item.active, .nav-item:hover {
      color: #00bfae;
    }

    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background: #111;
      display: flex;
      justify-content: space-around;
      border-top: 1px solid #333;
      padding: 8px 0;
      z-index: 100;
    }
    .news-section,
    .disciplines-section,
    .tournaments-section {
      margin-top: 24px;
      padding: 0 16px;
    }

    .news-title,
    .disciplines-title,
    .tournaments-title {
      margin-left: 4px;
      margin-bottom: 8px;
      font-size: 1.2rem;
      font-weight: bold;
      color: #00bfae;
    }
    .news-list,
    .disciplines-list,
    .tournament-list {
      display: flex;
      overflow-x: auto;
      gap: 16px;
      padding: 12px 4px;
      scroll-snap-type: x mandatory;
    }

    .news-card,
    .tournament-card,
    .discipline-card {
      flex: 0 0 auto;
      width: 280px;
      background: #292929;
      border: 2px solid #00bfae88;
      border-radius: 12px;
      padding: 16px;
      scroll-snap-align: start;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .news-card:hover,
    .tournament-card:hover,
    .discipline-card:hover {
      transform: scale(1.02);
      box-shadow: 0 4px 10px rgba(0, 191, 174, 0.25);
    }

    .news-card h4,
    .tournament-card h4 {
      margin-top: 0;
      color: #00bfae;
      font-size: 1.1rem;
    }

    .news-card p,
    .tournament-card p {
      font-size: 0.95rem;
      color: #ddd;
    }

    .discipline-img {
      width: 100%;
      border-radius: 8px;
      margin-bottom: 8px;
    }

    .discipline-name {
      font-weight: bold;
      text-align: center;
      font-size: 1rem;
      color: #fff;
    }
    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background: #111;
      display: flex;
      justify-content: space-around;
      border-top: 1px solid #333;
      padding: 8px 0;
      z-index: 100;
    }
    .nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      color: #ccc;
      font-size: 0.85rem;
      cursor: pointer;
    }
    .nav-item span {
      font-size: 1.2rem;
      margin-bottom: 2px;
    }
    .nav-item:hover {
      color: #00bfae;
    }
    .section {
      padding: 24px 16px;
      display: none;
    }
    .section.active {
      display: block;
    }
    /* Updated Notification Popup positioning */
    #notificationPopup {
      right: 16px; /* Adjusted to align with other right-aligned elements */
      min-width: 280px;
    }

    /* New styles for consistent pages */
    .section h2 {
      margin-top: 0;
      margin-bottom: 16px;
      font-size: 1.5rem; /* Larger heading */
      font-weight: bold;
      color: #00bfae; /* Consistent highlight color */
      text-align: center;
    }
    .section p {
      font-size: 1rem;
      color: #ddd;
      line-height: 1.5;
      margin-bottom: 16px;
    }
    .section details {
      background: #292929;
      border: 2px solid #00bfae88;
      border-radius: 12px;
      padding: 12px 16px;
      margin-bottom: 12px;
      color: #fff;
      font-size: 1rem;
    }
    .section summary {
      font-weight: bold;
      color: #00bfae;
      cursor: pointer;
      padding: 4px 0;
    }
    .section details p {
      padding-top: 10px;
      margin-bottom: 0;
      color: #ccc;
      font-size: 1rem; /* Bigger font for rules */
      font-family: 'Segoe UI', Arial, sans-serif; /* Nicer font for rules */
    }

    /* Styles for Awards and Tournament Details */
    .award-card {
        background: #292929;
        border: 2px solid #00bfae88;
        border-radius: 12px;
        padding: 12px; /* Smaller padding for a more compact card */
        margin-bottom: 12px;
        display: flex; /* Make it horizontal */
        align-items: center; /* Vertically align items */
        gap: 12px; /* Space between icon and text */
        cursor: pointer; /* Indicate it's clickable */
        transition: transform 0.2s, box-shadow 0.2s;
    }
    .award-card:hover {
        transform: scale(1.02);
        box-shadow: 0 4px 10px rgba(0, 191, 174, 0.25);
    }

    .award-content-wrapper {
        display: flex;
        align-items: center;
        gap: 12px;
        width: 100%; /* Take full width of card */
    }

    .award-card-icon {
        font-size: 2.2rem; /* Size for emoji icon */
        line-height: 1;
        flex-shrink: 0; /* Prevent icon from shrinking */
    }

    .award-card-img {
        width: 48px; /* Size for image icon */
        height: 48px;
        object-fit: cover;
        border-radius: 8px; /* Slightly rounded corners for images */
        flex-shrink: 0;
    }

    .award-text-content {
        flex-grow: 1; /* Allow text content to take available space */
    }

    .award-text-content h4 {
        margin: 0;
        color: #00bfae;
        font-size: 1.1rem;
        white-space: nowrap; /* Prevent title from wrapping */
        overflow: hidden; /* Hide overflow */
        text-overflow: ellipsis; /* Add ellipsis if too long */
    }

    .tournament-name-on-card {
        margin: 4px 0 0;
        font-size: 0.9rem;
        color: #ddd;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .btn-primary {
        background: #00bfae;
        color: #fff;
        border: none;
        padding: 12px 24px;
        border-radius: 8px;
        font-size: 1rem;
        font-weight: bold;
        cursor: pointer;
        margin-top: 20px;
        transition: background 0.2s ease-in-out;
        width: 100%;
        max-width: 300px;
        display: block; /* Make it a block element to center with margin auto */
        margin-left: auto;
        margin-right: auto;
        text-align: center;
    }

    .btn-primary:hover {
        background: #008f82;
    }

    .back-btn {
        background: #333;
        color: #eee;
        border: 1px solid #555;
        padding: 10px 20px;
        border-radius: 8px;
        font-size: 0.9rem;
        cursor: pointer;
        margin-top: 20px;
        margin-bottom: 10px;
        transition: background 0.2s ease-in-out;
    }

    .back-btn:hover {
        background: #444;
    }

    .ranking-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
        color: #fff;
    }

    .ranking-table th,
    .ranking-table td {
        padding: 10px;
        border: 1px solid #333;
        text-align: left;
    }

    .ranking-table th {
        background-color: #00bfae;
        color: #111;
        font-weight: bold;
    }

    .ranking-table tbody tr:nth-child(even) {
        background-color: #292929;
    }

    .ranking-table tbody tr:nth-child(odd) {
        background-color: #222;
    }

    /* Styles for the new Tournament section */
    .tournament-section-content {
        background: #292929;
        border: 2px solid #00bfae88;
        border-radius: 12px;
        padding: 16px;
        margin-top: 20px;
    }

    .tournament-section-content h3 {
        color: #00bfae;
        margin-top: 0;
        margin-bottom: 10px;
    }

    /* New Tab/Header styles */
    .tournament-tabs {
        display: flex;
        justify-content: space-around;
        margin-bottom: 20px;
        border-bottom: 1px solid #555; /* A subtle separator for the tabs area */
    }

    .tournament-tab {
        padding: 12px 20px;
        cursor: pointer;
        font-size: 1.1rem;
        font-weight: bold;
        color: #ccc;
        transition: color 0.2s, border-bottom 0.2s;
        flex-grow: 1; /* Make tabs take equal width */
        text-align: center;
        border-bottom: 2px solid transparent; /* Default state */
    }

    .tournament-tab:hover {
        color: #fff;
    }

    .tournament-tab.active {
        color: #00bfae;
        border-bottom: 2px solid #00bfae; /* Active tab indicator */
    }

    .tournament-tab-content {
        display: none;
        width: 100%;
    }

    .tournament-tab-content.active {
        display: block;
    }

    .group-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 10px;
    }

    .group-table th,
    .group-table td {
        border: 1px solid #333;
        padding: 8px;
        text-align: left;
    }

    .group-table th {
        background-color: #00bfae;
        color: #111;
    }

    .group-table tbody tr:nth-child(even) {
        background-color: #292929;
    }

    .group-table tbody tr:nth-child(odd) {
        background-color: #222;
    }

    .playoff-bracket {
        margin-top: 20px;
        text-align: center; /* Center the bracket content */
        color: #ddd;
    }

    .playoff-bracket img {
        max-width: 100%;
        height: auto;
        display: block;
        margin: 0 auto;
        border-radius: 8px;
        border: 1px solid #00bfae;
    }

    /* Styles for the Tournament Creation Modal */
    .modal {
      display: none; /* Hidden by default */
      position: fixed; /* Stay in place */
      z-index: 1001; /* Sit on top */
      left: 0;
      top: 0;
      width: 100%; /* Full width */
      height: 100%; /* Full height */
      overflow: auto; /* Enable scroll if needed */
      background-color: rgba(0,0,0,0.6); /* Black w/ opacity */
      padding-top: 60px;
    }

    .modal-content {
      background-color: #333;
      margin: 5% auto; /* 5% from the top and centered */
      padding: 20px;
      border: 1px solid #00bfae;
      border-radius: 12px;
      width: 90%; /* Could be more responsive */
      max-width: 500px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.5);
      animation: fadeIn 0.3s ease-out;
      position: relative;
    }

    .close-button {
      color: #aaa;
      position: absolute;
      top: 10px;
      right: 20px;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
    }

    .close-button:hover,
    .close-button:focus {
      color: #fff;
      text-decoration: none;
      cursor: pointer;
    }

    .modal h2 {
      color: #00bfae;
      text-align: center;
      margin-top: 0;
      margin-bottom: 20px;
      font-size: 1.8rem;
    }

    .form-group {
      margin-bottom: 15px;
    }

    .form-group label {
      display: block;
      margin-bottom: 5px;
      color: #eee;
      font-size: 0.95rem;
    }

    .form-group input[type="text"],
    .form-group input[type="date"],
    .form-group input[type="number"],
    .form-group textarea,
    .form-group select {
      width: calc(100% - 20px);
      padding: 10px;
      border-radius: 6px;
      border: 1px solid #555;
      background: #222;
      color: #fff;
      font-size: 1rem;
      outline: none;
    }

    .form-group textarea {
      resize: vertical;
      min-height: 80px;
    }

    .submit-btn {
      background: #00bfae;
      color: #fff;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      font-size: 1.1rem;
      font-weight: bold;
      cursor: pointer;
      display: block;
      width: 100%;
      max-width: 250px;
      margin: 20px auto 0;
      transition: background 0.2s ease-in-out;
    }

    .submit-btn:hover {
      background: #008f82;
    }
  </style>
</head>
<body>
  <div class="topbar">
    <div class="lang-btn" id="langBtn">🌐</div>
    <div id="langPopup" class="lang-popup popup">
      <button class="lang-option" data-lang="uk">🇺🇦 Українська</button>
      <button class="lang-option" data-lang="en">🇬🇧 English</button>
      <button class="lang-option" data-lang="ru">🇷🇺 Русский</button>
      <button class="lang-option" data-lang="pl">🇵🇱 Polski</button>
    </div>
    <img id="avatar" class="avatar-small" src="avatar.jpg" alt="Avatar">
    <button id="notificationBtn" class="notification-btn" title="Сповіщення">
      🔔
      <span id="notificationBadge" class="notification-badge" style="display:none;">0</span>
    </button>
    <div class="admin-menu" id="adminMenuBtn" title="Адмін-меню">🛡️</div>
    <div id="adminPopup" class="adminPopup popup">
      <h2 id="adminMenuTitle" style="color:#00bfae; margin-top:0;">Адмін-меню</h2>
      <div style="display:flex; flex-direction:column; gap:12px;">
        <button id="createTournamentAdminBtn" data-i18n="create_tournament_btn">➕ Створити турнір</button>
        <button id="banUserBtn" data-i18n="ban_user">🚫 Заблокувати користувача</button>
        <button id="unbanUserBtn" data-i18n="unban_user">✅ Розблокувати користувача</button>
        <button id="givePrizeBtn" data-i18n="give_prize">🏆 Видати приз</button>
        <button id="disqualifyTeamBtn" data-i18n="disqualify_team">❌ Дискваліфікувати команду</button>
      </div>
    </div>

    <div id="profilePopup" class="popup">
      <button class="register-btn" id="registerBtn" data-i18n="register">Зареєструватись</button>
    </div>
    <form class="profile-form" id="profileForm" style="display:none;">
      <label for="standoffNick" data-i18n="standoff_nick">Нік в Standoff</label>
      <input type="text" id="standoffNick" name="standoffNick" required maxlength="32" autocomplete="off">
      <label for="standoffId" data-i18n="standoff_id">ID в Standoff</label>
      <input type="text" id="standoffId" name="standoffId" required maxlength="32" autocomplete="off">
      <label for="tgUser" data-i18n="tg_user">Telegram</label>
      <input type="text" id="tgUser" name="tgUser" readonly>
      <button type="submit" class="done-btn" id="doneBtn" data-i18n="done">Готово</button>
    </form>

    <div class="player-profile" id="playerProfile">
      <div class="player-profile-title" data-i18n="profile">Профіль гравця</div>
      <div class="player-profile-row">
        <span data-i18n="standoff_nick">Нік в Standoff</span>: <span id="profileNick"></span>
      </div>
      <div class="player-profile-row">
        <span data-i18n="standoff_id">ID в Standoff</span>: <span id="profileId"></span>
      </div>
      <div class="player-profile-row">
        <span data-i18n="tg_user">Telegram</span>: <span id="profileTg"></span>
      </div>
    </div>

    <button class="create-team-btn" id="createTeamBtn" style="display:none;" data-i18n="create_team">Створити команду</button>
    <div class="success-message" id="successMsg" style="display:none;" data-i18n="profile_saved">Профіль збережено!</div>

    <form class="team-form" id="teamForm" style="display:none;">
      <label for="teamAvatar" data-i18n="team_avatar">Аватарка команди</label>
      <input type="file" id="teamAvatar" accept="image/*">
      <img id="teamAvatarPreview" class="team-avatar-preview" src="#" alt="Team Avatar">

      <label for="teamTag" data-i18n="team_tag">Тег команди</label>
      <input type="text" id="teamTag" maxlength="12" required data-i18n-placeholder="team_tag_ph">

      <label for="teamName" data-i18n="team_name">Назва команди</label>
      <input type="text" id="teamName" maxlength="32" required data-i18n-placeholder="team_name_ph">

      <div class="team-player-block">
        <div class="team-player-title" data-i18n="main_player1">Гравець 1 (капітан)</div>
        <input type="text" id="main1Id" placeholder="ID в Standoff 2" required data-i18n-placeholder="player_id_ph">
        <input type="text" id="main1Nick" placeholder="Нікнейм" required data-i18n-placeholder="player_nick_ph">
        <input type="text" id="main1Tg" placeholder="Telegram" required data-i18n-placeholder="player_tg_ph">
      </div>
      <div class="team-player-block">
        <div class="team-player-title" data-i18n="main_player2">Гравець 2 (основний)</div>
        <input type="text" id="main2Id" placeholder="ID в Standoff 2" required data-i18n-placeholder="player_id_ph">
        <input type="text" id="main2Nick" placeholder="Нікнейм" required data-i18n-placeholder="player_nick_ph">
        <input type="text" id="main2Tg" placeholder="Telegram" required data-i18n-placeholder="player_tg_ph">
      </div>
      <div class="team-player-block">
        <div class="team-player-title" data-i18n="main_player3">Гравець 3 (основний)</div>
        <input type="text" id="main3Id" placeholder="ID в Standoff 2" required data-i18n-placeholder="player_id_ph">
        <input type="text" id="main3Nick" placeholder="Нікнейм" required data-i18n-placeholder="player_nick_ph">
        <input type="text" id="main3Tg" placeholder="Telegram" required data-i18n-placeholder="player_tg_ph">
      </div>
      <div class="team-player-block">
        <div class="team-player-title" data-i18n="main_player4">Гравець 4 (основний)</div>
        <input type="text" id="main4Id" placeholder="ID в Standoff 2" required data-i18n-placeholder="player_id_ph">
        <input type="text" id="main4Nick" placeholder="Нікнейм" required data-i18n-placeholder="player_nick_ph">
        <input type="text" id="main4Tg" placeholder="Telegram" required data-i18n-placeholder="player_tg_ph">
      </div>
      <div class="team-player-block">
        <div class="team-player-title" data-i18n="main_player5">Гравець 5 (основний)</div>
        <input type="text" id="main5Id" placeholder="ID в Standoff 2" required data-i18n-placeholder="player_id_ph">
        <input type="text" id="main5Nick" placeholder="Нікнейм" required data-i18n-placeholder="player_nick_ph">
        <input type="text" id="main5Tg" placeholder="Telegram" required data-i18n-placeholder="player_tg_ph">
      </div>
      <div class="team-player-block">
        <div class="team-player-title" data-i18n="spare_player1">Гравець 6 (запасний)</div>
        <input type="text" id="spare1Id" placeholder="ID в Standoff 2" required data-i18n-placeholder="player_id_ph">
        <input type="text" id="spare1Nick" placeholder="Нікнейм" required data-i18n-placeholder="player_nick_ph">
        <input type="text" id="spare1Tg" placeholder="Telegram" required data-i18n-placeholder="player_tg_ph">
      </div>
      <div class="team-player-block">
        <div class="team-player-title" data-i18n="spare_player2">Гравець 7 (запасний)</div>
        <input type="text" id="spare2Id" placeholder="ID в Standoff 2" required data-i18n-placeholder="player_id_ph">
        <input type="text" id="spare2Nick" placeholder="Нікнейм" required data-i18n-placeholder="player_nick_ph">
        <input type="text" id="spare2Tg" placeholder="Telegram" required data-i18n-placeholder="player_tg_ph">
      </div>
      <button type="submit" class="done-btn" id="teamDoneBtn" data-i18n="team_done">Готово</button>
    </form>
    <div class="team-success-message" id="teamSuccessMsg" style="display:none;" data-i18n="team_created">Команду створено!</div>
  </div>
  <div id="notificationPopup" class="popup">
    <div style="font-weight:bold; color:#00bfae; margin-bottom:8px;" id="notificationTitle">Сповіщення</div>
    <div id="notificationList" style="width:100%;"></div>
    <button id="clearNotificationsBtn" class="done-btn" style="margin-top:10px;">Очистити</button>
  </div>
  <div id="homeSection" class="section active">
    <div class="main-section" id="mainSection">
      <div class="news-section">
        <div class="news-title" data-i18n="news">Новини</div>
        <div class="news-list" id="newsList">
          <div class="news-card">
            <h4 data-i18n="news1title">🔔 Оновлення</h4>
            <p data-i18n="news1desc">Ми додали підтримку англійської мови та оновили інтерфейс.</p>
          </div>
          <div class="news-card">
            <h4 data-i18n="news2title">🏆 Турніри оновлено</h4>
            <p data-i18n="news2desc">Тепер усі турніри доступні на окремій сторінці.</p>
          </div>
        </div>
      </div>
      <div class="disciplines-section">
        <div class="disciplines-title" data-i18n="disciplines">Дисципліни</div>
        <div class="disciplines-list">
          <div class="discipline-card">
            <img src="Standoff2.jpg" alt="Standoff 2" class="discipline-img">
            <div class="discipline-name">Standoff 2</div>
          </div>
        </div>
      </div>
      <div class="tournaments-section">
        <div class="tournaments-title" data-i18n="tournaments">Турніри</div>
        <div class="tournament-list" id="tournamentList">
          <div class="tournament-card">
            <h4>RFORZ Grand Prix</h4>
            <p data-i18n="tournament1desc">Старт: 1 липня. Призовий фонд: 5000₴</p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="awardsSection" class="section">
    <h2 data-i18n="awards_title">Нагороди</h2>
    <div id="awardsList"> </div>
  </div>
  <div class="modal" id="createTournamentModal">
    <div class="modal-content">
      <span class="close-button" id="closeTournamentModalBtn">&times;</span>
      <h2>Створити Турнір</h2>
      <form id="tournamentForm">
        <div class="form-group">
          <label for="tournamentName">Назва Турніру</label>
          <input type="text" id="tournamentName" required>
        </div>
        <div class="form-group">
          <label for="tournamentDiscipline">Дисципліна</label>
          <select id="tournamentDiscipline" required>
            <option value="standoff2">Standoff 2</option>
          </select>
        </div>
        <div class="form-group">
          <label for="tournamentFormat">Формат</label>
          <select id="tournamentFormat" required>
            <option value="1v1">1v1</option>
            <option value="2v2">2v2</option>
            <option value="5v5">5v5</option>
          </select>
        </div>
        <div class="form-group">
          <label for="startDate">Дата початку</label>
          <input type="date" id="startDate" required>
        </div>
        <div class="form-group">
          <label for="endDate">Дата закінчення</label>
          <input type="date" id="endDate" required>
        </div>
        <div class="form-group">
          <label for="prizePool">Призовий Фонд</label>
          <input type="number" id="prizePool" min="0" value="0" required>
        </div>
        <div class="form-group">
          <label for="description">Опис</label>
          <textarea id="description" rows="4"></textarea>
        </div>
        <button type="submit" class="submit-btn">Створити</button>
      </form>
    </div>
  </div>
  <div id="tournamentViewSection" class="section">
    <button id="backToHomeFromTournamentView" class="back-btn" data-i18n="back_to_home">← Головна</button>
    <h2 data-i18n="tournament_view_title">Перегляд Турніру</h2>
    <div class="tournament-section-content">
      <div id="userTournamentView">
        <div id="tournamentTabs" class="tournament-tabs">
          <div class="tournament-tab active" data-tab="groupStage">Груповий етап</div>
          <div class="tournament-tab" data-tab="playoffs">Плей-офф</div>
        </div>
        <div id="groupStageContent" class="tournament-tab-content active">
          <h3>Група A</h3>
          <table class="group-table">
            <thead>
              <tr>
                <th>Команда</th>
                <th>Перемоги</th>
                <th>Поразки</th>
              </tr>
            </thead>
            <tbody>
              <tr><td>Команда Alpha</td><td>3</td><td>0</td></tr>
              <tr><td>Команда Beta</td><td>2</td><td>1</td></tr>
              <tr><td>Команда Gamma</td><td>1</td><td>2</td></tr>
              <tr><td>Команда Delta</td><td>0</td><td>3</td></tr>
            </tbody>
          </table>
          <h3 style="margin-top:20px;">Група B</h3>
          <table class="group-table">
            <thead>
              <tr>
                <th>Команда</th>
                <th>Перемоги</th>
                <th>Поразки</th>
              </tr>
            </thead>
            <tbody>
              <tr><td>Команда Echo</td><td>3</td><td>0</td></tr>
              <tr><td>Команда Foxtrot</td><td>2</td><td>1</td></tr>
              <tr><td>Команда Golf</td><td>1</td><td>2</td></tr>
              <tr><td>Команда Hotel</td><td>0</td><td>3</td></tr>
            </tbody>
          </table>
        </div>
        <div id="playoffsContent" class="tournament-tab-content">
          <h3>Сітка плей-офф</h3>
          <p>Тут буде відображено сітку плей-офф.</p>
          <img src="playoff_bracket_placeholder.png" alt="Playoff Bracket Placeholder" style="max-width:100%; height:auto; display:block; margin: 0 auto; border-radius:8px; border:1px solid #00bfae;">
        </div>
      </div>
      <div id="adminTournamentEdit" style="display:none;">
        <h3>Редагувати Турнір</h3>
        <div class="admin-edit-options">
          <button id="editGroupStageBtn">Редагувати Груповий Етап</button>
          <button id="viewPlayoffBracketAdminBtn">Переглянути Сітку Плей-офф</button>
        </div>
        <div id="groupStageEdit" style="display:none;">
          <h4>Редагування Групового Етапу</h4>
          <input type="text" id="teamNameInput" placeholder="Назва команди">
          <select id="groupSelect">
            <option value="groupA">Група A</option>
            <option value="groupB">Група B</option>
          </select>
          <button id="addTeamBtn">Додати Команду</button>
          <button id="removeTeamBtn">Видалити Команду</button>
          <div id="currentGroupATable">
            <h5>Група A (поточна)</h5>
            <table class="group-table" id="adminGroupATable">
              <thead>
                <tr><th>Команда</th><th>Дії</th></tr>
              </thead>
              <tbody>
                <tr><td>Команда Alpha</td><td><button data-team="Команда Alpha" class="remove-btn">Видалити</button></td></tr>
                <tr><td>Команда Beta</td><td><button data-team="Команда Beta" class="remove-btn">Видалити</button></td></tr>
              </tbody>
            </table>
          </div>
          <div id="currentGroupBTable">
            <h5>Група B (поточна)</h5>
            <table class="group-table" id="adminGroupBTable">
              <thead>
                <tr><th>Команда</th><th>Дії</th></tr>
              </thead>
              <tbody>
                <tr><td>Команда Echo</td><td><button data-team="Команда Echo" class="remove-btn">Видалити</button></td></tr>
              </tbody>
            </table>
          </div>
        </div>
        <div id="adminPlayoffBracketView" class="playoff-bracket" style="display:none;">
          <h4>Сітка Плей-офф (Адмін)</h4>
          <p>Тут буде адмін-інтерфейс для керування сіткою плей-офф.</p>
          <p>Будь ласка, надайте зображення сітки плей-офф, і я зможу розмістити його тут, зберігши поточний фон.</p>
          <img src="playoff_bracket_placeholder.png" alt="Playoff Bracket Placeholder" style="max-width:100%; height:auto; display:block; margin: 0 auto; border-radius:8px; border:1px solid #00bfae;">
        </div>
      </div>
    </div>
  </div>
  <div id="tournamentDetailsSection" class="section">
    <button id="backToAwardsBtn" class="back-btn" data-i18n="back_to_awards">← Нагороди</button>
    <h2 id="tournamentDetailsTitle"></h2>
    <p id="tournamentDetailsDescription"></p>
    <h3 data-i18n="ranking">Рейтинг</h3>
    <table class="ranking-table">
      <thead>
        <tr>
          <th>Місце</th>
          <th>Команда/Гравець</th>
          <th>Нагорода</th>
        </tr>
      </thead>
      <tbody id="tournamentRankingBody">
      </tbody>
    </table>
  </div>
  <div id="rulesSection" class="section">
    <h2 data-i18n="rules_main_title">Правила турніру</h2>
    <details>
      <summary data-i18n="rules_1v1_summary">Турніри 1х1</summary>
      <p data-i18n="rules_1v1_text">• Гравці грають один проти одного.<br> • Раунди проходять до 3 перемог.<br> • Перемагає той, хто перший виграє 3 раунди. </p>
    </details>
    <details>
      <summary data-i18n="rules_2v2_summary">Турніри 2х2</summary>
      <p data-i18n="rules_2v2_text">• Команди по 2 гравці.<br> • Успіх залежить від координації та злагодженої гри.<br> • Перші до 5 перемог — проходять далі.<br> • Якщо рахунок 5-5, грається додатковий раунд. </p>
    </details>
    <details>
      <summary data-i18n="rules_5v5_standoff_summary">Турніри 5х5</summary>
      <p data-i18n="rules_5v5_standoff_text">• Команди по 5 гравців.<br> • Грають 10 раундів.<br> • Перемагає команда, що набрала більше раундів.<br> • Якщо рахунок 5-5, грається додатковий раунд. </p>
    </details>
  </div>
  <div id="supportSection" class="section">
    <h2 data-i18n="support_title">Підтримка</h2>
    <p data-i18n="support_description">Якщо у вас виникли питання або проблеми, будь ласка, зв'яжіться з нами:</p>
    <ul>
      <li data-i18n="support_email">Електронна пошта: support@example.com</li>
      <li data-i18n="support_telegram">Telegram: @OurSupportBot</li>
    </ul>
    <p data-i18n="support_note">Ми працюємо, щоб забезпечити вам найкращий досвід гри. Звертайтеся!</p>
  </div>
  <footer class="bottom-nav">
    <div class="nav-item active" id="homeNav">
      <span>🏠</span>
      <span data-i18n="home">Головна</span>
    </div>
    <div class="nav-item" id="awardsNav">
      <span>🏆</span>
      <span data-i18n="awards">Нагороди</span>
    </div>
    <div class="nav-item" id="rulesNav">
      <span>📚</span>
      <span data-i18n="rules">Правила</span>
    </div>
    <div class="nav-item" id="supportNav">
      <span>💬</span>
      <span data-i18n="support">Підтримка</span>
    </div>
  </footer>

  <script>
    // Mock Telegram WebApp for local testing or if running outside Telegram
    if (!window.Telegram) {
      window.Telegram = {
        WebApp: {
          initDataUnsafe: {
            user: {
              id: 123456789, // Example user ID (non-admin)
              first_name: "Test",
              last_name: "User"
            }
          },
          ready: () => console.log("Telegram WebApp is ready (mocked)"),
          expand: () => console.log("Telegram WebApp expanded (mocked)")
        }
      };
    }

    // Language and Profile Management
    const langBtn = document.getElementById('langBtn');
    const langPopup = document.getElementById('langPopup');
    const langOptions = document.querySelectorAll('.lang-option');
    let currentLanguage = localStorage.getItem('language') || 'uk'; // Default to Ukrainian

    const translations = {
        uk: {
            home: "Головна",
            awards: "Нагороди",
            rules: "Правила",
            support: "Підтримка",
            register: "Зареєструватись",
            profile: "Профіль гравця",
            standoff_nick: "Нік в Standoff",
            standoff_id: "ID в Standoff",
            tg_user: "Telegram",
            done: "Готово",
            profile_saved: "Профіль збережено!",
            create_team: "Створити команду",
            team_avatar: "Аватарка команди",
            team_tag: "Тег команди",
            team_name: "Назва команди",
            main_player1: "Гравець 1 (капітан)",
            main_player2: "Гравець 2 (основний)",
            main_player3: "Гравець 3 (основний)",
            main_player4: "Гравець 4 (основний)",
            main_player5: "Гравець 5 (основний)",
            spare_player1: "Гравець 6 (запасний)",
            spare_player2: "Гравець 7 (запасний)",
            player_id_ph: "ID в Standoff 2",
            player_nick_ph: "Нікнейм",
            player_tg_ph: "Telegram",
            team_done: "Готово",
            team_created: "Команду створено!",
            news: "Новини",
            news1title: "🔔 Оновлення",
            news1desc: "Ми додали підтримку англійської мови та оновили інтерфейс.",
            news2title: "🏆 Турніри оновлено",
            news2desc: "Тепер усі турніри доступні на окремій сторінці.",
            disciplines: "Дисципліни",
            tournaments: "Турніри",
            tournament1desc: "Старт: 1 липня. Призовий фонд: 5000₴",
            awards_title: "Нагороди",
            create_tournament_btn: "➕ Створити турнір",
            ban_user: "🚫 Заблокувати користувача",
            unban_user: "✅ Розблокувати користувача",
            give_prize: "🏆 Видати приз",
            disqualify_team: "❌ Дискваліфікувати команду",
            back_to_home: "← Головна",
            tournament_view_title: "Перегляд Турніру",
            ranking: "Рейтинг",
            back_to_awards: "← Нагороди",
            rules_main_title: "Правила турніру",
            rules_1v1_summary: "Турніри 1х1",
            rules_1v1_text: "• Гравці грають один проти одного.<br> • Раунди проходять до 3 перемог.<br> • Перемагає той, хто перший виграє 3 раунди. ",
            rules_2v2_summary: "Турніри 2х2",
            rules_2v2_text: "• Команди по 2 гравці.<br> • Успіх залежить від координації та злагодженої гри.<br> • Перші до 5 перемог — проходять далі.<br> • Якщо рахунок 5-5, грається додатковий раунд. ",
            rules_5v5_standoff_summary: "Турніри 5х5",
            rules_5v5_standoff_text: "• Команди по 5 гравців.<br> • Грають 10 раундів.<br> • Перемагає команда, що набрала більше раундів.<br> • Якщо рахунок 5-5, грається додатковий раунд. ",
            support_title: "Підтримка",
            support_description: "Якщо у вас виникли питання або проблеми, будь ласка, зв'яжіться з нами:",
            support_email: "Електронна пошта: support@example.com",
            support_telegram: "Telegram: @OurSupportBot",
            support_note: "Ми працюємо, щоб забезпечити вам найкращий досвід гри. Звертайтеся!"
        },
        en: {
            home: "Home",
            awards: "Awards",
            rules: "Rules",
            support: "Support",
            register: "Register",
            profile: "Player Profile",
            standoff_nick: "Standoff Nickname",
            standoff_id: "Standoff ID",
            tg_user: "Telegram",
            done: "Done",
            profile_saved: "Profile saved!",
            create_team: "Create Team",
            team_avatar: "Team Avatar",
            team_tag: "Team Tag",
            team_name: "Team Name",
            main_player1: "Player 1 (Captain)",
            main_player2: "Player 2 (Main)",
            main_player3: "Player 3 (Main)",
            main_player4: "Player 4 (Main)",
            main_player5: "Player 5 (Main)",
            spare_player1: "Player 6 (Substitute)",
            spare_player2: "Player 7 (Substitute)",
            player_id_ph: "Standoff 2 ID",
            player_nick_ph: "Nickname",
            player_tg_ph: "Telegram",
            team_done: "Done",
            team_created: "Team created!",
            news: "News",
            news1title: "🔔 Update",
            news1desc: "We have added English language support and updated the interface.",
            news2title: "🏆 Tournaments Updated",
            news2desc: "All tournaments are now available on a separate page.",
            disciplines: "Disciplines",
            tournaments: "Tournaments",
            tournament1desc: "Start: July 1. Prize Pool: 5000₴",
            awards_title: "Awards",
            create_tournament_btn: "➕ Create Tournament",
            ban_user: "🚫 Ban User",
            unban_user: "✅ Unban User",
            give_prize: "🏆 Give Prize",
            disqualify_team: "❌ Disqualify Team",
            back_to_home: "← Home",
            tournament_view_title: "Tournament View",
            ranking: "Ranking",
            back_to_awards: "← Awards",
            rules_main_title: "Tournament Rules",
            rules_1v1_summary: "1v1 Tournaments",
            rules_1v1_text: "• Players play against each other.<br> • Rounds are played until 3 wins.<br> • The first player to win 3 rounds wins.",
            rules_2v2_summary: "2v2 Tournaments",
            rules_2v2_text: "• Teams of 2 players.<br> • Success depends on coordination and teamwork.<br> • First to 5 wins — proceeds.<br> • If the score is 5-5, an additional round is played.",
            rules_5v5_standoff_summary: "5v5 Tournaments",
            rules_5v5_standoff_text: "• Teams of 5 players.<br> • Play 10 rounds.<br> • The team with more rounds wins.<br> • If the score is 5-5, an additional round is played.",
            support_title: "Support",
            support_description: "If you have any questions or issues, please contact us:",
            support_email: "Email: support@example.com",
            support_telegram: "Telegram: @OurSupportBot",
            support_note: "We are working to provide you with the best gaming experience. Feel free to contact us!"
        },
        ru: {
            home: "Главная",
            awards: "Награды",
            rules: "Правила",
            support: "Поддержка",
            register: "Зарегистрироваться",
            profile: "Профиль игрока",
            standoff_nick: "Ник в Standoff",
            standoff_id: "ID в Standoff",
            tg_user: "Telegram",
            done: "Готово",
            profile_saved: "Профиль сохранен!",
            create_team: "Создать команду",
            team_avatar: "Аватар команды",
            team_tag: "Тег команды",
            team_name: "Название команды",
            main_player1: "Игрок 1 (капитан)",
            main_player2: "Игрок 2 (основной)",
            main_player3: "Игрок 3 (основной)",
            main_player4: "Игрок 4 (основной)",
            main_player5: "Игрок 5 (основной)",
            spare_player1: "Игрок 6 (запасной)",
            spare_player2: "Игрок 7 (запасной)",
            player_id_ph: "ID в Standoff 2",
            player_nick_ph: "Никнейм",
            player_tg_ph: "Telegram",
            team_done: "Готово",
            team_created: "Команда создана!",
            news: "Новости",
            news1title: "🔔 Обновление",
            news1desc: "Мы добавили поддержку английского языка и обновили интерфейс.",
            news2title: "🏆 Турниры обновлены",
            news2desc: "Теперь все турниры доступны на отдельной странице.",
            disciplines: "Дисциплины",
            tournaments: "Турниры",
            tournament1desc: "Старт: 1 июля. Призовой фонд: 5000₴",
            awards_title: "Награды",
            create_tournament_btn: "➕ Создать турнир",
            ban_user: "🚫 Заблокировать пользователя",
            unban_user: "✅ Разблокировать пользователя",
            give_prize: "🏆 Выдать приз",
            disqualify_team: "❌ Дисквалифицировать команду",
            back_to_home: "← Главная",
            tournament_view_title: "Просмотр Турнира",
            ranking: "Рейтинг",
            back_to_awards: "← Награды",
            rules_main_title: "Правила турнира",
            rules_1v1_summary: "Турниры 1х1",
            rules_1v1_text: "• Игроки играют один против друга.<br> • Раунды проводятся до 3 побед.<br> • Побеждает тот, кто первым выигрывает 3 раунда.",
            rules_2v2_summary: "2v2 Tournaments",
            rules_2v2_text: "• Команды по 2 игрока.<br> • Успех зависит от координации и слаженной игры.<br> • Первые до 5 побед — проходят дальше.<br> • Если счет 5-5, играется дополнительный раунд.",
            rules_5v5_standoff_summary: "Турниры 5х5",
            rules_5v5_standoff_text: "• Команды по 5 игроков.<br> • Играют 10 раундов.<br> • Побеждает команда, набравшая больше раундов.<br> • Если счет 5-5, играется дополнительный раунд.",
            support_title: "Поддержка",
            support_description: "Если у вас возникли вопросы или проблемы, пожалуйста, свяжитесь с нами:",
            support_email: "Электронная почта: support@example.com",
            support_telegram: "Telegram: @OurSupportBot",
            support_note: "Мы работаем, чтобы обеспечить вам лучший игровой опыт. Обращайтесь!"
        },
        pl: {
            home: "Strona główna",
            awards: "Nagrody",
            rules: "Zasady",
            support: "Wsparcie",
            register: "Zarejestruj się",
            profile: "Profil gracza",
            standoff_nick: "Nick w Standoff",
            standoff_id: "ID w Standoff",
            tg_user: "Telegram",
            done: "Gotowe",
            profile_saved: "Profil zapisany!",
            create_team: "Stwórz drużynę",
            team_avatar: "Awatar drużyny",
            team_tag: "Tag drużyny",
            team_name: "Nazwa drużyny",
            main_player1: "Gracz 1 (Kapitan)",
            main_player2: "Gracz 2 (Główny)",
            main_player3: "Gracz 3 (Główny)",
            main_player4: "Gracz 4 (Główny)",
            main_player5: "Gracz 5 (Główny)",
            spare_player1: "Gracz 6 (Zapasowy)",
            spare_player2: "Gracz 7 (Zapasowy)",
            player_id_ph: "ID w Standoff 2",
            player_nick_ph: "Nazwa gracza",
            player_tg_ph: "Telegram",
            team_done: "Gotowe",
            team_created: "Drużyna stworzona!",
            news: "Aktualności",
            news1title: "🔔 Aktualizacja",
            news1desc: "Dodaliśmy obsługę języka angielskiego i zaktualizowaliśmy interfejs.",
            news2title: "🏆 Turnieje zaktualizowane",
            news2desc: "Wszystkie turnieje są teraz dostępne na osobnej stronie.",
            disciplines: "Dyscypliny",
            tournaments: "Turnieje",
            tournament1desc: "Start: 1 lipca. Pula nagród: 5000₴",
            awards_title: "Nagrody",
            create_tournament_btn: "➕ Stwórz Turniej",
            ban_user: "🚫 Zablokuj użytkownika",
            unban_user: "✅ Odblokuj użytkownika",
            give_prize: "🏆 Przyznaj nagrodę",
            disqualify_team: "❌ Zdyskwalifikuj drużynę",
            back_to_home: "← Strona główna",
            tournament_view_title: "Widok Turnieju",
            ranking: "Ranking",
            back_to_awards: "← Nagrody",
            rules_main_title: "Zasady turnieju",
            rules_1v1_summary: "Turnieje 1v1",
            rules_1v1_text: "• Gracze grają jeden przeciwko drugiemu.<br> • Rundy są rozgrywane do 3 zwycięstw.<br> • Wygrywa ten, kto pierwszy wygra 3 rundy.",
            rules_2v2_summary: "2v2 Tournaments",
            rules_2v2_text: "• Drużyny po 2 graczy.<br> • Sukces zależy od koordynacji i zgranej gry.<br> • Pierwsi do 5 zwycięstw — przechodzą dalej.<br> • Jeśli wynik to 5-5, rozgrywana jest dodatkowa runda.",
            rules_5v5_standoff_summary: "Turnieje 5v5",
            rules_5v5_standoff_text: "• Drużyny po 5 graczy.<br> • Grają 10 rund.<br> • Wygrywa drużyna, która zdobyła więcej rund.<br> • Jeśli wynik to 5-5, rozgrywana jest dodatkowa runda.",
            support_title: "Wsparcie",
            support_description: "Jeśli masz pytania lub problemy, skontaktuj się z nami:",
            support_email: "Email: support@example.com",
            support_telegram: "Telegram: @OurSupportBot",
            support_note: "Pracujemy, aby zapewnić Ci najlepsze wrażenia z gry. Skontaktuj się z nami!"
        }
    };

    function applyLanguage(lang) {
        document.querySelectorAll('[data-i18n]').forEach(element => {
            const key = element.getAttribute('data-i18n');
            if (translations[lang] && translations[lang][key]) {
                element.innerHTML = translations[lang][key];
            }
        });
        document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
            const key = element.getAttribute('data-i18n-placeholder');
            if (translations[lang] && translations[lang][key]) {
                element.placeholder = translations[lang][key];
            }
        });
        localStorage.setItem('language', lang);
    }

    // Helper function to close all popups
    function closeAllPopups() {
        const allPopups = document.querySelectorAll('.popup.active');
        allPopups.forEach(popup => {
            popup.classList.remove('active');
        });
    }


    langBtn.addEventListener('click', (event) => {
        closeAllPopups(); // Close other popups first
        langPopup.classList.toggle('active');
        event.stopPropagation();
    });

    langOptions.forEach(option => {
        option.addEventListener('click', () => {
            const newLang = option.getAttribute('data-lang');
            applyLanguage(newLang);
            langPopup.classList.remove('active');
        });
    });

    document.addEventListener('click', (event) => {
        if (!langPopup.contains(event.target) && langPopup.classList.contains('active')) {
            langPopup.classList.remove('active');
        }
        if (!profilePopup.contains(event.target) && profilePopup.classList.contains('active')) {
            profilePopup.classList.remove('active');
        }
        if (!adminPopup.contains(event.target) && adminPopup.classList.contains('active') && event.target !== adminMenuBtn) {
            adminPopup.classList.remove('active');
        }
        if (!notificationPopup.contains(event.target) && notificationPopup.classList.contains('active') && event.target !== notificationBtn) {
            notificationPopup.classList.remove('active');
        }
    });

    // Profile Management
    const avatar = document.getElementById('avatar');
    const profilePopup = document.getElementById('profilePopup');
    const registerBtn = document.getElementById('registerBtn');
    const profileForm = document.getElementById('profileForm');
    const standoffNickInput = document.getElementById('standoffNick');
    const standoffIdInput = document.getElementById('standoffId');
    const tgUser = document.getElementById('tgUser');
    const doneBtn = document.getElementById('doneBtn');
    const playerProfile = document.getElementById('playerProfile');
    const profileNick = document.getElementById('profileNick');
    const profileId = document.getElementById('profileId');
    const profileTg = document.getElementById('profileTg');
    const successMsg = document.getElementById('successMsg');
    const createTeamBtn = document.getElementById('createTeamBtn');

    let userData = {
        standoffNick: localStorage.getItem('standoffNick') || '',
        standoffId: localStorage.getItem('standoffId') || '',
        tgUser: Telegram.WebApp.initDataUnsafe.user ? `@${Telegram.WebApp.initDataUnsafe.user.username || Telegram.WebApp.initDataUnsafe.user.first_name}` : ''
    };

    function updateProfileDisplay() {
        if (userData.standoffNick && userData.standoffId) {
            registerBtn.style.display = 'none';
            profileForm.style.display = 'none';
            playerProfile.style.display = 'block';
            profileNick.textContent = userData.standoffNick;
            profileId.textContent = userData.standoffId;
            profileTg.textContent = userData.tgUser;
            createTeamBtn.style.display = 'block';
        } else {
            registerBtn.style.display = 'block';
            playerProfile.style.display = 'none';
            createTeamBtn.style.display = 'none';
        }
    }

    avatar.addEventListener('click', (event) => {
        closeAllPopups(); // Close other popups first
        profilePopup.classList.toggle('active');
        event.stopPropagation();
    });

    registerBtn.addEventListener('click', () => {
        registerBtn.style.display = 'none';
        profileForm.style.display = 'flex';
        standoffNickInput.value = userData.standoffNick;
        standoffIdInput.value = userData.standoffId;
        tgUser.value = userData.tgUser;
    });

    profileForm.addEventListener('submit', (e) => {
        e.preventDefault();
        userData.standoffNick = standoffNickInput.value;
        userData.standoffId = standoffIdInput.value;
        localStorage.setItem('standoffNick', userData.standoffNick);
        localStorage.setItem('standoffId', userData.standoffId);
        updateProfileDisplay();
        successMsg.style.display = 'block';
        setTimeout(() => successMsg.style.display = 'none', 3000);
        profilePopup.classList.remove('active');
    });

    // Team Management
    const createTeamBtnElement = document.getElementById('createTeamBtn');
    const teamForm = document.getElementById('teamForm');
    const teamAvatarInput = document.getElementById('teamAvatar');
    const teamAvatarPreview = document.getElementById('teamAvatarPreview');
    const teamDoneBtn = document.getElementById('teamDoneBtn');
    const teamSuccessMsg = document.getElementById('teamSuccessMsg');

    teamAvatarInput.addEventListener('change', (event) => {
        const file = event.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = (e) => {
                teamAvatarPreview.src = e.target.result;
                teamAvatarPreview.style.display = 'block';
            };
            reader.readAsDataURL(file);
        } else {
            teamAvatarPreview.style.display = 'none';
        }
    });

    createTeamBtnElement.addEventListener('click', () => {
        teamForm.style.display = 'flex';
        createTeamBtnElement.style.display = 'none';
    });

    teamForm.addEventListener('submit', (e) => {
        e.preventDefault();
        // In a real app, send team data to backend
        teamForm.style.display = 'none';
        teamSuccessMsg.style.display = 'block';
        setTimeout(() => teamSuccessMsg.style.display = 'none', 3000);
        createTeamBtnElement.style.display = 'block';
    });

    // Notification Management
    const notificationBtn = document.getElementById('notificationBtn');
    const notificationBadge = document.getElementById('notificationBadge');
    const notificationPopup = document.getElementById('notificationPopup');
    const notificationList = document.getElementById('notificationList');
    const clearNotificationsBtn = document.getElementById('clearNotificationsBtn');

    let notifications = JSON.parse(localStorage.getItem('notifications')) || [];

    function showNotificationBadge() {
        if (notifications.length > 0) {
            notificationBadge.textContent = notifications.length;
            notificationBadge.style.display = 'flex';
        } else {
            notificationBadge.style.display = 'none';
        }
    }

    function displayNotifications() {
        notificationList.innerHTML = ''; // Clear existing notifications
        if (notifications.length === 0) {
            notificationList.innerHTML = '<p style="text-align:center; color:#bbb;">Немає нових сповіщень.</p>';
            clearNotificationsBtn.style.display = 'none';
            return;
        }
        notifications.forEach((notification, index) => {
            const notificationItem = document.createElement('div');
            notificationItem.style.background = '#2b2b2b';
            notificationItem.style.padding = '10px';
            notificationItem.style.borderRadius = '8px';
            notificationItem.style.marginBottom = '8px';
            notificationItem.style.color = '#eee';
            notificationItem.style.fontSize = '0.95rem';
            notificationItem.innerHTML = `<strong>${notification.title}</strong><p>${notification.message}</p>`;
            notificationList.appendChild(notificationItem);
        });
        clearNotificationsBtn.style.display = 'block';
    }

    notificationBtn.addEventListener('click', (event) => {
        closeAllPopups(); // Close other popups first
        notificationPopup.classList.toggle('active');
        displayNotifications();
        event.stopPropagation();
    });

    clearNotificationsBtn.addEventListener('click', () => {
        notifications = [];
        localStorage.setItem('notifications', JSON.stringify(notifications));
        showNotificationBadge();
        displayNotifications();
    });

    // Example of adding a notification (for testing)
    // function addNotification(title, message) {
    //     notifications.unshift({ title, message, timestamp: new Date().toISOString() });
    //     localStorage.setItem('notifications', JSON.stringify(notifications));
    //     showNotificationBadge();
    // }
    // addNotification('Test Notification', 'This is a test notification message.');

    // Section Navigation
    const homeNav = document.getElementById('homeNav');
    const awardsNav = document.getElementById('awardsNav');
    const rulesNav = document.getElementById('rulesNav');
    const supportNav = document.getElementById('supportNav');

    const homeSection = document.getElementById('homeSection');
    const awardsSection = document.getElementById('awardsSection');
    const rulesSection = document.getElementById('rulesSection');
    const supportSection = document.getElementById('supportSection');
    const tournamentViewSection = document.getElementById('tournamentViewSection');

    function showSection(sectionId) {
        document.querySelectorAll('.section').forEach(section => {
            section.classList.remove('active');
        });
        document.getElementById(sectionId).classList.add('active');

        document.querySelectorAll('.nav-item').forEach(item => {
            item.classList.remove('active');
        });
        if (sectionId === 'homeSection') homeNav.classList.add('active');
        if (sectionId === 'awardsSection') awardsNav.classList.add('active');
        if (sectionId === 'rulesSection') rulesNav.classList.add('active');
        if (sectionId === 'supportSection') supportNav.classList.add('active');
    }

    homeNav.addEventListener('click', () => showSection('homeSection'));
    awardsNav.addEventListener('click', () => showSection('awardsSection'));
    rulesNav.addEventListener('click', () => showSection('rulesSection'));
    supportNav.addEventListener('click', () => showSection('supportSection'));

    // Awards Section
    const awardsList = document.getElementById('awardsList');
    const backToAwardsBtn = document.getElementById('backToAwardsBtn');
    const tournamentDetailsSection = document.getElementById('tournamentDetailsSection');
    const tournamentDetailsTitle = document.getElementById('tournamentDetailsTitle');
    const tournamentDetailsDescription = document.getElementById('tournamentDetailsDescription');
    const tournamentRankingBody = document.getElementById('tournamentRankingBody');

    const mockAwards = [
        {
            id: 'award1',
            type: 'emoji',
            icon: '🥇',
            title: 'Переможець RFORZ Grand Prix',
            tournament: 'RFORZ Grand Prix',
            description: 'Приз за перше місце у RFORZ Grand Prix.',
            ranking: [
                { place: 1, team: 'Команда A', prize: '5000₴' },
                { place: 2, team: 'Команда B', prize: '3000₴' }
            ]
        },
        {
            id: 'award2',
            type: 'image',
            icon: 'award_img_placeholder.png', // Placeholder image
            title: 'Найкращий гравець місяця',
            tournament: 'Щомісячний турнір',
            description: 'Нагорода найкращому гравцю за квітень 2025.',
            ranking: [
                { place: 1, team: 'Гравець X', prize: '1000₴' },
                { place: 2, team: 'Гравець Y', prize: '500₴' }
            ]
        }
    ];

    function displayAwards() {
        awardsList.innerHTML = '';
        mockAwards.forEach(award => {
            const awardCard = document.createElement('div');
            awardCard.classList.add('award-card');
            awardCard.dataset.awardId = award.id;
            awardCard.innerHTML = `
                <div class="award-content-wrapper">
                    ${award.type === 'emoji' ? `<span class="award-card-icon">${award.icon}</span>` : `<img src="${award.icon}" alt="Award Icon" class="award-card-img">`}
                    <div class="award-text-content">
                        <h4>${award.title}</h4>
                        <p class="tournament-name-on-card">${award.tournament}</p>
                    </div>
                </div>
            `;
            awardsList.appendChild(awardCard);

            awardCard.addEventListener('click', () => {
                showTournamentDetails(award.id);
            });
        });
    }

    function showTournamentDetails(awardId) {
        const award = mockAwards.find(a => a.id === awardId);
        if (award) {
            tournamentDetailsTitle.textContent = award.title;
            tournamentDetailsDescription.textContent = award.description;
            tournamentRankingBody.innerHTML = '';
            award.ranking.forEach(rank => {
                const row = document.createElement('tr');
                row.innerHTML = `<td>${rank.place}</td><td>${rank.team}</td><td>${rank.prize}</td>`;
                tournamentRankingBody.appendChild(row);
            });
            showSection('tournamentDetailsSection');
        }
    }

    backToAwardsBtn.addEventListener('click', () => {
        showSection('awardsSection');
    });

    // Event listener for RFORZ Grand Prix card
    const rforzGrandPrixCard = document.querySelector('#tournamentList .tournament-card h4');
    const rforzGrandPrixTournamentCard = rforzGrandPrixCard ? rforzGrandPrixCard.closest('.tournament-card') : null;

    if (rforzGrandPrixTournamentCard) {
        rforzGrandPrixTournamentCard.addEventListener('click', () => {
            showSection('tournamentViewSection');
            showTournamentTab('groupStage'); // Default to group stage when tournament view is opened
        });
    }

    // Event listener for back button in tournamentViewSection
    const backToHomeFromTournamentViewBtn = document.getElementById('backToHomeFromTournamentView'); // Get the element here
    if (backToHomeFromTournamentViewBtn) {
        backToHomeFromTournamentViewBtn.addEventListener('click', () => {
            showSection('homeSection');
        });
    }

    // Tournament View Tabs
    const tournamentTabs = document.querySelectorAll('.tournament-tab');
    const groupStageContent = document.getElementById('groupStageContent');
    const playoffsContent = document.getElementById('playoffsContent');

    function showTournamentTab(tabName) {
        tournamentTabs.forEach(tab => tab.classList.remove('active'));
        document.querySelectorAll('.tournament-tab-content').forEach(content => content.classList.remove('active'));

        if (tabName === 'groupStage') {
            document.querySelector('.tournament-tab[data-tab="groupStage"]').classList.add('active');
            groupStageContent.classList.add('active');
        } else if (tabName === 'playoffs') {
            document.querySelector('.tournament-tab[data-tab="playoffs"]').classList.add('active');
            playoffsContent.classList.add('active');
        }
    }

    tournamentTabs.forEach(tab => {
        tab.addEventListener('click', () => {
            showTournamentTab(tab.dataset.tab);
        });
    });

    // Admin Modals and Functionality
    const adminMenuBtn = document.getElementById('adminMenuBtn');
    const adminPopup = document.getElementById('adminPopup');
    const createTournamentAdminBtn = document.getElementById('createTournamentAdminBtn');
    const createTournamentModal = document.getElementById('createTournamentModal');
    const closeTournamentModalBtn = document.getElementById('closeTournamentModalBtn');
    const tournamentForm = document.getElementById('tournamentForm');
    const adminTournamentEdit = document.getElementById('adminTournamentEdit');
    const editGroupStageBtn = document.getElementById('editGroupStageBtn');
    const viewPlayoffBracketAdminBtn = document.getElementById('viewPlayoffBracketAdminBtn');
    const groupStageEdit = document.getElementById('groupStageEdit');
    const adminPlayoffBracketView = document.getElementById('adminPlayoffBracketView');

    // Admin ID Validation - IMPORTANT: In a real application, this should be handled server-side for security.
    const adminIds = [12345, 987654321]; // Replace with actual admin Telegram user IDs

    let isAdmin = false;
    if (Telegram.WebApp.initDataUnsafe && Telegram.WebApp.initDataUnsafe.user) {
        const userId = Telegram.WebApp.initDataUnsafe.user.id;
        isAdmin = adminIds.includes(userId);
    }
    // End Admin ID Validation


    adminMenuBtn.addEventListener('click', (event) => {
        if (isAdmin) {
            closeAllPopups(); // Close other popups first
            adminPopup.classList.toggle('active');
        } else {
            alert('У вас немає прав доступу до адмін-меню.');
        }
        event.stopPropagation();
    });

    createTournamentAdminBtn.addEventListener('click', () => {
        createTournamentModal.style.display = 'block';
        adminPopup.classList.remove('active'); // Close admin menu when modal opens
    });

    closeTournamentModalBtn.addEventListener('click', () => {
        createTournamentModal.style.display = 'none';
    });

    window.addEventListener('click', (event) => {
        if (event.target == createTournamentModal) {
            createTournamentModal.style.display = 'none';
        }
    });

    tournamentForm.addEventListener('submit', (e) => {
        e.preventDefault();
        alert('Турнір успішно створено (імітація)!'); // In a real app, send data to backend
        createTournamentModal.style.display = 'none';
        tournamentForm.reset();
    });

    // Tournament editing visibility
    if (adminTournamentEdit) {
        if (isAdmin) {
            // If admin, the adminTournamentEdit div will be shown by default by JS.
            // If not admin, it remains hidden by CSS.
            // This button might trigger showing/hiding sections within adminTournamentEdit
            // This part of the code handles showing/hiding the main admin edit section.
            // The 'Редагувати Турнір' button or a similar entry point should be visible only for admins.
            // For now, if isAdmin, we show the adminTournamentEdit section when tournamentViewSection is active.
            const userTournamentView = document.getElementById('userTournamentView');
             if (userTournamentView) {
                // If it's admin, replace user view with admin view
                userTournamentView.style.display = 'none';
                adminTournamentEdit.style.display = 'block';
            }
        } else {
            adminTournamentEdit.style.display = 'none'; // Ensure it's hidden for non-admins
        }
    }


    editGroupStageBtn.addEventListener('click', () => {
        groupStageEdit.style.display = 'block';
        adminPlayoffBracketView.style.display = 'none';
    });

    viewPlayoffBracketAdminBtn.addEventListener('click', () => {
        adminPlayoffBracketView.style.display = 'block';
        groupStageEdit.style.display = 'none';
    });

    // Add/Remove Team logic (simplified for demonstration)
    const teamNameInput = document.getElementById('teamNameInput');
    const groupSelect = document.getElementById('groupSelect');
    const addTeamBtn = document.getElementById('addTeamBtn');
    const removeTeamBtn = document.getElementById('removeTeamBtn');
    const adminGroupATable = document.getElementById('adminGroupATable').getElementsByTagName('tbody')[0];
    const adminGroupBTable = document.getElementById('adminGroupBTable').getElementsByTagName('tbody')[0];

    addTeamBtn.addEventListener('click', () => {
        const teamName = teamNameInput.value.trim();
        const selectedGroup = groupSelect.value;
        if (teamName) {
            const tableToAddTo = selectedGroup === 'groupA' ? adminGroupATable : adminGroupBTable;
            const newRow = tableToAddTo.insertRow();
            newRow.innerHTML = `<td>${teamName}</td><td><button data-team="${teamName}" class="remove-btn">Видалити</button></td>`;
            teamNameInput.value = '';
            attachRemoveListeners(); // Re-attach listeners for new buttons
        }
    });

    function attachRemoveListeners() {
        document.querySelectorAll('.remove-btn').forEach(button => {
            button.onclick = (e) => {
                e.target.closest('tr').remove();
            };
        });
    }
    attachRemoveListeners(); // Initial attachment for existing buttons

    // Initialize functions on load
    document.addEventListener('DOMContentLoaded', () => {
      applyLanguage(currentLanguage);
      updateProfileDisplay();
      showNotificationBadge();
      displayAwards(); // Call to display awards on page load

      // Admin menu visibility based on isAdmin status
      if (isAdmin) {
        adminMenuBtn.style.display = 'block';
      } else {
        adminMenuBtn.style.display = 'none';
      }

      // Hide all sections except home on initial load
      showSection('homeSection');
    });
  </script>
</body>
</html>
